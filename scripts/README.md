# ๐ ุฑุงูููุง ุงุณฺฉุฑูพุชโูุง ูพุฑูฺู

ุงู ูพูุดู ุดุงูู ุงุณฺฉุฑูพุชโูุง ููุฏ ุจุฑุง ูุฏุฑุช ู ูฺฏูุฏุงุฑ ูพุฑูฺู Django ุงุณุช. ุฏุฑ ุงุฏุงูู ุชูุถุญุงุช ูุฑ ุงุณฺฉุฑูพุช ุงุฑุงุฆู ุดุฏู ุงุณุช.

---

## ๐ฆ ุงุณฺฉุฑูพุชโูุง ุจฺฉโุขูพ ู ุจุงุฒุงุจ

### 1. `create_backup.py`
ุงุณฺฉุฑูพุช ูพุดุฑูุชู ุจุฑุง ุงุฌุงุฏ ูพุดุชุจุงู ุงุฒ ุฏุชุงุจุณ.

**ูฺฺฏโูุง:**
- ุงุฌุงุฏ ูพูุดู ุจฺฉโุขูพ ุจุง ุชุงุฑุฎ ู ุณุงุนุช
- ุงุฌุงุฏ fixture ฺฉุงูู ุงุฒ ููู ุฏุงุฏูโูุง
- ุงุฌุงุฏ fixture ุฌุฏุงฺฏุงูู ุจุฑุง ูุฑ ุฌุฏูู
- ูุงู ุขูุงุฑ ู ฺฏุฒุงุฑุด ฺฉุงูู
- ุงูฺฉุงู ุจฺฉโุขูพ ุงุฒ ฺฉ ูพุฑูฺู ุฎุงุต

**ูุญูู ุงุณุชูุงุฏู:**
```bash
# ุจฺฉโุขูพ ุงุฒ ููู ุฏุงุฏูโูุง
source env/bin/activate && python scripts/create_backup.py

# ุจฺฉโุขูพ ุงุฒ ูพุฑูฺู ุฎุงุต (ุจุง ID)
source env/bin/activate && python scripts/create_backup.py 1
```

**ุฎุฑูุฌ:**
- ูพูุดู `backups/backup_YYYYMMDD_HHMMSS/` ุดุงูู:
  - `complete_database.json` - ูุงู fixture ฺฉุงูู
  - ูุงูโูุง ุฌุฏุงฺฏุงูู ุจุฑุง ูุฑ ุฌุฏูู (investors.json, transactions.json ู ุบุฑู)
  - `backup_report.json` - ฺฏุฒุงุฑุด JSON
  - `backup_summary.txt` - ฺฏุฒุงุฑุด ูุชู

---

### 2. `restore_backup.py`
ุงุณฺฉุฑูพุช ุจุงุฒุงุจ ุฏุชุงุจุณ ุงุฒ ูุงู ุจฺฉโุขูพ.

**โ๏ธ ูุดุฏุงุฑ:** ุงู ุงุณฺฉุฑูพุช ููู ุฏุงุฏูโูุง ูุนู ุฑุง ูพุงฺฉ ูโฺฉูุฏ ู ุจุง ุจฺฉโุขูพ ุฌุงฺฏุฒู ูโฺฉูุฏ!

**ูุญูู ุงุณุชูุงุฏู:**
```bash
source env/bin/activate && python scripts/restore_backup.py
```

**ุนููฺฉุฑุฏ:**
- ููุงุด ูุถุนุช ูุนู ุฏุชุงุจุณ
- ุฏุฑุฎูุงุณุช ุชุฃุฏ ุงุฒ ฺฉุงุฑุจุฑ
- ูพุงฺฉ ฺฉุฑุฏู ุฏุงุฏูโูุง ูุนู
- ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏูโูุง ุงุฒ ุฌุฏุฏุชุฑู ุจฺฉโุขูพ
- ููุงุด ูุถุนุช ุฌุฏุฏ ุฏุชุงุจุณ

---

### 3. `list_backups.py`
ุงุณฺฉุฑูพุช ููุงุด ูุณุช ุจฺฉโุขูพโูุง ููุฌูุฏ.

**ูุญูู ุงุณุชูุงุฏู:**
```bash
source env/bin/activate && python scripts/list_backups.py
```

**ุฎุฑูุฌ:**
- ูุณุช ููู ุจฺฉโุขูพโูุง ุจู ุชุฑุชุจ ุชุงุฑุฎ (ุฌุฏุฏุชุฑู ุงูู)
- ุงุทูุงุนุงุช ูุฑ ุจฺฉโุขูพ: ุชุงุฑุฎุ ุญุฌูุ ุชุนุฏุงุฏ ุฑฺฉูุฑุฏูุง
- ุฑุงูููุง ุจุงุฒุงุจ ุจฺฉโุขูพ

---

### 4. `setup_cron.sh`
ุงุณฺฉุฑูพุช ุชูุธู cron job ุจุฑุง ุจฺฉโุขูพ ุฎูุฏฺฉุงุฑ.

**ูุญูู ุงุณุชูุงุฏู:**
```bash
./scripts/setup_cron.sh
```

**ุนููฺฉุฑุฏ:**
- ุชูุธู cron job ุจุฑุง ุงุฌุฑุง ุจฺฉโุขูพ ูุฑ 6 ุณุงุนุช
- ููุงุด cron jobs ูุนู
- ุฑุงูููุง ุญุฐู cron job

---

### 5. `run_auto_backup.sh`
ุงุณฺฉุฑูพุช ุงุฌุฑุง ุจฺฉโุขูพ ุฎูุฏฺฉุงุฑ (ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ cron).

**ูุญูู ุงุณุชูุงุฏู:**
```bash
./scripts/run_auto_backup.sh
```

**ุนููฺฉุฑุฏ:**
- ูุนุงูโุณุงุฒ ูุญุท ูุฌุงุฒ
- ุงุฌุฑุง ุฏุณุชูุฑ `auto_backup`
- ูุงฺฏ ฺฉุฑุฏู ูุชุฌู ุฏุฑ `logs/auto_backup.log`

**ูฺฉุชู:** ุงู ุงุณฺฉุฑูพุช ูุนูููุงู ุชูุณุท cron ุงุฌุฑุง ูโุดูุฏุ ูู ุฏุณุช.

---

### 6. `remove_cron.sh`
ุงุณฺฉุฑูพุช ุญุฐู cron job ุจฺฉโุขูพ ุฎูุฏฺฉุงุฑ.

**ูุญูู ุงุณุชูุงุฏู:**
```bash
./scripts/remove_cron.sh
```

**ุนููฺฉุฑุฏ:**
- ุญุฐู cron job ูุฑุจูุท ุจู ุจฺฉโุขูพ ุฎูุฏฺฉุงุฑ
- ููุงุด cron jobs ุจุงูโูุงูุฏู

---

## ๐ฅ ุงุณฺฉุฑูพุชโูุง ูุงุฑุฏ ฺฉุฑุฏู ุฏุงุฏู

### 7. `import_investor.py`
ุงุณฺฉุฑูพุช ูุงุฑุฏ ฺฉุฑุฏู ุณุฑูุงูโฺฏุฐุงุฑุงู ุงุฒ ูุงู CSV ุจู ุฏุชุงุจุณ.

**ูุญูู ุงุณุชูุงุฏู:**
```bash
source env/bin/activate && python scripts/import_investor.py
```

**ูุงู ูุฑูุฏ:**
- ูุณุฑ: `temp_data/investors.csv`
- ุณุชููโูุง ููุฑุฏ ูุงุฒ: `name`

**ุนููฺฉุฑุฏ:**
- ุฎูุงูุฏู ูุงู CSV
- ุชุฌุฒู ูุงู ฺฉุงูู ุจู ูุงู ู ูุงู ุฎุงููุงุฏฺฏ
- ุงุฌุงุฏ ุง ุจูโุฑูุฒุฑุณุงู ุณุฑูุงูโฺฏุฐุงุฑุงู
- ฺฏุฒุงุฑุด ุชุนุฏุงุฏ ุณุฑูุงูโฺฏุฐุงุฑุงู ุฌุฏุฏ ู ููุฌูุฏ

---

### 8. `import_transaction.py`
ุงุณฺฉุฑูพุช ูพุดุฑูุชู ูุงุฑุฏ ฺฉุฑุฏู ุชุฑุงฺฉูุดโูุง ุงุฒ ูุงู CSV.

**ูฺฺฏโูุง:**
- ุชุจุฏู ุชุงุฑุฎ ุดูุณ ุจู ููุงุฏ ู ุงุนุชุจุงุฑุณูุฌ
- ูุญุงุณุจู ุฎูุฏฺฉุงุฑ `day_remaining` ู `day_from_start`
- ุงุนุชุจุงุฑุณูุฌ ฺฉุงูู ุฏุงุฏูโูุง ูุจู ุงุฒ ูุงุฑุฏ ฺฉุฑุฏู
- ฺฏุฒุงุฑุดโุฏู ุฌุงูุน

**ูุญูู ุงุณุชูุงุฏู:**
```bash
source env/bin/activate && python scripts/import_transaction.py
```

**ูุงู ูุฑูุฏ:**
- ูุณุฑ: `temp_data/Transactions.csv`
- ุณุชููโูุง ููุฑุฏ ูุงุฒ:
  - `project_id`, `period_label`
  - `date_shamsi`, `date_gregorian`
  - `investor_name`, `entry_type`, `amount`
  - `day_remaining`, `day_from_start` (ุงุฎุชุงุฑ - ุฎูุฏฺฉุงุฑ ูุญุงุณุจู ูโุดูุฏ)

**ุนููฺฉุฑุฏ:**
1. **ูุฑุญูู 1: ุงุนุชุจุงุฑุณูุฌ**
   - ุจุฑุฑุณ ุตุญุช ุชุงุฑุฎโูุง
   - ุจุฑุฑุณ ูุฌูุฏ ุณุฑูุงูโฺฏุฐุงุฑุงู ู ุฏูุฑูโูุง
   - ุจุฑุฑุณ ุตุญุช ูุจุงูุบ
   - ููุงุณู ููุงุฏุฑ ูุญุงุณุจู ุดุฏู ุจุง ููุงุฏุฑ CSV

2. **ูุฑุญูู 2: ูุงุฑุฏ ฺฉุฑุฏู**
   - ูุงุฑุฏ ฺฉุฑุฏู ุชุฑุงฺฉูุดโูุง ุจู ุฏุชุงุจุณ
   - ุงุณุชูุงุฏู ุงุฒ ููุงุฏุฑ ูุญุงุณุจู ุดุฏู ุจุฑุง `day_remaining` ู `day_from_start`

---

### 9. `import_period.py`
ุงุณฺฉุฑูพุช ูุงุฑุฏ ฺฉุฑุฏู ุฏูุฑูโูุง ุฒูุงู ุงุฒ ูุงู CSV.

**ูุญูู ุงุณุชูุงุฏู:**
```bash
source env/bin/activate && python scripts/import_period.py
```

**ูุงู ูุฑูุฏ:**
- ูุณุฑ: `temp_data/periods.csv`
- ุณุชููโูุง ููุฑุฏ ูุงุฒ:
  - `period_label`, `year`, `month_number`, `month_name`, `weight`

**ุนููฺฉุฑุฏ:**
- ุงุฌุงุฏ ุง ุจูโุฑูุฒุฑุณุงู ุฏูุฑูโูุง
- ูุญุงุณุจู ุฎูุฏฺฉุงุฑ ุชุงุฑุฎโูุง ุดูุณ ู ููุงุฏ
- ุงุฎุชุตุงุต ุจู ูพุฑูฺู ูพุดโูุฑุถ ("ูพุฑูฺู ุงุตู")

---

## ๐ง ุงุณฺฉุฑูพุชโูุง ุชุตุญุญ ู ุชุจุฏู

### 10. `fix_transaction_types.py`
ุงุณฺฉุฑูพุช ุชุตุญุญ ููุน ุชุฑุงฺฉูุดโูุง ุจุง ุจุฑุฑุณ ู ุชุฃุฏ.

**ูุงุนุฏู ุชุตุญุญ:**
- ููุงุฏุฑ ููู: `principal_withdrawal` โ `profit_accrual` (ุฌุงุจุฌุง)
- ููุงุฏุฑ ูุซุจุช: `principal_deposit` โ `profit_accrual` (ุฌุงุจุฌุง)

**ูุญูู ุงุณุชูุงุฏู:**
```bash
source env/bin/activate && python scripts/fix_transaction_types.py
```

**ุนููฺฉุฑุฏ:**
1. ุชุญูู ุชุฑุงฺฉูุดโูุง ูุงุฒููุฏ ุชุตุญุญ
2. ููุงุด ุชุบุฑุงุช (ุญุงูุช ุชุณุช)
3. ุฏุฑุฎูุงุณุช ุชุฃุฏ ุงุฒ ฺฉุงุฑุจุฑ
4. ุงุนูุงู ุชุตุญุญุงุช
5. ุชุฃุฏ ุตุญุช ุชุตุญุญุงุช

---

### 11. `fix_transaction_types_simple.py`
ูุณุฎู ุณุงุฏูโุชุฑ ุงุณฺฉุฑูพุช ุชุตุญุญ ููุน ุชุฑุงฺฉูุดโูุง (ุจุฏูู ุชุฃุฏ).

**ูุญูู ุงุณุชูุงุฏู:**
```bash
source env/bin/activate && python scripts/fix_transaction_types_simple.py
```

**โ๏ธ ูุดุฏุงุฑ:** ุงู ุงุณฺฉุฑูพุช ุจุฏูู ุชุฃุฏุ ุชุบุฑุงุช ุฑุง ุงุนูุงู ูโฺฉูุฏ.

---

### 12. `convert_rial_to_toman.py`
ุงุณฺฉุฑูพุช ุชุจุฏู ูุงุญุฏ ูพูู ุงุฒ ุฑุงู ุจู ุชููุงู.

**ูุญูู ุงุณุชูุงุฏู:**
```bash
source env/bin/activate && python scripts/convert_rial_to_toman.py [command]
```

**ุฏุณุชูุฑุงุช:**
- `test` - ุชุณุช (ุญุงูุช ุขุฒูุงุด ุจุฏูู ุชุบุฑ)
- `backup` - ุงุฌุงุฏ ุจฺฉุงูพ ู ุณูพุณ ุชุจุฏู
- `convert` - ุชุจุฏู ูุณุชูู (ุจุฏูู ุจฺฉุงูพ)

**ูุซุงู:**
```bash
# ุชุณุช (ุชูุตู ูโุดูุฏ ุงุจุชุฏุง ุชุณุช ฺฉูุฏ)
python scripts/convert_rial_to_toman.py test

# ุจฺฉุงูพ ู ุชุจุฏู
python scripts/convert_rial_to_toman.py backup

# ุชุจุฏู ูุณุชูู
python scripts/convert_rial_to_toman.py convert
```

---

### 13. `convert_rial_to_toman.sh`
ูุณุฎู bash script ุจุฑุง ุชุจุฏู ุฑุงู ุจู ุชููุงู.

**ูุญูู ุงุณุชูุงุฏู:**
```bash
./scripts/convert_rial_to_toman.sh test     # ุชุณุช
./scripts/convert_rial_to_toman.sh backup   # ุจฺฉุงูพ + ุชุจุฏู
./scripts/convert_rial_to_toman.sh convert  # ุชุจุฏู ูุณุชูู
```

---

## ๐งช ุงุณฺฉุฑูพุชโูุง ุชุณุช ู ุจุฑุฑุณ

### 14. `test_multi_project_isolation.py`
ุงุณฺฉุฑูพุช ุชุณุช ุฌุฏุงุณุงุฒ ูพุฑูฺูโูุง ุฏุฑ ุณุณุชู ฺูุฏ ูพุฑูฺูโุง.

**ุนููฺฉุฑุฏ:**
ุงู ุงุณฺฉุฑูพุช ฺฉ ุณุฑ ุชุณุช ุฌุงูุน ุงูุฌุงู ูโุฏูุฏ:
1. **ุชุณุช 1:** ุจุฑุฑุณ ุฌุฏุงุณุงุฒ ุฏุงุฏูโูุง ุฏุฑ ุฏุชุงุจุณ
2. **ุชุณุช 2:** ุจุฑุฑุณ `ProjectManager.get_current_project`
3. **ุชุณุช 3:** ุจุฑุฑุณ ููุชุฑ ViewSetูุง
4. **ุชุณุช 4:** ุจุฑุฑุณ ุชุบุฑ ูพุฑูฺู
5. **ุชุณุช 5:** ุจุฑุฑุณ ูุญุงุณุจุงุช ุชูุฎูุงู

**ูุญูู ุงุณุชูุงุฏู:**
```bash
source env/bin/activate && python scripts/test_multi_project_isolation.py
```

**ูฺฉุชู:** ุงู ุงุณฺฉุฑูพุช ุฏุงุฏูโูุง ุชุณุช ุงุฌุงุฏ ูโฺฉูุฏ ู ูพุณ ุงุฒ ุชุณุชุ ุขูโูุง ุฑุง ูฺฏู ูโุฏุงุฑุฏ.

---

### 15. `check_calculations.py`
ุงุณฺฉุฑูพุช ุจุฑุฑุณ ูุญุงุณุจุงุช ููุฌูุฏ ุฏุฑ ุณูุช ุณุฑูุฑ.

**ูุญูู ุงุณุชูุงุฏู:**
```bash
source env/bin/activate && python scripts/check_calculations.py
```

**ุนููฺฉุฑุฏ:**
- ุจุฑุฑุณ ฺฉูุงุณโูุง ูุญุงุณุจุงุช ููุฌูุฏ
- ูุณุช API endpoints ููุฌูุฏ
- ุจุฑุฑุณ ูพูุดุด ูุญุงุณุจุงุช
- ุชุณุช ุฏุณุชุฑุณ APIโูุง

**ุฎุฑูุฌ:**
- ูุณุช ูุชุฏูุง ูุญุงุณุจุงุช ููุฌูุฏ
- ูุณุช API endpoints
- ุฏุฑุตุฏ ูพูุดุด ูุญุงุณุจุงุช
- ูุถุนุช ุนููฺฉุฑุฏ APIโูุง

---

### 16. `compare_investor_summary.py`
ุงุณฺฉุฑูพุช ููุงุณู ุฎูุงุตู ุณุฑูุงูโฺฏุฐุงุฑุงู ุจู ุฏู endpoint (SQL vs SSOT).

**ูุญูู ุงุณุชูุงุฏู:**
```bash
source env/bin/activate && python scripts/compare_investor_summary.py [--base-url URL] [--header "Header: Value"]
```

**ูพุงุฑุงูุชุฑูุง:**
- `--base-url`: URL ูพุงู (ูพุดโูุฑุถ: `http://127.0.0.1:8000`)
- `--header`: ูุฏุฑ HTTP ุงุถุงู (ูโุชูุงูุฏ ฺูุฏ ุจุงุฑ ุงุณุชูุงุฏู ุดูุฏ)

**ูุซุงู:**
```bash
# ุชุณุช ุณุงุฏู
python scripts/compare_investor_summary.py

# ุจุง URL ุณูุงุฑุด
python scripts/compare_investor_summary.py --base-url http://localhost:8000

# ุจุง ูุฏุฑ ุงุญุฑุงุฒ ููุช
python scripts/compare_investor_summary.py --header "Authorization: Token YOUR_TOKEN"
```

**ุนููฺฉุฑุฏ:**
- ุฏุฑุงูุช ุฎูุงุตู ุงุฒ endpoint SQL (`/api/v1/Investor/summary/`)
- ุฏุฑุงูุช ุฎูุงุตู ุงุฒ endpoint SSOT (`/api/v1/Investor/summary_ssot/`)
- ููุงุณู ูุชุงุฌ
- ููุงุด ุชูุงูุชโูุง ุฏุฑ ุตูุฑุช ูุฌูุฏ

---

## ๐ ูฺฉุงุช ููู

### ูุนุงูโุณุงุฒ ูุญุท ูุฌุงุฒ
ูุจู ุงุฒ ุงุฌุฑุง ูุฑ ุงุณฺฉุฑูพุช Pythonุ ุจุงุฏ ูุญุท ูุฌุงุฒ ุฑุง ูุนุงู ฺฉูุฏ:
```bash
source env/bin/activate
```

### ูุณุฑ ูพุฑูฺู
ุงฺฉุซุฑ ุงุณฺฉุฑูพุชโูุง ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ูุณุฑ ูพุฑูฺู ุฑุง ุชุดุฎุต ูโุฏููุฏ. ุงุทููุงู ุญุงุตู ฺฉูุฏ ฺฉู ุงุฒ ูพูุดู ุงุตู ูพุฑูฺู ุงุฌุฑุง ูโุดููุฏ.

### ูุฌูุฒูุง ุงุฌุฑุง
ุจุฑุง ุงุณฺฉุฑูพุชโูุง bashุ ููฺฉู ุงุณุช ูุงุฒ ุจู ุชูุธู ูุฌูุฒ ุงุฌุฑุง ุฏุงุดุชู ุจุงุดุฏ:
```bash
chmod +x scripts/*.sh
```

### ูุงฺฏโูุง
ุจุฑุฎ ุงุณฺฉุฑูพุชโูุง ูุงฺฏโูุง ุฎูุฏ ุฑุง ุฏุฑ ูพูุดู `logs/` ุฐุฎุฑู ูโฺฉููุฏ. ุงุทููุงู ุญุงุตู ฺฉูุฏ ฺฉู ุงู ูพูุดู ูุฌูุฏ ุฏุงุฑุฏ:
```bash
mkdir -p logs
```

---

## ๐ ุงุณฺฉุฑูพุชโูุง ูุฑุชุจุท

- **ุจฺฉโุขูพ:** `create_backup.py`, `restore_backup.py`, `list_backups.py`
- **ูุงุฑุฏ ฺฉุฑุฏู:** `import_investor.py`, `import_transaction.py`, `import_period.py`
- **ุชุตุญุญ:** `fix_transaction_types.py`, `fix_transaction_types_simple.py`
- **ุชุจุฏู:** `convert_rial_to_toman.py`, `convert_rial_to_toman.sh`
- **ุชุณุช:** `test_multi_project_isolation.py`, `check_calculations.py`, `compare_investor_summary.py`
- **ุฎูุฏฺฉุงุฑุณุงุฒ:** `setup_cron.sh`, `run_auto_backup.sh`, `remove_cron.sh`

---

## โ๏ธ ูุดุฏุงุฑูุง

1. **ุงุณฺฉุฑูพุชโูุง ุจฺฉโุขูพ ู ุจุงุฒุงุจ:**
   - `restore_backup.py` ููู ุฏุงุฏูโูุง ูุนู ุฑุง ูพุงฺฉ ูโฺฉูุฏ!

2. **ุงุณฺฉุฑูพุชโูุง ุชุตุญุญ:**
   - `fix_transaction_types_simple.py` ุจุฏูู ุชุฃุฏ ุชุบุฑุงุช ุฑุง ุงุนูุงู ูโฺฉูุฏ.

3. **ุงุณฺฉุฑูพุชโูุง ุชุจุฏู:**
   - ุชุจุฏู ูุงุญุฏ ูพูู ฺฉ ุนููุงุช ฺฉโุทุฑูู ุงุณุช. ููุดู ูุจู ุงุฒ ุชุจุฏู ุจฺฉโุขูพ ุจฺฏุฑุฏ.

---

## ๐ ูพุดุชุจุงู

ุฏุฑ ุตูุฑุช ุจุฑูุฒ ูุดฺฉู:
1. ูุงฺฏโูุง ุงุณฺฉุฑูพุช ุฑุง ุจุฑุฑุณ ฺฉูุฏ
2. ูุทูุฆู ุดูุฏ ูุญุท ูุฌุงุฒ ูุนุงู ุงุณุช
3. ุจุฑุฑุณ ฺฉูุฏ ฺฉู ูุงูโูุง ูุฑูุฏ (CSV) ุฏุฑ ูุณุฑ ุตุญุญ ูุฑุงุฑ ุฏุงุฑูุฏ
4. ุจุฑุฑุณ ฺฉูุฏ ฺฉู ุฏุชุงุจุณ ุฏุฑ ุฏุณุชุฑุณ ุงุณุช
