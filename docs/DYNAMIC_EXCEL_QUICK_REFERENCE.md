# ๐ ูุฑุฌุน ุณุฑุน Excel Dynamic

## ๐ ุดุฑูุน ุณุฑุน

### ุชููุฏ ูุงู
```bash
# ุงุฒ Management Command
python manage.py export_excel --dynamic

# ุง ุงุฒ API
GET /api/v1/Project/export_excel_dynamic/
```

---

## ๐ ุดุชโูุง ฺฉูุฏ

| ุดุช | ูุฏู | ููุน |
|-----|-----|-----|
| `Comprehensive_Metrics` | ููุจ ุณุณุชู - ููู ูุญุงุณุจุงุช | ูุญุงุณุจุงุช โญโญโญ |
| `Transaction_Profit_Calculations` | ูุญุงุณุจู ุณูุฏ ุชุฑุงฺฉูุดโูุง | ูุญุงุณุจุงุช โญโญ |
| `PeriodExpenseSummary` | ุฏูุฑู ูุชูุณุท ุณุงุฎุช | ฺฉูฺฉ โญ |
| `Transactions` | ุชุฑุงฺฉูุดโูุง ูุงู | ูพุงู |
| `๐ ุฑุงูููุง ูุฑูููโูุง` | ุฑุงูููุง ฺฉุงูู | ุฑุงูููุง |

---

## ๐ท๏ธ Named Ranges ููู

### ูุงู
```
TotalCapital           โ ุณุฑูุงู ููุฌูุฏ
TotalProfit            โ ุณูุฏ ุชุฑุงฺฉูุดโูุง
BuildingProfit         โ ุณูุฏ ููุง ุณุงุฎุชูุงู
TotalExpenses          โ ูุฒูู ฺฉู
NetCost                โ ูุฒูู ุฎุงูุต
```

### ุฒูุงู
```
AverageConstructionPeriod  โ ุฏูุฑู ูุชูุณุท ุณุงุฎุช (ูุงู)
AnnualProfitPercentage     โ ุฏุฑุตุฏ ุณูุฏ ุณุงูุงูู
MonthlyProfitPercentage    โ ุฏุฑุตุฏ ุณูุฏ ูุงูุงูู
DailyProfitPercentage      โ ุฏุฑุตุฏ ุณูุฏ ุฑูุฒุงูู
```

### ูุญุงุณุจู ุณูุฏ
```
CalculatedTotalProfit  โ ุฌูุน ุณูุฏ ูุญุงุณุจู ุดุฏู
```

---

## ๐งฎ ูุฑูููโูุง ฺฉูุฏ

### ุฏูุฑู ูุชูุณุท ุณุงุฎุช
```excel
=SUMPRODUCT(PeriodExpenseSummary!C:C, PeriodExpenseSummary!D:D) / SUM(PeriodExpenseSummary!C:C)
```

### ุณูุฏ ุชุฑุงฺฉูุด
```excel
=ูุจูุบ ร (ูุฑุฎ_ุณูุฏ_ุฑูุฒุงูู / 100) ร ุฑูุฒ_ูุงูุฏู
```

### ุฏุฑุตุฏ ุณูุฏ ุณุงูุงูู
```excel
=IF(AverageConstructionPeriod=0, 0, (TotalProfitPercentage/AverageConstructionPeriod)*12)
```

---

## ๐ ุณุชููโูุง ููู Transactions

| ุณุชูู | ุนููุงู | ุงุณุชูุงุฏู |
|------|--------|---------|
| A | ID | ุดูุงุณู ฺฉุชุง |
| C | ุดูุงุณู ุณุฑูุงูโฺฏุฐุงุฑ | ุจุฑุง ููุชุฑ |
| E | ุดูุงุณู ุฏูุฑู | ุจุฑุง ฺฏุฑููโุจูุฏ |
| I | ูุจูุบ | ูุญุงุณุจุงุช ูุงู |
| J | ููุน ุชุฑุงฺฉูุด | ุขูุฑุฏู/ุจุฑุฏุงุดุช/ุณูุฏ |
| L | ุฑูุฒ ูุงูุฏู | ูุญุงุณุจู ุณูุฏ โญ |

---

## ๐ง ุนููุงุช ุฑุงุฌ

### ุงุถุงูู ฺฉุฑุฏู Named Range
```python
NamedRangeHelper.create_named_range(
    workbook, 
    'MyRange',           # ูุงู
    'Sheet_Name',        # ุดุช
    '$B$5'              # ุณููู (absolute)
)
```

### ุงุณุชูุงุฏู ุงุฒ VLOOKUP
```excel
=VLOOKUP(A3, Transactions!$A:$L, 12, FALSE)
```
- `A3`: ููุฏุงุฑ ุฌุณุชุฌู
- `$A:$L`: ูุญุฏูุฏู
- `12`: ุดูุงุฑู ุณุชูู
- `FALSE`: ุชุทุงุจู ุฏูู

### ุฌูุน ุจุง ุดุฑุท
```excel
=SUMIF(TransactionTypes, "ุขูุฑุฏู", TransactionAmounts)
```

---

## โ๏ธ ูฺฉุงุช ููู

1. **ุชุฑุชุจ ุดุชโูุง**: ุดุชโูุง ูพุงู ูุจู ุงุฒ ูุญุงุณุจุงุช
2. **Absolute References**: ููุดู `$B$5` ูู `B5`
3. **Named Ranges**: ูุจู ุงุฒ ุงุณุชูุงุฏู ุชุนุฑู ุดููุฏ
4. **ุฏู ููุน ุณูุฏ**: 
   - `TotalProfit`: ุณูุฏ ูพุฑุฏุงุฎุช
   - `BuildingProfit`: ุณูุฏ ูุญุงุณุจู ุดุฏู
5. **VLOOKUP**: ุจุฑุง ุฑุฏูโูุง ูุงูุทุงุจู

---

## ๐ ุนุจโุงุจ ุณุฑุน

| ุฎุทุง | ุนูุช | ุฑุงูโุญู |
|-----|------|--------|
| #NAME? | Named Range ูุงูุนุชุจุฑ | ุจุฑุฑุณ ุชุนุฑู |
| #REF! | ุงุฑุฌุงุน ูุงูุนุชุจุฑ | ุจุฑุฑุณ ุขุฏุฑุณ |
| #VALUE! | ููุน ุฏุงุฏู ุงุดุชุจุงู | ุงุณุชูุงุฏู ุงุฒ IF |
| #DIV/0! | ุชูุณู ุจุฑ ุตูุฑ | `IF(A1=0, 0, B1/A1)` |

---

## ๐ ูุงูโูุง ูุฑุชุจุท

```
construction/excel_export_dynamic.py       # ฺฉุฏ ุงุตู
DYNAMIC_EXCEL_DOCUMENTATION.md             # ูุณุชูุฏุงุช ฺฉุงูู
docs/API_REFERENCE.md                      # API
```

---

**ูุณุฎู**: 1.0.0 | **ุชุงุฑุฎ**: ุฏ 1403

