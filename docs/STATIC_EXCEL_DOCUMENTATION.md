# ğŸ“Š Ù…Ø³ØªÙ†Ø¯Ø§Øª ÙØ§ÛŒÙ„ Excel Static - Ù¾Ø±ÙˆÚ˜Ù‡ Ø³Ø§Ø®ØªÙ…Ø§Ù†ÛŒ

## ğŸ“‘ ÙÙ‡Ø±Ø³Øª Ù…Ø·Ø§Ù„Ø¨
1. [Ù…Ø¹Ø±ÙÛŒ Ùˆ Ù‡Ø¯Ù](#Ù…Ø¹Ø±ÙÛŒ-Ùˆ-Ù‡Ø¯Ù)
2. [Ø³Ø§Ø®ØªØ§Ø± Ú©Ù„ÛŒ](#Ø³Ø§Ø®ØªØ§Ø±-Ú©Ù„ÛŒ)
3. [Ø´ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯](#Ø´ÛŒØªÙ‡Ø§ÛŒ-Ù…ÙˆØ¬ÙˆØ¯)
4. [Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø³Ø±ÙˆØ±](#Ù…Ø­Ø§Ø³Ø¨Ø§Øª-Ø³Ø±ÙˆØ±)
5. [Ø§Ø³ØªØ§ÛŒÙ„ Ùˆ ÙØ±Ù…Øªâ€ŒØ¨Ù†Ø¯ÛŒ](#Ø§Ø³ØªØ§ÛŒÙ„-Ùˆ-ÙØ±Ù…ØªØ¨Ù†Ø¯ÛŒ)
6. [Ù†Ø­ÙˆÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡](#Ù†Ø­ÙˆÙ‡-Ø§Ø³ØªÙØ§Ø¯Ù‡)
7. [ØªÙˆØ³Ø¹Ù‡ Ùˆ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ](#ØªÙˆØ³Ø¹Ù‡-Ùˆ-Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ)
8. [Ù…Ø´Ú©Ù„Ø§Øª Ø±Ø§ÛŒØ¬ Ùˆ Ø±Ø§Ù‡â€ŒØ­Ù„](#Ù…Ø´Ú©Ù„Ø§Øª-Ø±Ø§ÛŒØ¬-Ùˆ-Ø±Ø§Ù‡Ø­Ù„)

---

## ğŸ¯ Ù…Ø¹Ø±ÙÛŒ Ùˆ Ù‡Ø¯Ù

### Ù‡Ø¯Ù Ø§ØµÙ„ÛŒ
ØªÙˆÙ„ÛŒØ¯ ÛŒÚ© ÙØ§ÛŒÙ„ Excel Ú©Ø§Ù…Ù„ Ú©Ù‡:
- âœ… Ù‡Ù…Ù‡ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¯Ø± Ø³Ø±ÙˆØ± (Python) Ø§Ù†Ø¬Ø§Ù… Ø´ÙˆØ¯
- âœ… Ù†ØªØ§ÛŒØ¬ Ù†Ù‡Ø§ÛŒÛŒ Ø¯Ø± Excel Ø°Ø®ÛŒØ±Ù‡ Ø´ÙˆØ¯
- âœ… Ø§Ø³ØªØ§ÛŒÙ„ Ùˆ ÙØ±Ù…Øªâ€ŒØ¨Ù†Ø¯ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯
- âœ… Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ù¾Ø±ÙˆÚ˜Ù‡ Ø±Ø§ Ø±Ø¹Ø§ÛŒØª Ú©Ù†Ø¯
- âœ… Ù‚Ø§Ø¨Ù„ÛŒØª Ú†Ø§Ù¾ Ùˆ Ø§Ø±Ø§Ø¦Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯

### ØªÙØ§ÙˆØª Ø¨Ø§ Excel Dynamic
| ÙˆÛŒÚ˜Ú¯ÛŒ | Static | Dynamic |
|--------|--------|---------|
| Ù…Ø­Ø§Ø³Ø¨Ø§Øª | Ø¯Ø± Ø³Ø±ÙˆØ± (Python) âœ… | Ø¯Ø± Excel (ÙØ±Ù…ÙˆÙ„) |
| Ù‚Ø§Ø¨Ù„ÛŒØª ÙˆÛŒØ±Ø§ÛŒØ´ | Ø®ÛŒØ± | Ø¨Ù„Ù‡ |
| Ø´ÙØ§ÙÛŒØª | Ù…ØªÙˆØ³Ø· | Ø¨Ø§Ù„Ø§ |
| Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ | Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªÙˆÙ„ÛŒØ¯ Ù…Ø¬Ø¯Ø¯ | Ø®ÙˆØ¯Ú©Ø§Ø± |
| Ø­Ø¬Ù… ÙØ§ÛŒÙ„ | Ú©Ù…ØªØ± âœ… | Ø¨ÛŒØ´ØªØ± |
| Ø³Ø±Ø¹Øª ØªÙˆÙ„ÛŒØ¯ | Ø³Ø±ÛŒØ¹â€ŒØªØ± âœ… | Ú©Ù†Ø¯ØªØ± |
| Ø§Ø³ØªÙØ§Ø¯Ù‡ | Ú¯Ø²Ø§Ø±Ø´â€ŒÚ¯ÛŒØ±ÛŒØŒ Ú†Ø§Ù¾ âœ… | ØªØ­Ù„ÛŒÙ„ØŒ ÙˆÛŒØ±Ø§ÛŒØ´ |

### Ú©Ø§Ø±Ø¨Ø±Ø¯Ù‡Ø§
- ğŸ“„ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ÛŒ Ø±Ø³Ù…ÛŒ
- ğŸ–¨ï¸ Ú†Ø§Ù¾ Ùˆ Ø§Ø±Ø§Ø¦Ù‡
- ğŸ“§ Ø§Ø±Ø³Ø§Ù„ Ø§ÛŒÙ…ÛŒÙ„
- ğŸ’¾ Ø¢Ø±Ø´ÛŒÙˆ Ùˆ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ
- ğŸ“Š Ø§Ø³Ù†Ø§Ù¾â€ŒØ´Ø§Øª Ø§Ø² ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡

---

## ğŸ—ï¸ Ø³Ø§Ø®ØªØ§Ø± Ú©Ù„ÛŒ

### ÙØ§ÛŒÙ„ Ø§ØµÙ„ÛŒ
```
construction/excel_export.py
```

### Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ
```python
ExcelExportService              # Ø³Ø±ÙˆÛŒØ³ Ø§ØµÙ„ÛŒ ØªÙˆÙ„ÛŒØ¯ Excel
ExcelStyleHelper                # Ú©Ù…Ú©â€ŒÚ©Ù†Ù†Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§
ProjectColors                   # Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ù¾Ø±ÙˆÚ˜Ù‡

# Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ÛŒ Ø´ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡
ProjectSheet                    # Ø´ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡
UnitsSheet                      # Ø´ÛŒØª ÙˆØ§Ø­Ø¯Ù‡Ø§
InvestorSheet                   # Ø´ÛŒØª Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±Ø§Ù†
PeriodSheet                     # Ø´ÛŒØª Ø¯ÙˆØ±Ù‡â€ŒÙ‡Ø§
InterestRateSheet               # Ø´ÛŒØª Ù†Ø±Ø® Ø³ÙˆØ¯
TransactionSheet                # Ø´ÛŒØª ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§
ExpenseSheet                    # Ø´ÛŒØª Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
SaleSheet                       # Ø´ÛŒØª ÙØ±ÙˆØ´
UserProfileSheet                # Ø´ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†

# Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ÛŒ Ø´ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ø§ØªÛŒ
TableOfContentsSheet            # ÙÙ‡Ø±Ø³Øª
DashboardSheet                  # Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
ProfitMetricsSheet              # Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø³ÙˆØ¯
CostMetricsSheet                # Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù‡Ø²ÛŒÙ†Ù‡
InvestorAnalysisSheet           # ØªØ­Ù„ÛŒÙ„ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±Ø§Ù†
PeriodSummarySheet              # Ø®Ù„Ø§ØµÙ‡ Ø¯ÙˆØ±Ù‡â€ŒØ§ÛŒ
TransactionSummarySheet         # Ø®Ù„Ø§ØµÙ‡ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§
```

### API Endpoint
```
GET /construction/api/v1/Project/export_excel_static/
```

### Django Management Command
```bash
python manage.py export_excel
# ÛŒØ§
python manage.py export_excel --output myfile.xlsx
```

---

## ğŸ“‹ Ø´ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯

### 1ï¸âƒ£ Ø´ÛŒØª ÙÙ‡Ø±Ø³Øª

#### `ğŸ“‹ ÙÙ‡Ø±Ø³Øª`
- **Ù‡Ø¯Ù**: ÙÙ‡Ø±Ø³Øª ØªÙ…Ø§Ù… Ø´ÛŒØªâ€ŒÙ‡Ø§ Ø¨Ø§ Ù„ÛŒÙ†Ú© Ù…Ø³ØªÙ‚ÛŒÙ…
- **Ù…Ø­ØªÙˆØ§**: 
  - Ù†Ø§Ù… Ø´ÛŒØª
  - ØªÙˆØ¶ÛŒØ­ Ù…Ø®ØªØµØ±
  - Ù„ÛŒÙ†Ú© Ù‡Ø§ÛŒÙ¾Ø±Ù„ÛŒÙ†Ú© Ø¨Ù‡ Ø´ÛŒØª
- **ÙˆÛŒÚ˜Ú¯ÛŒ**: 
  - Ø§Ø³ØªØ§ÛŒÙ„ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ
  - Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ø´Ø¯Ù‡
  - Ù‚Ø§Ø¨Ù„ÛŒØª Ú©Ù„ÛŒÚ©

**Ú©Ø¯ Ù†Ù…ÙˆÙ†Ù‡**:
```python
class TableOfContentsSheet:
    @staticmethod
    def create(workbook, project):
        ws = workbook.create_sheet("ğŸ“‹ ÙÙ‡Ø±Ø³Øª", 0)
        
        # Ø¹Ù†ÙˆØ§Ù†
        ws['A1'] = f'ÙÙ‡Ø±Ø³Øª - {project.name}'
        ws['A1'].font = Font(size=16, bold=True)
        
        # Ù„ÛŒØ³Øª Ø´ÛŒØªâ€ŒÙ‡Ø§
        sheets = [
            ('Project', 'Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ø±ÙˆÚ˜Ù‡', 'info'),
            ('Units', 'ÙˆØ§Ø­Ø¯Ù‡Ø§ÛŒ Ø³Ø§Ø®ØªÙ…Ø§Ù†ÛŒ', 'data'),
            # ...
        ]
        
        row = 3
        for sheet_name, description, category in sheets:
            # Ø§ÛŒØ¬Ø§Ø¯ Ù‡Ø§ÛŒÙ¾Ø±Ù„ÛŒÙ†Ú©
            ws.cell(row=row, column=1).hyperlink = f"#{sheet_name}!A1"
            ws.cell(row=row, column=1).value = sheet_name
            ws.cell(row=row, column=2).value = description
            row += 1
```

---

### 2ï¸âƒ£ Ø´ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø¯Ù‡ Ù¾Ø§ÛŒÙ‡

#### `Project`
**Ù…Ø­ØªÙˆØ§**: Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ù„ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡

**Ø³ØªÙˆÙ†â€ŒÙ‡Ø§**:
- ID
- Ù†Ø§Ù… Ù¾Ø±ÙˆÚ˜Ù‡
- ØªØ§Ø±ÛŒØ® Ø´Ø±ÙˆØ¹ (Ø´Ù…Ø³ÛŒ/Ù…ÛŒÙ„Ø§Ø¯ÛŒ)
- ØªØ§Ø±ÛŒØ® Ù¾Ø§ÛŒØ§Ù† (Ø´Ù…Ø³ÛŒ/Ù…ÛŒÙ„Ø§Ø¯ÛŒ)
- ÙØ¹Ø§Ù„
- Ø²ÛŒØ±Ø¨Ù†Ø§ÛŒ Ú©Ù„
- Ø¶Ø±ÛŒØ¨ Ø§ØµÙ„Ø§Ø­ÛŒ
- ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯/Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ

**ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§**:
- Freeze header row
- Auto-filter
- Column width adjustment

**Ú©Ø¯ Ù†Ù…ÙˆÙ†Ù‡**:
```python
class ProjectSheet:
    @staticmethod
    def create(workbook, project):
        ws = workbook.create_sheet(title="Project")
        
        # Ù‡Ø¯Ø±Ù‡Ø§
        headers = [
            'ID', 'Ù†Ø§Ù… Ù¾Ø±ÙˆÚ˜Ù‡', 'ØªØ§Ø±ÛŒØ® Ø´Ø±ÙˆØ¹ (Ø´Ù…Ø³ÛŒ)', 
            'ØªØ§Ø±ÛŒØ® Ø´Ø±ÙˆØ¹ (Ù…ÛŒÙ„Ø§Ø¯ÛŒ)', 'ØªØ§Ø±ÛŒØ® Ù¾Ø§ÛŒØ§Ù† (Ø´Ù…Ø³ÛŒ)', 
            'ØªØ§Ø±ÛŒØ® Ù¾Ø§ÛŒØ§Ù† (Ù…ÛŒÙ„Ø§Ø¯ÛŒ)', 'ÙØ¹Ø§Ù„', 
            'Ø²ÛŒØ±Ø¨Ù†Ø§ÛŒ Ú©Ù„', 'Ø¶Ø±ÛŒØ¨ Ø§ØµÙ„Ø§Ø­ÛŒ', 
            'ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯', 'ØªØ§Ø±ÛŒØ® Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ'
        ]
        
        # Ù†ÙˆØ´ØªÙ† Ù‡Ø¯Ø±Ù‡Ø§
        for col_num, header in enumerate(headers, 1):
            cell = ws.cell(row=1, column=col_num, value=header)
            ExcelStyleHelper.apply_header_style(cell)
        
        # Ù†ÙˆØ´ØªÙ† Ø¯Ø§Ø¯Ù‡
        data = [
            project.id,
            project.name,
            project.start_date_shamsi,
            project.start_date,
            project.end_date_shamsi,
            project.end_date,
            'Ø¨Ù„Ù‡' if project.is_active else 'Ø®ÛŒØ±',
            float(project.total_infrastructure) if project.total_infrastructure else 0,
            float(project.correction_factor) if project.correction_factor else 0,
            project.created_at,
            project.updated_at
        ]
        
        for col_num, value in enumerate(data, 1):
            cell = ws.cell(row=2, column=col_num, value=value)
            ExcelStyleHelper.apply_cell_style(cell)
        
        # ØªÙ†Ø¸ÛŒÙ…Ø§Øª
        ExcelStyleHelper.freeze_header_row(ws)
        ExcelStyleHelper.add_auto_filter(ws)
        ExcelStyleHelper.auto_adjust_column_width(ws)
```

---

#### `Units`
**Ù…Ø­ØªÙˆØ§**: ÙˆØ§Ø­Ø¯Ù‡Ø§ÛŒ Ø³Ø§Ø®ØªÙ…Ø§Ù†ÛŒ

**Ø³ØªÙˆÙ†â€ŒÙ‡Ø§**:
- ID
- Ø´Ù†Ø§Ø³Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡
- Ù†Ø§Ù… Ù¾Ø±ÙˆÚ˜Ù‡
- Ù†Ø§Ù… ÙˆØ§Ø­Ø¯
- Ù…ØªØ±Ø§Ú˜
- Ù‚ÛŒÙ…Øª Ù‡Ø± Ù…ØªØ±
- Ù‚ÛŒÙ…Øª Ù†Ù‡Ø§ÛŒÛŒ
- ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯

**Ù…Ø­Ø§Ø³Ø¨Ø§Øª**:
```python
# Ù‚ÛŒÙ…Øª Ù†Ù‡Ø§ÛŒÛŒ = Ù…ØªØ±Ø§Ú˜ Ã— Ù‚ÛŒÙ…Øª Ù‡Ø± Ù…ØªØ±
final_price = unit.area * unit.price_per_meter
```

---

#### `Investors`
**Ù…Ø­ØªÙˆØ§**: Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±Ø§Ù†

**Ø³ØªÙˆÙ†â€ŒÙ‡Ø§**:
- ID
- Ù†Ø§Ù…
- Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ
- Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³
- Ø§ÛŒÙ…ÛŒÙ„
- Ù†ÙˆØ¹ Ù…Ø´Ø§Ø±Ú©Øª
- ÙˆØ§Ø­Ø¯Ù‡Ø§ (Ù„ÛŒØ³Øª)
- ØªØ§Ø±ÛŒØ® Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ (Ø´Ù…Ø³ÛŒ)
- ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯

**ÙˆÛŒÚ˜Ú¯ÛŒ Ø®Ø§Øµ**:
```python
# ÙˆØ§Ø­Ø¯Ù‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ù„ÛŒØ³Øª Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
units_list = ', '.join([unit.name for unit in investor.units.all()])
```

---

#### `Periods`
**Ù…Ø­ØªÙˆØ§**: Ø¯ÙˆØ±Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù…Ø§Ù†ÛŒ

**Ø³ØªÙˆÙ†â€ŒÙ‡Ø§**:
- ID
- Ø´Ù†Ø§Ø³Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡
- Ø¹Ù†ÙˆØ§Ù† Ø¯ÙˆØ±Ù‡
- Ø³Ø§Ù„ Ø´Ù…Ø³ÛŒ
- Ø´Ù…Ø§Ø±Ù‡ Ù…Ø§Ù‡
- Ù†Ø§Ù… Ù…Ø§Ù‡
- **ÙˆØ²Ù† Ø¯ÙˆØ±Ù‡** â­
- ØªØ§Ø±ÛŒØ® Ø´Ø±ÙˆØ¹ (Ø´Ù…Ø³ÛŒ/Ù…ÛŒÙ„Ø§Ø¯ÛŒ)
- ØªØ§Ø±ÛŒØ® Ù¾Ø§ÛŒØ§Ù† (Ø´Ù…Ø³ÛŒ/Ù…ÛŒÙ„Ø§Ø¯ÛŒ)

**Ù†Ú©ØªÙ‡ Ù…Ù‡Ù…**: ÙˆØ²Ù† Ø¯ÙˆØ±Ù‡ Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯ÙˆØ±Ù‡ Ù…ØªÙˆØ³Ø· Ø³Ø§Ø®Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯

---

#### `InterestRates`
**Ù…Ø­ØªÙˆØ§**: Ù†Ø±Ø®â€ŒÙ‡Ø§ÛŒ Ø³ÙˆØ¯

**Ø³ØªÙˆÙ†â€ŒÙ‡Ø§**:
- ID
- Ù†Ø±Ø® Ø³ÙˆØ¯ Ø±ÙˆØ²Ø§Ù†Ù‡
- ØªØ§Ø±ÛŒØ® Ø§Ø¹Ù…Ø§Ù„ (Ø´Ù…Ø³ÛŒ/Ù…ÛŒÙ„Ø§Ø¯ÛŒ)
- ØªÙˆØ¶ÛŒØ­Ø§Øª
- ÙØ¹Ø§Ù„
- ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯

---

#### `Transactions`
**Ù…Ø­ØªÙˆØ§**: ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ

**Ø³ØªÙˆÙ†â€ŒÙ‡Ø§**:
- ID
- Ø´Ù†Ø§Ø³Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡
- Ø´Ù†Ø§Ø³Ù‡ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±
- Ù†Ø§Ù… Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±
- Ø´Ù†Ø§Ø³Ù‡ Ø¯ÙˆØ±Ù‡
- Ø¹Ù†ÙˆØ§Ù† Ø¯ÙˆØ±Ù‡
- ØªØ§Ø±ÛŒØ® (Ø´Ù…Ø³ÛŒ/Ù…ÛŒÙ„Ø§Ø¯ÛŒ)
- **Ù…Ø¨Ù„Øº** â­
- **Ù†ÙˆØ¹ ØªØ±Ø§Ú©Ù†Ø´** â­ (Ø¢ÙˆØ±Ø¯Ù‡ØŒ Ø®Ø±ÙˆØ¬ Ø§Ø² Ø³Ø±Ù…Ø§ÛŒÙ‡ØŒ Ø³ÙˆØ¯)
- ØªÙˆØ¶ÛŒØ­Ø§Øª
- Ø±ÙˆØ² Ù…Ø§Ù†Ø¯Ù‡
- Ø±ÙˆØ² Ø§Ø² Ø´Ø±ÙˆØ¹
- Ø´Ù†Ø§Ø³Ù‡ Ù†Ø±Ø® Ø³ÙˆØ¯
- ØªÙˆÙ„ÛŒØ¯ Ø³ÛŒØ³ØªÙ…ÛŒ
- Ø´Ù†Ø§Ø³Ù‡ ØªØ±Ø§Ú©Ù†Ø´ Ø§ØµÙ„ÛŒ
- ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯

**Ø§Ù†ÙˆØ§Ø¹ ØªØ±Ø§Ú©Ù†Ø´**:
```python
TRANSACTION_TYPES = [
    ('principal_deposit', 'Ø¢ÙˆØ±Ø¯Ù‡'),
    ('principal_withdrawal', 'Ø®Ø±ÙˆØ¬ Ø§Ø² Ø³Ø±Ù…Ø§ÛŒÙ‡'),
    ('profit', 'Ø³ÙˆØ¯'),
]
```

---

#### `Expenses`
**Ù…Ø­ØªÙˆØ§**: Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§

**Ø³ØªÙˆÙ†â€ŒÙ‡Ø§**:
- ID
- Ø´Ù†Ø§Ø³Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡
- Ø´Ù†Ø§Ø³Ù‡ Ø¯ÙˆØ±Ù‡
- Ø¹Ù†ÙˆØ§Ù† Ø¯ÙˆØ±Ù‡
- Ù†ÙˆØ¹ Ù‡Ø²ÛŒÙ†Ù‡
- **Ù…Ø¨Ù„Øº** â­
- ØªÙˆØ¶ÛŒØ­Ø§Øª
- ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯

**Ù†Ú©ØªÙ‡**: Ù†ÙˆØ¹ Ù‡Ø²ÛŒÙ†Ù‡ Ø´Ø§Ù…Ù„ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù (Ù…Ø¯ÛŒØ± Ù¾Ø±ÙˆÚ˜Ù‡ØŒ Ø³Ø±Ù¾Ø±Ø³ØªØŒ Ú©Ø§Ø±Ù¾Ø±Ø¯Ø§Ø²ØŒ Ø§Ù†Ø¨Ø§Ø±Ø¯Ø§Ø±ØŒ Ù¾ÛŒÙ…Ø§Ù†Ú©Ø§Ø±)

---

#### `Sales`
**Ù…Ø­ØªÙˆØ§**: ÙØ±ÙˆØ´/Ù…Ø±Ø¬ÙˆØ¹ÛŒ

**Ø³ØªÙˆÙ†â€ŒÙ‡Ø§**:
- ID
- Ø´Ù†Ø§Ø³Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡
- Ø´Ù†Ø§Ø³Ù‡ Ø¯ÙˆØ±Ù‡
- Ø¹Ù†ÙˆØ§Ù† Ø¯ÙˆØ±Ù‡
- **Ù…Ø¨Ù„Øº** â­
- ØªÙˆØ¶ÛŒØ­Ø§Øª
- ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯

**Ù†Ú©ØªÙ‡**: Ù…Ø¨Ø§Ù„Øº ÙØ±ÙˆØ´ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ù‡Ø´ Ù‡Ø²ÛŒÙ†Ù‡ Ø®Ø§Ù„Øµ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯

---

#### `UserProfiles`
**Ù…Ø­ØªÙˆØ§**: Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø³ÛŒØ³ØªÙ…

**Ø³ØªÙˆÙ†â€ŒÙ‡Ø§**:
- ID
- Ø´Ù†Ø§Ø³Ù‡ Ú©Ø§Ø±Ø¨Ø±
- Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ
- Ù†Ù‚Ø´
- Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ†
- Ø¨Ø®Ø´
- ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯

---

### 3ï¸âƒ£ Ø´ÛŒØª Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯

#### `Dashboard` â­â­â­
**Ù…Ù‡Ù…â€ŒØªØ±ÛŒÙ† Ø´ÛŒØª - Ù†Ù…Ø§ÛŒ Ú©Ù„ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡**

**Ø¨Ø®Ø´ 1: Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆØ§Ø­Ø¯Ù‡Ø§**
```python
# Ù…Ø­Ø§Ø³Ø¨Ø§Øª
units_data = ProjectCalculations.calculate_project_statistics(project)

ØªØ¹Ø¯Ø§Ø¯ ÙˆØ§Ø­Ø¯Ù‡Ø§ = units_data['units']['count']
Ù…ØªØ±Ø§Ú˜ Ú©Ù„ = units_data['units']['total_area']
Ø§Ø±Ø²Ø´ Ú©Ù„ = units_data['units']['total_value']
```

**Ø¨Ø®Ø´ 2: Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø§Ù„ÛŒ**
```python
# Ù…Ø­Ø§Ø³Ø¨Ø§Øª
financial_data = ProjectCalculations.calculate_project_statistics(project)

Ø¢ÙˆØ±Ø¯Ù‡ Ú©Ù„ = financial_data['financial']['total_deposits']
Ø¨Ø±Ø¯Ø§Ø´Øª Ú©Ù„ = financial_data['financial']['total_withdrawals']
Ø³Ø±Ù…Ø§ÛŒÙ‡ Ù…ÙˆØ¬ÙˆØ¯ = financial_data['financial']['net_principal']
Ø³ÙˆØ¯ Ú©Ù„ = financial_data['financial']['total_profit']
Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„ = financial_data['financial']['grand_total']
```

**Ø¨Ø®Ø´ 3: Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø²Ù…Ø§Ù†ÛŒ**
```python
# Ù…Ø­Ø§Ø³Ø¨Ø§Øª
time_data = ProjectCalculations.calculate_project_statistics(project)

ØªØ§Ø±ÛŒØ® Ø´Ø±ÙˆØ¹ = project.start_date
ØªØ§Ø±ÛŒØ® Ù¾Ø§ÛŒØ§Ù† = project.end_date
Ù…Ø¯Øª Ù¾Ø±ÙˆÚ˜Ù‡ (Ø±ÙˆØ²) = time_data['time']['project_duration']
Ø±ÙˆØ²Ù‡Ø§ÛŒ ÙØ¹Ø§Ù„ = time_data['time']['active_days']
```

**Ø§Ø³ØªØ§ÛŒÙ„**:
- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø±Ù†Ú¯ÛŒ Ø¨Ø§ Ú¯Ø±Ø§Ø¯ÛŒØ§Ù†Øª
- Ø¢ÛŒÚ©ÙˆÙ†â€ŒÙ‡Ø§ÛŒ Font Awesome
- Shadow Ùˆ Border Radius
- Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ù¾Ø±ÙˆÚ˜Ù‡

---

### 4ï¸âƒ£ Ø´ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ø§ØªÛŒ

#### `Profit_Metrics`
**Ù…Ø­ØªÙˆØ§**: Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø³ÙˆØ¯

**Ù…Ø­Ø§Ø³Ø¨Ø§Øª**:
```python
profit_data = ProfitCalculations.calculate_profit_percentages(project)

# Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø§ØµÙ„ÛŒ
Ø³Ø±Ù…Ø§ÛŒÙ‡ Ú©Ù„ = profit_data['total_capital']
Ø³ÙˆØ¯ Ú©Ù„ = profit_data['total_profit']
Ø¯Ø±ØµØ¯ Ø³ÙˆØ¯ Ú©Ù„ = profit_data['total_profit_percentage']

# Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø²Ù…Ø§Ù†ÛŒ
Ø¯ÙˆØ±Ù‡ Ù…ØªÙˆØ³Ø· Ø³Ø§Ø®Øª = profit_data['average_construction_period']
Ø¯Ø±ØµØ¯ Ø³ÙˆØ¯ Ø³Ø§Ù„Ø§Ù†Ù‡ = profit_data['annual_profit_percentage']
Ø¯Ø±ØµØ¯ Ø³ÙˆØ¯ Ù…Ø§Ù‡Ø§Ù†Ù‡ = profit_data['monthly_profit_percentage']
Ø¯Ø±ØµØ¯ Ø³ÙˆØ¯ Ø±ÙˆØ²Ø§Ù†Ù‡ = profit_data['daily_profit_percentage']
```

**ÙØ±Ù…ÙˆÙ„â€ŒÙ‡Ø§**:
```python
# Ø¯Ø±ØµØ¯ Ø³ÙˆØ¯ Ú©Ù„
total_profit_percentage = (total_profit / total_capital) * 100

# Ø¯ÙˆØ±Ù‡ Ù…ØªÙˆØ³Ø· Ø³Ø§Ø®Øª (Ù…Ø§Ù‡)
average_period = Î£(Ù‡Ø²ÛŒÙ†Ù‡_Ø¯ÙˆØ±Ù‡ Ã— ÙˆØ²Ù†_Ø¯ÙˆØ±Ù‡) / Î£(Ú©Ù„_Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§)

# Ø¯Ø±ØµØ¯ Ø³ÙˆØ¯ Ø³Ø§Ù„Ø§Ù†Ù‡
annual_percentage = (total_profit_percentage / average_period) * 12

# Ø¯Ø±ØµØ¯ Ø³ÙˆØ¯ Ù…Ø§Ù‡Ø§Ù†Ù‡
monthly_percentage = annual_percentage / 12

# Ø¯Ø±ØµØ¯ Ø³ÙˆØ¯ Ø±ÙˆØ²Ø§Ù†Ù‡
daily_percentage = monthly_percentage / 30
```

---

#### `Cost_Metrics`
**Ù…Ø­ØªÙˆØ§**: Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù‡Ø²ÛŒÙ†Ù‡

**Ù…Ø­Ø§Ø³Ø¨Ø§Øª**:
```python
cost_data = ProjectCalculations.calculate_cost_metrics(project)

# Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
Ù‡Ø²ÛŒÙ†Ù‡ Ú©Ù„ = cost_data['total_expenses']
ÙØ±ÙˆØ´ Ú©Ù„ = cost_data['total_sales']
Ù‡Ø²ÛŒÙ†Ù‡ Ø®Ø§Ù„Øµ = cost_data['net_cost']

# Ù‡Ø²ÛŒÙ†Ù‡ Ù…ØªØ±ÛŒ
Ù‡Ø²ÛŒÙ†Ù‡ Ù‡Ø± Ù…ØªØ± Ø®Ø§Ù„Øµ = cost_data['net_cost_per_meter']
Ù‡Ø²ÛŒÙ†Ù‡ Ù‡Ø± Ù…ØªØ± Ù†Ø§Ø®Ø§Ù„Øµ = cost_data['gross_cost_per_meter']

# Ø§Ø±Ø²Ø´ Ùˆ Ø³ÙˆØ¯
Ø§Ø±Ø²Ø´ Ú©Ù„ = cost_data['total_value']
Ø§Ø±Ø²Ø´ Ù‡Ø± Ù…ØªØ± = cost_data['value_per_meter']
Ø³ÙˆØ¯ Ù†Ù‡Ø§ÛŒÛŒ = cost_data['final_profit']
Ø¯Ø±ØµØ¯ Ø³ÙˆØ¯ Ú©Ù„ = cost_data['total_profit_percentage']
```

**ÙØ±Ù…ÙˆÙ„â€ŒÙ‡Ø§**:
```python
# Ù‡Ø²ÛŒÙ†Ù‡ Ø®Ø§Ù„Øµ
net_cost = total_expenses - total_sales

# Ù‡Ø²ÛŒÙ†Ù‡ Ù‡Ø± Ù…ØªØ± Ø®Ø§Ù„Øµ
net_cost_per_meter = net_cost / total_area

# Ù‡Ø²ÛŒÙ†Ù‡ Ù‡Ø± Ù…ØªØ± Ù†Ø§Ø®Ø§Ù„Øµ
gross_cost_per_meter = net_cost / total_infrastructure

# Ø³ÙˆØ¯ Ù†Ù‡Ø§ÛŒÛŒ
final_profit = total_value - net_cost

# Ø¯Ø±ØµØ¯ Ø³ÙˆØ¯ Ú©Ù„
total_profit_percentage = (final_profit / net_cost) * 100
```

---

#### `Investor_Analysis`
**Ù…Ø­ØªÙˆØ§**: ØªØ­Ù„ÛŒÙ„ Ù‡Ø± Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±

**Ø³ØªÙˆÙ†â€ŒÙ‡Ø§**:
- Ù†Ø§Ù… Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±
- Ø¢ÙˆØ±Ø¯Ù‡ Ú©Ù„
- Ø¨Ø±Ø¯Ø§Ø´Øª Ú©Ù„
- Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø®Ø§Ù„Øµ
- Ø³ÙˆØ¯ Ú©Ù„
- Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„
- Ù†Ø³Ø¨Øª Ø³Ø±Ù…Ø§ÛŒÙ‡ (%)
- Ù†Ø³Ø¨Øª Ø³ÙˆØ¯ (%)
- Ù†Ø³Ø¨Øª Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„ (%)
- **Ø´Ø§Ø®Øµ Ù†ÙØ¹** â­

**Ù…Ø­Ø§Ø³Ø¨Ø§Øª**:
```python
for investor in investors:
    # ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§
    deposits = Transaction.objects.filter(
        investor=investor,
        transaction_type='principal_deposit'
    ).aggregate(Sum('amount'))['amount__sum'] or 0
    
    withdrawals = Transaction.objects.filter(
        investor=investor,
        transaction_type='principal_withdrawal'
    ).aggregate(Sum('amount'))['amount__sum'] or 0
    
    profits = Transaction.objects.filter(
        investor=investor,
        transaction_type='profit'
    ).aggregate(Sum('amount'))['amount__sum'] or 0
    
    # Ù…Ø­Ø§Ø³Ø¨Ø§Øª
    net_principal = deposits + withdrawals  # withdrawals Ù…Ù†ÙÛŒ Ø§Ø³Øª
    total_balance = net_principal + profits
    
    # Ù†Ø³Ø¨Øªâ€ŒÙ‡Ø§
    capital_ratio = (net_principal / total_capital) * 100
    profit_ratio = (profits / total_profit) * 100
    balance_ratio = (total_balance / grand_total) * 100
    
    # Ø´Ø§Ø®Øµ Ù†ÙØ¹
    profit_index = profit_ratio / capital_ratio if capital_ratio > 0 else 0
```

**Ø´Ø§Ø®Øµ Ù†ÙØ¹**:
```
Ø´Ø§Ø®Øµ Ù†ÙØ¹ = Ù†Ø³Ø¨Øª Ø³ÙˆØ¯ / Ù†Ø³Ø¨Øª Ø³Ø±Ù…Ø§ÛŒÙ‡

Ù…Ø«Ø§Ù„:
- Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø± A: Ø³Ø±Ù…Ø§ÛŒÙ‡ 30%ØŒ Ø³ÙˆØ¯ 40% â†’ Ø´Ø§Ø®Øµ = 1.33 (Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¨Ø§Ù„Ø§ØªØ±)
- Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø± B: Ø³Ø±Ù…Ø§ÛŒÙ‡ 20%ØŒ Ø³ÙˆØ¯ 15% â†’ Ø´Ø§Ø®Øµ = 0.75 (Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ±)
```

**Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ**:
- Ø´Ø§Ø®Øµ > 1: Ø³Ø¨Ø² (Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¨Ø§Ù„Ø§ØªØ± Ø§Ø² Ù…ØªÙˆØ³Ø·)
- Ø´Ø§Ø®Øµ = 1: Ø²Ø±Ø¯ (Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù…ØªÙˆØ³Ø·)
- Ø´Ø§Ø®Øµ < 1: Ù‚Ø±Ù…Ø² (Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ± Ø§Ø² Ù…ØªÙˆØ³Ø·)

---

#### `Period_Summary`
**Ù…Ø­ØªÙˆØ§**: Ø®Ù„Ø§ØµÙ‡ Ù‡Ø± Ø¯ÙˆØ±Ù‡

**Ø³ØªÙˆÙ†â€ŒÙ‡Ø§**:
- Ø¹Ù†ÙˆØ§Ù† Ø¯ÙˆØ±Ù‡
- Ø¢ÙˆØ±Ø¯Ù‡
- Ø¨Ø±Ø¯Ø§Ø´Øª
- Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø®Ø§Ù„Øµ
- Ø³ÙˆØ¯
- Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
- ÙØ±ÙˆØ´
- Ù…Ø§Ù†Ø¯Ù‡ ØµÙ†Ø¯ÙˆÙ‚
- Ø¢ÙˆØ±Ø¯Ù‡ ØªØ¬Ù…Ø¹ÛŒ
- Ø¨Ø±Ø¯Ø§Ø´Øª ØªØ¬Ù…Ø¹ÛŒ
- Ø³Ø±Ù…Ø§ÛŒÙ‡ ØªØ¬Ù…Ø¹ÛŒ
- Ø³ÙˆØ¯ ØªØ¬Ù…Ø¹ÛŒ
- Ù‡Ø²ÛŒÙ†Ù‡ ØªØ¬Ù…Ø¹ÛŒ
- ÙØ±ÙˆØ´ ØªØ¬Ù…Ø¹ÛŒ

**Ù…Ø­Ø§Ø³Ø¨Ø§Øª**:
```python
cumulative_deposits = 0
cumulative_withdrawals = 0
cumulative_expenses = 0
cumulative_sales = 0

for period in periods:
    # ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ Ø¯ÙˆØ±Ù‡
    period_deposits = Transaction.objects.filter(
        period=period,
        transaction_type='principal_deposit'
    ).aggregate(Sum('amount'))['amount__sum'] or 0
    
    # Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯ÙˆØ±Ù‡
    period_expenses = Expense.objects.filter(
        period=period
    ).aggregate(Sum('amount'))['amount__sum'] or 0
    
    # ÙØ±ÙˆØ´ Ø¯ÙˆØ±Ù‡
    period_sales = Sale.objects.filter(
        period=period
    ).aggregate(Sum('amount'))['amount__sum'] or 0
    
    # Ù…Ø§Ù†Ø¯Ù‡ ØµÙ†Ø¯ÙˆÙ‚
    fund_balance = cumulative_capital - (cumulative_expenses - cumulative_sales)
    
    # ØªØ¬Ù…Ø¹ÛŒ
    cumulative_deposits += period_deposits
    cumulative_expenses += period_expenses
    cumulative_sales += period_sales
```

---

#### `Transaction_Summary`
**Ù…Ø­ØªÙˆØ§**: Ø®Ù„Ø§ØµÙ‡ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§

**Ø¨Ø®Ø´ 1: Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ**
- ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§
- ØªØ¹Ø¯Ø§Ø¯ Ø¢ÙˆØ±Ø¯Ù‡
- ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø±Ø¯Ø§Ø´Øª
- ØªØ¹Ø¯Ø§Ø¯ Ø³ÙˆØ¯

**Ø¨Ø®Ø´ 2: Ù…Ø¨Ø§Ù„Øº**
- Ù…Ø¬Ù…ÙˆØ¹ Ø¢ÙˆØ±Ø¯Ù‡
- Ù…Ø¬Ù…ÙˆØ¹ Ø¨Ø±Ø¯Ø§Ø´Øª
- Ù…Ø¬Ù…ÙˆØ¹ Ø³ÙˆØ¯
- Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø®Ø§Ù„Øµ

**Ø¨Ø®Ø´ 3: ØªØ­Ù„ÛŒÙ„**
- Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù…Ø¨Ù„Øº ØªØ±Ø§Ú©Ù†Ø´
- Ø¨ÛŒØ´ØªØ±ÛŒÙ† ØªØ±Ø§Ú©Ù†Ø´
- Ú©Ù…ØªØ±ÛŒÙ† ØªØ±Ø§Ú©Ù†Ø´

---

## ğŸ¨ Ø§Ø³ØªØ§ÛŒÙ„ Ùˆ ÙØ±Ù…Øªâ€ŒØ¨Ù†Ø¯ÛŒ

### Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ù¾Ø±ÙˆÚ˜Ù‡

```python
class ProjectColors:
    """Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ù¾Ø±ÙˆÚ˜Ù‡"""
    # Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ
    DEPOSIT = '2185d0'           # Ø¢Ø¨ÛŒ - Ø¢ÙˆØ±Ø¯Ù‡ Ùˆ ÙˆØ§Ø±ÛŒØ²ÛŒ
    WITHDRAWAL = 'db2828'        # Ù‚Ø±Ù…Ø² - Ø¨Ø±Ø¯Ø§Ø´Øª Ùˆ Ø®Ø±ÙˆØ¬ÛŒ
    PROFIT = '21ba45'            # Ø³Ø¨Ø² - Ø³ÙˆØ¯ Ù…Ø´Ø§Ø±Ú©Øª Ùˆ Ø¯Ø±Ø¢Ù…Ø¯
    CAPITAL = 'aa26ff'           # Ø¨Ù†ÙØ´ - Ø³Ø±Ù…Ø§ÛŒÙ‡ Ù…ÙˆØ¬ÙˆØ¯ Ùˆ Ù…ÙˆØ¬ÙˆØ¯ÛŒ
    EXPENSE = 'dc3545'           # Ù‚Ø±Ù…Ø² ØªÛŒØ±Ù‡ - Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ Ùˆ Ø®Ø±Ø¬ÛŒ
    SALE = 'ffc107'              # Ø²Ø±Ø¯ - ÙØ±ÙˆØ´/Ù…Ø±Ø¬ÙˆØ¹ÛŒ
    BALANCE = '6c757d'           # Ø®Ø§Ú©Ø³ØªØ±ÛŒ - Ù…Ø§Ù†Ø¯Ù‡ ØµÙ†Ø¯ÙˆÙ‚ Ùˆ Ù…Ø¬Ù…ÙˆØ¹
    GOLD = 'ffd700'              # Ø·Ù„Ø§ÛŒÛŒ - Ø´Ø§Ø®Øµ Ù†ÙØ¹ Ùˆ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¨Ø±ØªØ±
    
    # Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ú©Ù…Ú©ÛŒ
    HEADER_BG = '4472C4'         # Ø¢Ø¨ÛŒ ØªÛŒØ±Ù‡ - Ù‡Ø¯Ø± Ø§ØµÙ„ÛŒ
    SUBHEADER_BG = 'B4C7E7'      # Ø¢Ø¨ÛŒ Ø±ÙˆØ´Ù† - Ù‡Ø¯Ø± ÙØ±Ø¹ÛŒ
    SECTION_BG = 'E7E6E6'        # Ø®Ø§Ú©Ø³ØªØ±ÛŒ Ø±ÙˆØ´Ù† - Ø¨Ø®Ø´â€ŒÙ‡Ø§
    WHITE = 'FFFFFF'             # Ø³ÙÛŒØ¯
```

### Ú©Ø§Ø±Ø¨Ø±Ø¯ Ø±Ù†Ú¯â€ŒÙ‡Ø§

```python
# Ú©Ø§Ø±Øª Ø¢ÙˆØ±Ø¯Ù‡
fill = PatternFill(
    start_color=ProjectColors.DEPOSIT,
    end_color=ProjectColors.DEPOSIT,
    fill_type='solid'
)

# Ú©Ø§Ø±Øª Ø³ÙˆØ¯
fill = PatternFill(
    start_color=ProjectColors.PROFIT,
    end_color=ProjectColors.PROFIT,
    fill_type='solid'
)

# Ú©Ø§Ø±Øª Ø´Ø§Ø®Øµ Ù†ÙØ¹
fill = PatternFill(
    start_color=ProjectColors.GOLD,
    end_color=ProjectColors.GOLD,
    fill_type='solid'
)
```

---

### Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶

#### Ù‡Ø¯Ø± Ø¬Ø¯ÙˆÙ„
```python
def get_header_font():
    return Font(
        name='Tahoma',
        size=11,
        bold=True,
        color='FFFFFF'
    )

def get_header_fill():
    return PatternFill(
        start_color=ProjectColors.HEADER_BG,
        end_color=ProjectColors.HEADER_BG,
        fill_type='solid'
    )

def get_header_alignment():
    return Alignment(
        horizontal='center',
        vertical='center',
        wrap_text=True
    )
```

#### Ø³Ù„ÙˆÙ„ Ø¹Ø§Ø¯ÛŒ
```python
def apply_cell_style(cell):
    cell.font = Font(name='Tahoma', size=10)
    cell.alignment = Alignment(
        horizontal='right',
        vertical='center'
    )
    cell.border = Border(
        left=Side(style='thin'),
        right=Side(style='thin'),
        top=Side(style='thin'),
        bottom=Side(style='thin')
    )
```

---

### ÙØ±Ù…Øªâ€ŒÙ‡Ø§ÛŒ Ø¹Ø¯Ø¯ÛŒ

```python
# Ù…Ø¨Ø§Ù„Øº Ù…Ø§Ù„ÛŒ
cell.number_format = '#,##0.00'

# Ø¯Ø±ØµØ¯
cell.number_format = '0.00%'

# ØªØ¹Ø¯Ø§Ø¯
cell.number_format = '#,##0'

# ØªØ§Ø±ÛŒØ®
cell.number_format = 'yyyy-mm-dd'
```

---

### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø¶Ø§ÙÛŒ

#### Freeze Header Row
```python
def freeze_header_row(ws):
    """ÙØ±ÛŒØ² Ú©Ø±Ø¯Ù† Ø±Ø¯ÛŒÙ Ù‡Ø¯Ø±"""
    ws.freeze_panes = 'A2'
```

#### Auto Filter
```python
def add_auto_filter(ws):
    """Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ÙÛŒÙ„ØªØ± Ø®ÙˆØ¯Ú©Ø§Ø±"""
    ws.auto_filter.ref = ws.dimensions
```

#### Auto Adjust Column Width
```python
def auto_adjust_column_width(ws):
    """ØªÙ†Ø¸ÛŒÙ… Ø®ÙˆØ¯Ú©Ø§Ø± Ø¹Ø±Ø¶ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§"""
    for column in ws.columns:
        max_length = 0
        column_letter = column[0].column_letter
        
        for cell in column:
            if cell.value:
                max_length = max(max_length, len(str(cell.value)))
        
        adjusted_width = min(max_length + 2, 50)
        ws.column_dimensions[column_letter].width = adjusted_width
```

---

## ğŸ§® Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø³Ø±ÙˆØ±

### Ø³Ø±ÙˆÛŒØ³ Ù…Ø­Ø§Ø³Ø¨Ø§Øª

```python
# construction/calculations.py

class ProjectCalculations:
    """Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ú©Ù„ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡"""
    
    @staticmethod
    def calculate_project_statistics(project):
        """Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡"""
        # Ù…Ø­Ø§Ø³Ø¨Ø§Øª ÙˆØ§Ø­Ø¯Ù‡Ø§
        units = Unit.objects.filter(project=project)
        units_data = {
            'count': units.count(),
            'total_area': units.aggregate(Sum('area'))['area__sum'] or 0,
            'total_value': units.aggregate(
                total=Sum(F('area') * F('price_per_meter'))
            )['total'] or 0
        }
        
        # Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù…Ø§Ù„ÛŒ
        transactions = Transaction.objects.filter(project=project)
        deposits = transactions.filter(
            transaction_type='principal_deposit'
        ).aggregate(Sum('amount'))['amount__sum'] or 0
        
        withdrawals = transactions.filter(
            transaction_type='principal_withdrawal'
        ).aggregate(Sum('amount'))['amount__sum'] or 0
        
        profits = transactions.filter(
            transaction_type='profit'
        ).aggregate(Sum('amount'))['amount__sum'] or 0
        
        financial_data = {
            'total_deposits': deposits,
            'total_withdrawals': withdrawals,
            'net_principal': deposits + withdrawals,
            'total_profit': profits,
            'grand_total': deposits + withdrawals + profits
        }
        
        # Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø²Ù…Ø§Ù†ÛŒ
        time_data = {
            'start_date': project.start_date,
            'end_date': project.end_date,
            'project_duration': (project.end_date - project.start_date).days,
            'active_days': (timezone.now().date() - project.start_date).days
        }
        
        return {
            'units': units_data,
            'financial': financial_data,
            'time': time_data
        }
    
    @staticmethod
    def calculate_cost_metrics(project):
        """Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ù‡Ø²ÛŒÙ†Ù‡"""
        # Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
        expenses = Expense.objects.filter(project=project)
        total_expenses = expenses.aggregate(Sum('amount'))['amount__sum'] or 0
        
        # ÙØ±ÙˆØ´
        sales = Sale.objects.filter(project=project)
        total_sales = sales.aggregate(Sum('amount'))['amount__sum'] or 0
        
        # Ù‡Ø²ÛŒÙ†Ù‡ Ø®Ø§Ù„Øµ
        net_cost = total_expenses - total_sales
        
        # Ù…ØªØ±Ø§Ú˜
        units = Unit.objects.filter(project=project)
        total_area = units.aggregate(Sum('area'))['area__sum'] or 0
        
        # Ù‡Ø²ÛŒÙ†Ù‡ Ù…ØªØ±ÛŒ
        net_cost_per_meter = net_cost / total_area if total_area > 0 else 0
        gross_cost_per_meter = net_cost / project.total_infrastructure if project.total_infrastructure > 0 else 0
        
        # Ø§Ø±Ø²Ø´
        total_value = units.aggregate(
            total=Sum(F('area') * F('price_per_meter'))
        )['total'] or 0
        value_per_meter = total_value / total_area if total_area > 0 else 0
        
        # Ø³ÙˆØ¯
        final_profit = total_value - net_cost
        total_profit_percentage = (final_profit / net_cost * 100) if net_cost > 0 else 0
        
        return {
            'total_expenses': total_expenses,
            'total_sales': total_sales,
            'net_cost': net_cost,
            'net_cost_per_meter': net_cost_per_meter,
            'gross_cost_per_meter': gross_cost_per_meter,
            'total_value': total_value,
            'value_per_meter': value_per_meter,
            'final_profit': final_profit,
            'total_profit_percentage': total_profit_percentage
        }


class ProfitCalculations:
    """Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø³ÙˆØ¯"""
    
    @staticmethod
    def calculate_profit_percentages(project):
        """Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ø±ØµØ¯Ù‡Ø§ÛŒ Ø³ÙˆØ¯"""
        # Ø³Ø±Ù…Ø§ÛŒÙ‡ Ùˆ Ø³ÙˆØ¯
        transactions = Transaction.objects.filter(project=project)
        
        deposits = transactions.filter(
            transaction_type='principal_deposit'
        ).aggregate(Sum('amount'))['amount__sum'] or 0
        
        withdrawals = transactions.filter(
            transaction_type='principal_withdrawal'
        ).aggregate(Sum('amount'))['amount__sum'] or 0
        
        total_capital = deposits + withdrawals
        
        total_profit = transactions.filter(
            transaction_type='profit'
        ).aggregate(Sum('amount'))['amount__sum'] or 0
        
        # Ø¯Ø±ØµØ¯ Ø³ÙˆØ¯ Ú©Ù„
        total_profit_percentage = (total_profit / total_capital * 100) if total_capital > 0 else 0
        
        # Ø¯ÙˆØ±Ù‡ Ù…ØªÙˆØ³Ø· Ø³Ø§Ø®Øª
        average_period = ProfitCalculations.calculate_average_construction_period(project)
        
        # Ø¯Ø±ØµØ¯Ù‡Ø§ÛŒ Ø²Ù…Ø§Ù†ÛŒ
        annual_profit_percentage = (total_profit_percentage / average_period * 12) if average_period > 0 else 0
        monthly_profit_percentage = annual_profit_percentage / 12
        daily_profit_percentage = monthly_profit_percentage / 30
        
        return {
            'total_capital': total_capital,
            'total_profit': total_profit,
            'total_profit_percentage': total_profit_percentage,
            'average_construction_period': average_period,
            'annual_profit_percentage': annual_profit_percentage,
            'monthly_profit_percentage': monthly_profit_percentage,
            'daily_profit_percentage': daily_profit_percentage
        }
    
    @staticmethod
    def calculate_average_construction_period(project):
        """Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯ÙˆØ±Ù‡ Ù…ØªÙˆØ³Ø· Ø³Ø§Ø®Øª (Ù…Ø§Ù‡)"""
        periods = Period.objects.filter(project=project)
        
        total_weighted = 0
        total_expenses = 0
        
        for period in periods:
            # Ù‡Ø²ÛŒÙ†Ù‡ Ø¯ÙˆØ±Ù‡
            period_expenses = Expense.objects.filter(
                period=period
            ).aggregate(Sum('amount'))['amount__sum'] or 0
            
            # ÙˆØ²Ù† Ø¯ÙˆØ±Ù‡
            weight = period.period_weight if hasattr(period, 'period_weight') else 1
            
            total_weighted += period_expenses * weight
            total_expenses += period_expenses
        
        return total_weighted / total_expenses if total_expenses > 0 else 0
```

---

## ğŸ“˜ Ù†Ø­ÙˆÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡

### Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†

#### 1. ØªÙˆÙ„ÛŒØ¯ ÙØ§ÛŒÙ„ Ø§Ø² API
```bash
curl -X GET "http://localhost:8000/construction/api/v1/Project/export_excel_static/" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  --output report.xlsx
```

#### 2. ØªÙˆÙ„ÛŒØ¯ ÙØ§ÛŒÙ„ Ø§Ø² Management Command
```bash
# ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§ Ù†Ø§Ù… Ù¾ÛŒØ´â€ŒÙØ±Ø¶
python manage.py export_excel

# ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§ Ù†Ø§Ù… Ø¯Ù„Ø®ÙˆØ§Ù‡
python manage.py export_excel --output my_report.xlsx

# ØªÙˆÙ„ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ Ø®Ø§Øµ
python manage.py export_excel --project-id 1

# Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø®ÙˆØ¯Ú©Ø§Ø±
python manage.py export_excel --open
```

#### 3. Ù…Ø´Ø§Ù‡Ø¯Ù‡ ÙØ§ÛŒÙ„
- ÙØ§ÛŒÙ„ Ø¨Ø§ Excel 2016+ Ø¨Ø§Ø² Ø´ÙˆØ¯
- Ø§Ø² LibreOffice Calc Ù‡Ù… Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ø´ÛŒØª `ğŸ“‹ ÙÙ‡Ø±Ø³Øª` Ø±Ø§ Ø§Ø¨ØªØ¯Ø§ Ø¨Ø¨ÛŒÙ†ÛŒØ¯

---

### Ø¨Ø±Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ú¯Ø§Ù†

#### Ø³Ø§Ø®ØªØ§Ø± Ú©Ø¯

```python
class ExcelExportService:
    def __init__(self, project):
        self.project = project
        self.workbook = Workbook()
    
    def generate_excel(self):
        """ØªÙˆÙ„ÛŒØ¯ ÙØ§ÛŒÙ„ Excel"""
        # 1. Ø­Ø°Ù Ø´ÛŒØª Ù¾ÛŒØ´â€ŒÙØ±Ø¶
        if 'Sheet' in self.workbook.sheetnames:
            self.workbook.remove(self.workbook['Sheet'])
        
        # 2. Ø§ÛŒØ¬Ø§Ø¯ ÙÙ‡Ø±Ø³Øª
        TableOfContentsSheet.create(self.workbook, self.project)
        
        # 3. Ø§ÛŒØ¬Ø§Ø¯ Ø´ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡
        ProjectSheet.create(self.workbook, self.project)
        UnitsSheet.create(self.workbook, self.project)
        InvestorSheet.create(self.workbook, self.project)
        # ...
        
        # 4. Ø§ÛŒØ¬Ø§Ø¯ Ø´ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ø§ØªÛŒ
        DashboardSheet.create(self.workbook, self.project)
        ProfitMetricsSheet.create(self.workbook, self.project)
        CostMetricsSheet.create(self.workbook, self.project)
        # ...
        
        return self.workbook
```

#### Ø§ÙØ²ÙˆØ¯Ù† Ø´ÛŒØª Ø¬Ø¯ÛŒØ¯

```python
class NewSheet:
    @staticmethod
    def create(workbook, project):
        ws = workbook.create_sheet("New_Sheet")
        
        # Ù‡Ø¯Ø±Ù‡Ø§
        headers = ['Ø³ØªÙˆÙ† 1', 'Ø³ØªÙˆÙ† 2', 'Ø³ØªÙˆÙ† 3']
        for col, header in enumerate(headers, 1):
            cell = ws.cell(row=1, column=col, value=header)
            ExcelStyleHelper.apply_header_style(cell)
        
        # Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
        data = get_data_from_database(project)
        row = 2
        for item in data:
            ws.cell(row=row, column=1, value=item.field1)
            ws.cell(row=row, column=2, value=item.field2)
            ws.cell(row=row, column=3, value=calculate_field3(item))
            
            # Ø§Ø³ØªØ§ÛŒÙ„
            for col in range(1, 4):
                ExcelStyleHelper.apply_cell_style(ws.cell(row=row, column=col))
            
            row += 1
        
        # ØªÙ†Ø¸ÛŒÙ…Ø§Øª
        ExcelStyleHelper.freeze_header_row(ws)
        ExcelStyleHelper.add_auto_filter(ws)
        ExcelStyleHelper.auto_adjust_column_width(ws)
        
        return ws
```

---

## ğŸ”§ ØªÙˆØ³Ø¹Ù‡ Ùˆ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ

### Ù†Ú©Ø§Øª Ù…Ù‡Ù… Ø¨Ø±Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡

#### 1. Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² select_related Ùˆ prefetch_related
```python
# âŒ Ú©Ù†Ø¯ - N+1 Query
transactions = Transaction.objects.filter(project=project)
for trans in transactions:
    investor_name = trans.investor.first_name  # Query Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡

# âœ… Ø³Ø±ÛŒØ¹ - ÛŒÚ© Query
transactions = Transaction.objects.filter(
    project=project
).select_related('investor', 'period', 'interest_rate')
```

#### 2. Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² aggregate Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ø§Øª
```python
# âŒ Ú©Ù†Ø¯ - Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ø± Python
total = 0
for trans in transactions:
    total += trans.amount

# âœ… Ø³Ø±ÛŒØ¹ - Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³
total = transactions.aggregate(Sum('amount'))['amount__sum'] or 0
```

#### 3. Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ datetime
```python
def normalize_datetime(dt):
    """Ø­Ø°Ù timezone Ø¨Ø±Ø§ÛŒ Excel"""
    if dt and hasattr(dt, 'tzinfo') and dt.tzinfo:
        return dt.replace(tzinfo=None)
    return dt
```

#### 4. ÙØ±Ù…Øªâ€ŒØ¨Ù†Ø¯ÛŒ Ø§Ø¹Ø¯Ø§Ø¯
```python
# ØªØ¨Ø¯ÛŒÙ„ Decimal Ø¨Ù‡ float
value = float(decimal_value) if decimal_value else 0

# ÙØ±Ù…Øª Ø¨Ø§ Ø¬Ø¯Ø§Ú©Ù†Ù†Ø¯Ù‡ Ù‡Ø²Ø§Ø±Ú¯Ø§Ù†
cell.number_format = '#,##0.00'
```

---

### Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø±Ø§ÛŒØ¬

#### Ø§Ù„Ú¯Ùˆ 1: Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø§Ø±Øª Ø¢Ù…Ø§Ø±ÛŒ
```python
def create_stat_card(ws, row, col, title, value, color):
    """Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø§Ø±Øª Ø¢Ù…Ø§Ø±ÛŒ"""
    # Ø¹Ù†ÙˆØ§Ù†
    title_cell = ws.cell(row=row, column=col, value=title)
    title_cell.font = Font(name='Tahoma', size=10, bold=True)
    title_cell.fill = PatternFill(
        start_color=color,
        end_color=color,
        fill_type='solid'
    )
    
    # Ù…Ù‚Ø¯Ø§Ø±
    value_cell = ws.cell(row=row+1, column=col, value=value)
    value_cell.font = Font(name='Tahoma', size=14, bold=True)
    value_cell.number_format = '#,##0.00'
    
    # Ù…Ø±Ø¬ Ø³Ù„ÙˆÙ„â€ŒÙ‡Ø§
    ws.merge_cells(
        start_row=row, start_column=col,
        end_row=row, end_column=col+1
    )
```

#### Ø§Ù„Ú¯Ùˆ 2: Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ Ø¨Ø§ Ø§Ø³ØªØ§ÛŒÙ„
```python
def create_styled_table(ws, headers, data, start_row=1):
    """Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ Ø¨Ø§ Ø§Ø³ØªØ§ÛŒÙ„"""
    # Ù‡Ø¯Ø±Ù‡Ø§
    for col, header in enumerate(headers, 1):
        cell = ws.cell(row=start_row, column=col, value=header)
        ExcelStyleHelper.apply_header_style(cell)
    
    # Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
    for row_idx, row_data in enumerate(data, start_row+1):
        for col_idx, value in enumerate(row_data, 1):
            cell = ws.cell(row=row_idx, column=col_idx, value=value)
            ExcelStyleHelper.apply_cell_style(cell)
    
    # ØªÙ†Ø¸ÛŒÙ…Ø§Øª
    ExcelStyleHelper.freeze_header_row(ws)
    ExcelStyleHelper.add_auto_filter(ws)
    ExcelStyleHelper.auto_adjust_column_width(ws)
```

#### Ø§Ù„Ú¯Ùˆ 3: Ù…Ø­Ø§Ø³Ø¨Ù‡ Ùˆ Ù†Ù…Ø§ÛŒØ´ Ù†Ø³Ø¨Øª
```python
def calculate_and_display_ratio(ws, row, label, numerator, denominator):
    """Ù…Ø­Ø§Ø³Ø¨Ù‡ Ùˆ Ù†Ù…Ø§ÛŒØ´ Ù†Ø³Ø¨Øª"""
    ws.cell(row=row, column=1, value=label)
    
    ratio = (numerator / denominator * 100) if denominator > 0 else 0
    
    cell = ws.cell(row=row, column=2, value=ratio)
    cell.number_format = '0.00%'
    
    # Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ù‚Ø¯Ø§Ø±
    if ratio > 100:
        cell.font = Font(color=ProjectColors.PROFIT)
    elif ratio < 100:
        cell.font = Font(color=ProjectColors.EXPENSE)
```

---

### Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯

#### 1. Cache Ú©Ø±Ø¯Ù† Ù…Ø­Ø§Ø³Ø¨Ø§Øª
```python
from django.core.cache import cache

def get_project_statistics(project):
    cache_key = f'project_stats_{project.id}'
    stats = cache.get(cache_key)
    
    if not stats:
        stats = ProjectCalculations.calculate_project_statistics(project)
        cache.set(cache_key, stats, 3600)  # 1 Ø³Ø§Ø¹Øª
    
    return stats
```

#### 2. Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² bulk operations
```python
# Ø¨Ø±Ø§ÛŒ ØªØ¹Ø¯Ø§Ø¯ Ø²ÛŒØ§Ø¯ Ø³Ù„ÙˆÙ„â€ŒÙ‡Ø§
cells = []
for row in range(1, 1000):
    for col in range(1, 10):
        cell = ws.cell(row=row, column=col, value=f'R{row}C{col}')
        cells.append(cell)

# Ø§Ø¹Ù…Ø§Ù„ Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ù‡ ØµÙˆØ±Øª bulk
for cell in cells:
    ExcelStyleHelper.apply_cell_style(cell)
```

#### 3. Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
```python
# ÙÙ‚Ø· ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²
transactions = Transaction.objects.filter(
    project=project
).only('id', 'amount', 'transaction_type', 'date_gregorian')
```

---

## âš ï¸ Ù…Ø´Ú©Ù„Ø§Øª Ø±Ø§ÛŒØ¬ Ùˆ Ø±Ø§Ù‡â€ŒØ­Ù„

### Ù…Ø´Ú©Ù„ 1: Ø®Ø·Ø§ÛŒ Timezone
**Ø¹Ù„Øª**: Excel Ø§Ø² timezone Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯

**Ø±Ø§Ù‡â€ŒØ­Ù„**:
```python
def normalize_datetime(dt):
    if dt and hasattr(dt, 'tzinfo') and dt.tzinfo:
        return dt.replace(tzinfo=None)
    return dt

# Ø§Ø³ØªÙØ§Ø¯Ù‡
cell.value = normalize_datetime(transaction.created_at)
```

### Ù…Ø´Ú©Ù„ 2: ÙÙˆÙ†Øª ÙØ§Ø±Ø³ÛŒ
**Ø¹Ù„Øª**: ÙÙˆÙ†Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø§Ø² ÙØ§Ø±Ø³ÛŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯

**Ø±Ø§Ù‡â€ŒØ­Ù„**:
```python
# Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Tahoma ÛŒØ§ Vazir
font = Font(name='Tahoma', size=10)
```

### Ù…Ø´Ú©Ù„ 3: Ø¹Ø±Ø¶ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§
**Ø¹Ù„Øª**: Ø¹Ø±Ø¶ Ø®ÛŒÙ„ÛŒ Ú©ÙˆÚ†Ú© ÛŒØ§ Ø¨Ø²Ø±Ú¯

**Ø±Ø§Ù‡â€ŒØ­Ù„**:
```python
def auto_adjust_column_width(ws):
    for column in ws.columns:
        max_length = 0
        column_letter = column[0].column_letter
        
        for cell in column:
            if cell.value:
                max_length = max(max_length, len(str(cell.value)))
        
        # Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø¹Ø±Ø¶
        adjusted_width = min(max_length + 2, 50)
        ws.column_dimensions[column_letter].width = adjusted_width
```

### Ù…Ø´Ú©Ù„ 4: Ø­Ø¬Ù… ÙØ§ÛŒÙ„ Ø²ÛŒØ§Ø¯
**Ø¹Ù„Øª**: ØªØ¹Ø¯Ø§Ø¯ Ø²ÛŒØ§Ø¯ Ø¯Ø§Ø¯Ù‡ ÛŒØ§ Ø§Ø³ØªØ§ÛŒÙ„

**Ø±Ø§Ù‡â€ŒØ­Ù„**:
```python
# Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
transactions = Transaction.objects.filter(
    project=project,
    date_gregorian__gte=start_date
)[:1000]

# Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ø´ØªØ±Ú©
shared_font = Font(name='Tahoma', size=10)
for cell in cells:
    cell.font = shared_font
```

### Ù…Ø´Ú©Ù„ 5: Ø®Ø·Ø§ÛŒ Memory
**Ø¹Ù„Øª**: ØªØ¹Ø¯Ø§Ø¯ Ø²ÛŒØ§Ø¯ Ø³Ù„ÙˆÙ„â€ŒÙ‡Ø§

**Ø±Ø§Ù‡â€ŒØ­Ù„**:
```python
# Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² write_only mode
from openpyxl import Workbook

wb = Workbook(write_only=True)
ws = wb.create_sheet('Data')

for row in data:
    ws.append(row)

wb.save('large_file.xlsx')
```

### Ù…Ø´Ú©Ù„ 6: Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ ØªØ§Ø±ÛŒØ® ÙØ§Ø±Ø³ÛŒ
**Ø¹Ù„Øª**: Excel ØªØ§Ø±ÛŒØ® ÙØ§Ø±Ø³ÛŒ Ø±Ø§ Ù†Ù…ÛŒâ€ŒØ´Ù†Ø§Ø³Ø¯

**Ø±Ø§Ù‡â€ŒØ­Ù„**:
```python
# Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ
# Ùˆ Ù†Ù…Ø§ÛŒØ´ ØªØ§Ø±ÛŒØ® ÙØ§Ø±Ø³ÛŒ Ø¯Ø± Ø³ØªÙˆÙ† Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡
ws.cell(row=row, column=1, value=transaction.date_gregorian)  # Ø¨Ø±Ø§ÛŒ sort
ws.cell(row=row, column=2, value=transaction.date_shamsi)     # Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´
```

---

## ğŸ“Š Ø¢Ù…Ø§Ø± Ùˆ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙÙ†ÛŒ

### Ù†Ø³Ø®Ù‡ ÙØ¹Ù„ÛŒ
- **ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯**: Ø´Ù‡Ø±ÛŒÙˆØ± Ù…Ø§Ù‡ 1403
- **Ù†Ø³Ø®Ù‡**: 1.0.0
- **ØªØ¹Ø¯Ø§Ø¯ Ø´ÛŒØªâ€ŒÙ‡Ø§**: 15 Ø´ÛŒØª
- **Ø­Ø¬Ù… ÙØ§ÛŒÙ„**: ~80-100 KB
- **Ø²Ù…Ø§Ù† ØªÙˆÙ„ÛŒØ¯**: 2-5 Ø«Ø§Ù†ÛŒÙ‡

### Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ
- âœ… Microsoft Excel 2010+
- âœ… Microsoft Excel 365
- âœ… LibreOffice Calc 5.0+
- âœ… Google Sheets
- âœ… WPS Office

### Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§
- Ø­Ø¯Ø§Ú©Ø«Ø± 10,000 ØªØ±Ø§Ú©Ù†Ø´
- Ø­Ø¯Ø§Ú©Ø«Ø± 200 Ø¯ÙˆØ±Ù‡
- Ø­Ø¯Ø§Ú©Ø«Ø± 500 Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±
- Ø­Ø¯Ø§Ú©Ø«Ø± 1,000 ÙˆØ§Ø­Ø¯

---

## ğŸš€ ØªÙˆØ³Ø¹Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡

### ÙØ§Ø² 1 (ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡) âœ…
- [x] Ø´ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡
- [x] Ø´ÛŒØª Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
- [x] Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù…Ø§Ù„ÛŒ
- [x] Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø³ÙˆØ¯
- [x] Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù‡Ø²ÛŒÙ†Ù‡
- [x] ØªØ­Ù„ÛŒÙ„ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±Ø§Ù†
- [x] Ø®Ù„Ø§ØµÙ‡ Ø¯ÙˆØ±Ù‡â€ŒØ§ÛŒ
- [x] Ø®Ù„Ø§ØµÙ‡ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§

### ÙØ§Ø² 2 (ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡) âœ…
- [x] Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯
- [x] Freeze header rows
- [x] Auto-filter
- [x] ÙÙ‡Ø±Ø³Øª Ø¨Ø§ Ù‡Ø§ÛŒÙ¾Ø±Ù„ÛŒÙ†Ú©
- [x] Auto-adjust column width
- [x] ÙØ±Ù…Øªâ€ŒØ¨Ù†Ø¯ÛŒ Ø§Ø¹Ø¯Ø§Ø¯

### Ø¨Ù‡Ø¨ÙˆØ¯Ù‡Ø§ÛŒ Ø¢ÛŒÙ†Ø¯Ù‡ (Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ)
- [ ] Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§
- [ ] Conditional Formatting
- [ ] Data Validation
- [ ] Ù…Ø­Ø§ÙØ¸Øª Ø§Ø² Ø´ÛŒØªâ€ŒÙ‡Ø§
- [ ] Ù‚Ø§Ù„Ø¨â€ŒÙ‡Ø§ÛŒ Ø§Ø² Ù¾ÛŒØ´ ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡
- [ ] ØµØ§Ø¯Ø±Ø§Øª Ø¨Ù‡ PDF

---

## ğŸ“ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ùˆ Ù…Ø³ØªÙ†Ø¯Ø§Øª

### ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ø±ØªØ¨Ø·
```
construction/excel_export.py              # Ú©Ø¯ Ø§ØµÙ„ÛŒ
construction/calculations.py              # Ù…Ø­Ø§Ø³Ø¨Ø§Øª
construction/api.py                       # API Endpoints
docs/API_REFERENCE.md                     # Ù…Ø³ØªÙ†Ø¯Ø§Øª API
STATIC_EXCEL_DOCUMENTATION.md             # Ø§ÛŒÙ† ÙØ§ÛŒÙ„
```

### Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ù…ÙÛŒØ¯
- [openpyxl Documentation](https://openpyxl.readthedocs.io/)
- [Excel File Format](https://docs.microsoft.com/en-us/office/open-xml/working-with-spreadsheets)
- [Django ORM Optimization](https://docs.djangoproject.com/en/4.2/topics/db/optimization/)

---

## ğŸ“ ÛŒØ§Ø¯Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ù…

### Ù†Ú©ØªÙ‡ 1: Ø¯Ùˆ Ù†ÙˆØ¹ Excel
```
Static Excel:
- Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¯Ø± Ø³Ø±ÙˆØ±
- Ù†ØªØ§ÛŒØ¬ Ø«Ø§Ø¨Øª
- Ù…Ù†Ø§Ø³Ø¨ Ú¯Ø²Ø§Ø±Ø´â€ŒÚ¯ÛŒØ±ÛŒ

Dynamic Excel:
- Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¯Ø± Excel
- ÙØ±Ù…ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¯Ù‡
- Ù…Ù†Ø§Ø³Ø¨ ØªØ­Ù„ÛŒÙ„
```

### Ù†Ú©ØªÙ‡ 2: Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯ÙˆØ±Ù‡ Ù…ØªÙˆØ³Ø·
```python
# Ø¯ÙˆØ±Ù‡ Ù…ØªÙˆØ³Ø· Ø³Ø§Ø®Øª (Ù…Ø§Ù‡)
average_period = Î£(Ù‡Ø²ÛŒÙ†Ù‡_Ø¯ÙˆØ±Ù‡ Ã— ÙˆØ²Ù†_Ø¯ÙˆØ±Ù‡) / Î£(Ú©Ù„_Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§)

# Ù…Ø«Ø§Ù„:
# Ø¯ÙˆØ±Ù‡ 1: Ù‡Ø²ÛŒÙ†Ù‡=1000, ÙˆØ²Ù†=5 â†’ 1000Ã—5=5000
# Ø¯ÙˆØ±Ù‡ 2: Ù‡Ø²ÛŒÙ†Ù‡=2000, ÙˆØ²Ù†=3 â†’ 2000Ã—3=6000
# Ø¯ÙˆØ±Ù‡ 3: Ù‡Ø²ÛŒÙ†Ù‡=1500, ÙˆØ²Ù†=2 â†’ 1500Ã—2=3000
# 
# Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† = (5000+6000+3000) / (1000+2000+1500)
#          = 14000 / 4500
#          = 3.11 Ù…Ø§Ù‡
```

### Ù†Ú©ØªÙ‡ 3: Ø´Ø§Ø®Øµ Ù†ÙØ¹
```
Ø´Ø§Ø®Øµ Ù†ÙØ¹ = Ù†Ø³Ø¨Øª Ø³ÙˆØ¯ / Ù†Ø³Ø¨Øª Ø³Ø±Ù…Ø§ÛŒÙ‡

ØªÙØ³ÛŒØ±:
- Ø´Ø§Ø®Øµ > 1: Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¨Ø§Ù„Ø§ØªØ± Ø§Ø² Ù…ØªÙˆØ³Ø· (Ø³Ø¨Ø²)
- Ø´Ø§Ø®Øµ = 1: Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù…ØªÙˆØ³Ø· (Ø²Ø±Ø¯)
- Ø´Ø§Ø®Øµ < 1: Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ± Ø§Ø² Ù…ØªÙˆØ³Ø· (Ù‚Ø±Ù…Ø²)
```

### Ù†Ú©ØªÙ‡ 4: Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯
```
Ø¢Ø¨ÛŒ (#2185d0):    Ø¢ÙˆØ±Ø¯Ù‡ Ùˆ ÙˆØ§Ø±ÛŒØ²ÛŒ
Ù‚Ø±Ù…Ø² (#db2828):   Ø¨Ø±Ø¯Ø§Ø´Øª Ùˆ Ø®Ø±ÙˆØ¬ÛŒ
Ø³Ø¨Ø² (#21ba45):    Ø³ÙˆØ¯ Ùˆ Ø¯Ø±Ø¢Ù…Ø¯
Ø¨Ù†ÙØ´ (#aa26ff):   Ø³Ø±Ù…Ø§ÛŒÙ‡ Ù…ÙˆØ¬ÙˆØ¯
Ù‚Ø±Ù…Ø² ØªÛŒØ±Ù‡ (#dc3545): Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
Ø²Ø±Ø¯ (#ffc107):    ÙØ±ÙˆØ´/Ù…Ø±Ø¬ÙˆØ¹ÛŒ
Ø®Ø§Ú©Ø³ØªØ±ÛŒ (#6c757d): Ù…Ø§Ù†Ø¯Ù‡ ØµÙ†Ø¯ÙˆÙ‚
Ø·Ù„Ø§ÛŒÛŒ (#ffd700):  Ø´Ø§Ø®Øµ Ù†ÙØ¹
```

---

## ğŸ“ Ø¢Ù…ÙˆØ²Ø´ Ú¯Ø§Ù… Ø¨Ù‡ Ú¯Ø§Ù…

### Ø³Ù†Ø§Ø±ÛŒÙˆ 1: Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø³ØªÙˆÙ† Ø¬Ø¯ÛŒØ¯

**Ù‡Ø¯Ù**: Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø³ØªÙˆÙ† "ÙˆØ¶Ø¹ÛŒØª" Ø¨Ù‡ Ø´ÛŒØª Transactions

**Ú¯Ø§Ù… 1**: ØªØºÛŒÛŒØ± Ù‡Ø¯Ø±Ù‡Ø§
```python
headers = [
    'ID', 'Ø´Ù†Ø§Ø³Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡', 'Ø´Ù†Ø§Ø³Ù‡ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±',
    'Ù†Ø§Ù… Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±', 'Ø´Ù†Ø§Ø³Ù‡ Ø¯ÙˆØ±Ù‡', 'Ø¹Ù†ÙˆØ§Ù† Ø¯ÙˆØ±Ù‡',
    'ØªØ§Ø±ÛŒØ® (Ø´Ù…Ø³ÛŒ)', 'ØªØ§Ø±ÛŒØ® (Ù…ÛŒÙ„Ø§Ø¯ÛŒ)', 'Ù…Ø¨Ù„Øº',
    'Ù†ÙˆØ¹ ØªØ±Ø§Ú©Ù†Ø´', 'ØªÙˆØ¶ÛŒØ­Ø§Øª', 'Ø±ÙˆØ² Ù…Ø§Ù†Ø¯Ù‡',
    'Ø±ÙˆØ² Ø§Ø² Ø´Ø±ÙˆØ¹', 'Ø´Ù†Ø§Ø³Ù‡ Ù†Ø±Ø® Ø³ÙˆØ¯', 'ØªÙˆÙ„ÛŒØ¯ Ø³ÛŒØ³ØªÙ…ÛŒ',
    'Ø´Ù†Ø§Ø³Ù‡ ØªØ±Ø§Ú©Ù†Ø´ Ø§ØµÙ„ÛŒ', 'ÙˆØ¶Ø¹ÛŒØª',  # Ø¬Ø¯ÛŒØ¯
    'ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯'
]
```

**Ú¯Ø§Ù… 2**: Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¯Ø§Ø¯Ù‡
```python
data = [
    trans.id,
    trans.project.id,
    # ...
    'ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡' if trans.is_approved else 'Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±',  # Ø¬Ø¯ÛŒØ¯
    trans.created_at
]
```

**Ú¯Ø§Ù… 3**: ØªØ³Øª
```bash
python manage.py export_excel --output test.xlsx
```

---

### Ø³Ù†Ø§Ø±ÛŒÙˆ 2: Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø´ÛŒØª ØªØ­Ù„ÛŒÙ„ÛŒ Ø¬Ø¯ÛŒØ¯

**Ù‡Ø¯Ù**: Ø´ÛŒØª ØªØ­Ù„ÛŒÙ„ ÙˆØ§Ø­Ø¯Ù‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…ØªØ±Ø§Ú˜

```python
class UnitAnalysisSheet:
    @staticmethod
    def create(workbook, project):
        ws = workbook.create_sheet("Unit_Analysis")
        
        # Ù‡Ø¯Ø±Ù‡Ø§
        headers = [
            'Ù†Ø§Ù… ÙˆØ§Ø­Ø¯', 'Ù…ØªØ±Ø§Ú˜', 'Ù‚ÛŒÙ…Øª Ù‡Ø± Ù…ØªØ±',
            'Ù‚ÛŒÙ…Øª Ù†Ù‡Ø§ÛŒÛŒ', 'Ø¯Ø±ØµØ¯ Ø§Ø² Ú©Ù„ Ù…ØªØ±Ø§Ú˜',
            'Ø¯Ø±ØµØ¯ Ø§Ø² Ú©Ù„ Ø§Ø±Ø²Ø´'
        ]
        
        for col, header in enumerate(headers, 1):
            cell = ws.cell(row=1, column=col, value=header)
            ExcelStyleHelper.apply_header_style(cell)
        
        # Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ú©Ù„ÛŒ
        units = models.Unit.objects.filter(project=project)
        total_area = units.aggregate(Sum('area'))['area__sum'] or 0
        total_value = units.aggregate(
            total=Sum(F('area') * F('price_per_meter'))
        )['total'] or 0
        
        # Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
        row = 2
        for unit in units:
            final_price = unit.area * unit.price_per_meter
            area_percentage = (unit.area / total_area * 100) if total_area > 0 else 0
            value_percentage = (final_price / total_value * 100) if total_value > 0 else 0
            
            data = [
                unit.name,
                float(unit.area),
                float(unit.price_per_meter),
                float(final_price),
                area_percentage,
                value_percentage
            ]
            
            for col, value in enumerate(data, 1):
                cell = ws.cell(row=row, column=col, value=value)
                ExcelStyleHelper.apply_cell_style(cell)
                
                # ÙØ±Ù…Øª Ø¹Ø¯Ø¯ÛŒ
                if col in [2, 3, 4]:
                    cell.number_format = '#,##0.00'
                elif col in [5, 6]:
                    cell.number_format = '0.00%'
            
            row += 1
        
        # ØªÙ†Ø¸ÛŒÙ…Ø§Øª
        ExcelStyleHelper.freeze_header_row(ws)
        ExcelStyleHelper.add_auto_filter(ws)
        ExcelStyleHelper.auto_adjust_column_width(ws)
        
        return ws
```

**Ø§Ø¶Ø§ÙÙ‡ Ø¨Ù‡ Ø³Ø±ÙˆÛŒØ³**:
```python
def generate_excel(self):
    # ...
    UnitAnalysisSheet.create(self.workbook, self.project)
    # ...
```

---

## ğŸ” Ø¯ÛŒØ¨Ø§Ú¯ Ùˆ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ

### Ø±ÙˆØ´ 1: Ù„Ø§Ú¯â€ŒÚ¯Ø°Ø§Ø±ÛŒ
```python
import logging

logger = logging.getLogger(__name__)

def create_sheet(workbook, project):
    logger.info(f'Creating sheet for project {project.id}')
    
    try:
        # Ú©Ø¯ Ø´ÛŒØª
        pass
    except Exception as e:
        logger.error(f'Error creating sheet: {str(e)}')
        raise
```

### Ø±ÙˆØ´ 2: Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
```python
# Ù‚Ø¨Ù„ Ø§Ø² Ù†ÙˆØ´ØªÙ† Ø¯Ø± Excel
print(f'Total transactions: {transactions.count()}')
print(f'Total deposits: {deposits}')
print(f'Total withdrawals: {withdrawals}')
```

### Ø±ÙˆØ´ 3: ØªØ³Øª ÙˆØ§Ø­Ø¯
```python
from django.test import TestCase

class ExcelExportTest(TestCase):
    def test_dashboard_sheet(self):
        project = Project.objects.create(name='Test')
        service = ExcelExportService(project)
        wb = service.generate_excel()
        
        self.assertIn('Dashboard', wb.sheetnames)
        ws = wb['Dashboard']
        self.assertIsNotNone(ws['A1'].value)
```

---

## âœ… Ú†Ú©â€ŒÙ„ÛŒØ³Øª ØªÙˆØ³Ø¹Ù‡

Ù‚Ø¨Ù„ Ø§Ø² Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¬Ø¯ÛŒØ¯:

- [ ] Ø¢ÛŒØ§ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¯Ø± Ø³Ø±ÙˆØ± Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŸ
- [ ] Ø¢ÛŒØ§ Ø§Ø² select_related Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡ØŸ
- [ ] Ø¢ÛŒØ§ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø§Ø¹Ù…Ø§Ù„ Ø´Ø¯Ù‡ØŸ
- [ ] Ø¢ÛŒØ§ Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ Ø±Ø¹Ø§ÛŒØª Ø´Ø¯Ù‡ØŸ
- [ ] Ø¢ÛŒØ§ Freeze Ùˆ Auto-filter Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡ØŸ
- [ ] Ø¢ÛŒØ§ Ø¹Ø±Ø¶ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯Ù‡ØŸ
- [ ] Ø¢ÛŒØ§ ÙØ±Ù…Øª Ø§Ø¹Ø¯Ø§Ø¯ ØµØ­ÛŒØ­ Ø§Ø³ØªØŸ
- [ ] Ø¢ÛŒØ§ ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ normalize Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯ØŸ
- [ ] Ø¢ÛŒØ§ Ø¨Ø§ Excel Ùˆ LibreOffice ØªØ³Øª Ø´Ø¯Ù‡ØŸ
- [ ] Ø¢ÛŒØ§ Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø¨Ù‡â€ŒØ±ÙˆØ² Ø´Ø¯Ù‡ØŸ

---

**ØªØ§Ø±ÛŒØ® Ø¢Ø®Ø±ÛŒÙ† Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ**: Ø¯ÛŒ Ù…Ø§Ù‡ 1403  
**Ù†Ø³Ø®Ù‡ Ù…Ø³ØªÙ†Ø¯**: 1.0.0  
**ÙˆØ¶Ø¹ÛŒØª**: ÙØ¹Ø§Ù„ Ùˆ Ù¾Ø§ÛŒØ¯Ø§Ø±

---

**Ù†Ú©ØªÙ‡ Ù¾Ø§ÛŒØ§Ù†ÛŒ**: Ø§ÛŒÙ† Ù…Ø³ØªÙ†Ø¯ Ø¨Ø§ÛŒØ¯ Ø¨Ø§ Ù‡Ø± ØªØºÛŒÛŒØ± Ø¯Ø± Ú©Ø¯ØŒ Ø¨Ù‡â€ŒØ±ÙˆØ² Ø´ÙˆØ¯. ğŸ“

