# ๐ Django Management Commands

ุงู ูพูุดู ุดุงูู ุฏุณุชูุฑุงุช ุณูุงุฑุด Django ุจุฑุง ูุฏุฑุช ูพุฑูฺู ุงุณุช.

## ๐ ุฏุณุชูุฑ `export_excel`

ุชููุฏ ูุงู Excel ุฌุงูุน ุดุงูู ุชูุงู ุงุทูุงุนุงุช ู ูุญุงุณุจุงุช ูุงู ูพุฑูฺู ุจู ุฏู ุตูุฑุช **Static** ู **Dynamic**.

### ๐ ุงุณุชูุงุฏู ุณุฑุน

```bash
# ุชููุฏ ูุงู Static (ูพุดโูุฑุถ)
python manage.py export_excel

# ุชููุฏ ูุงู Dynamic ุจุง ูุฑูููโูุง ูุญุงุณุจุงุช
python manage.py export_excel --dynamic

# ุชููุฏ Dynamic ุจุง ูุงู ุฏูุฎูุงู ู ุจุงุฒ ฺฉุฑุฏู ุฎูุฏฺฉุงุฑ
python manage.py export_excel --dynamic --output my_report.xlsx --open
```

### ๐ ฺฏุฒููโูุง ฺฉุงูู

| ฺฏุฒูู | ูุฎูู | ุชูุถุญ | ูุซุงู |
|--------|------|-------|------|
| `--output` | `-o` | ูุณุฑ ู ูุงู ูุงู ุฎุฑูุฌ | `--output report.xlsx` |
| `--project-id` | `-p` | ุดูุงุณู ูพุฑูฺู ุฎุงุต | `--project-id 2` |
| `--dynamic` | `-d` | ุชููุฏ ูุงู Dynamic ุจุง ูุฑููู | `--dynamic` |
| `--open` | - | ุจุงุฒ ฺฉุฑุฏู ุฎูุฏฺฉุงุฑ ูุงู | `--open` |
| `--force` | `-f` | ุจุงุฒููุณ ูุงู ููุฌูุฏ | `--force` |
| `--help` | `-h` | ููุงุด ุฑุงูููุง | `--help` |

### ๐ ุชูุงูุช Static ู Dynamic

#### ๐ ูุงู Static (ูพุดโูุฑุถ)

**ููุงุณุจ ุจุฑุง**: ุขุฑุดูุ ุงุฑุณุงู ุจู ุฏฺฏุฑุงูุ ฺฏุฒุงุฑุดโฺฏุฑ ุซุงุจุช

**ูฺฺฏโูุง**:
- โ **ููุงุฏุฑ ุซุงุจุช**: ุชูุงู ูุญุงุณุจุงุช ุฏุฑ ุณุฑูุฑ ุงูุฌุงู ูโุดูุฏ ู ูุชุงุฌ ููุง ุฐุฎุฑู ูโุดูุฏ
- โ **ุณุฑุนุช ุจุงูุง**: ุจุงุฒ ุดุฏู ูุงู ุจุณุงุฑ ุณุฑุน ุงุณุช
- โ **ุณุงุฒฺฏุงุฑ ฺฉุงูู**: ุฑู ุชูุงู ูุณุฎูโูุง Excel ฺฉุงุฑ ูโฺฉูุฏ
- โ **ุญุฌู ฺฉูุชุฑ**: ูุงู ฺฉูฺฺฉโุชุฑ ู ุณุจฺฉโุชุฑ
- โ **ุนุฏู ูุงุฒ ุจู ุชุฎุตุต**: ูุฑ ฺฉุณ ูโุชูุงูุฏ ุงุณุชูุงุฏู ฺฉูุฏ
- โ๏ธ **ุบุฑูุงุจู ุชุบุฑ**: ุจุง ุชุบุฑ ุฏุงุฏูโูุงุ ูุญุงุณุจุงุช ุจูโุฑูุฒ ููโุดูุฏ

**ุดุชโูุง** (15 ุดุช):
- 9 ุดุช ุฏุงุฏู ูพุงู + 6 ุดุช ูุญุงุณุจุงุช ุจุง ููุงุฏุฑ ุซุงุจุช

#### โก ูุงู Dynamic (ูพุดุฑูุชู)

**ููุงุณุจ ุจุฑุง**: ุชุญูู ุชุนุงููุ ุจุฑุฑุณ ุณูุงุฑููุงุ ฺฉุงุฑ ุชู

**ูฺฺฏโูุง**:
- ๐ฅ **ูุฑูููโูุง ุฒูุฏู**: ุชูุงู ูุญุงุณุจุงุช ุจุง ูุฑููู Excel ุงูุฌุงู ูโุดูุฏ
- ๐ฅ **ุจูโุฑูุฒุฑุณุงู ุฎูุฏฺฉุงุฑ**: ุจุง ุชุบุฑ ุฏุงุฏูโูุงุ ุชูุงู ูุญุงุณุจุงุช ุขูพุฏุช ูโุดูุฏ
- ๐ฅ **Named Ranges**: ุฏุณุชุฑุณ ุขุณุงู ุจู ุฏุงุฏูโูุง ุจุง ูุงู
- ๐ฅ **ูุงุจู ุชุบุฑ**: ูโุชูุงูุฏ ุฏุงุฏูโูุง ุฑุง ุชุบุฑ ุฏูุฏ ู ูุชุงุฌ ุฑุง ุจุจูุฏ
- ๐ฅ **ุดูุงูุช ฺฉุงูู**: ุชูุงู ูุฑูููโูุง ูุงุจู ูุดุงูุฏู ู ุจุฑุฑุณ ูุณุชูุฏ
- ๐ฅ **ุดุช ุฑุงูููุง**: ุดุงูู ููุฑุณุช ู ุฑุงูููุง ูุฑูููโูุง
- โ๏ธ **ูุงุฒ ุจู Excel ูู**: ููฺฉู ุงุณุช ุฑู ูุณุฎูโูุง ูุฏู ฺฉูุฏ ุจุงุดุฏ
- โ๏ธ **ุญุฌู ุจุดุชุฑ**: ูุงู ุจุฒุฑฺฏโุชุฑ ุงุณุช

**ุดุชโูุง** (17 ุดุช):
- ๐ ููุฑุณุช (Table of Contents)
- ๐ ุฑุงูููุง ูุฑูููโูุง (Formula Guide)
- 9 ุดุช ุฏุงุฏู ูพุงู
- 6 ุดุช ูุญุงุณุจุงุช ุจุง ูุฑูููโูุง ุฒูุฏู

### ๐ ููุงุณู ุฌุงูุน

| ูฺฺฏ | Static | Dynamic |
|-------|--------|---------|
| **ูุญุงุณุจุงุช** | ุฏุฑ ุณุฑูุฑ | ุฏุฑ Excel ุจุง ูุฑููู |
| **ุณุฑุนุช ุจุงุฒ ุดุฏู** | โก ุฎู ุณุฑุน | ๐ ฺฉูุฏุชุฑ (ุจุณุชู ุจู ุญุฌู) |
| **ูุงุจูุช ุชุบุฑ** | โ ุซุงุจุช | โ ุชุนุงูู |
| **ุดูุงูุช** | ๐ ูุชุงุฌ ููุง | ๐ ูุฑูููโูุง ูุงุจู ูุดุงูุฏู |
| **ุณุงุฒฺฏุงุฑ** | โ ููู ูุณุฎูโูุง | โ๏ธ Excel 2016+ |
| **ุญุฌู ูุงู** | ๐ ฺฉูฺฺฉ | ๐ฆ ุจุฒุฑฺฏโุชุฑ |
| **ููุงุณุจ ุจุฑุง** | ๐ ุขุฑุดูุ ฺฏุฒุงุฑุด | ๐ฌ ุชุญููุ ุจุฑุฑุณ |
| **Named Ranges** | โ ูุฏุงุฑุฏ | โ ุฏุงุฑุฏ |
| **ุฑุงูููุง** | โ ูุฏุงุฑุฏ | โ ุฏุงุฑุฏ |
| **ุชุนุฏุงุฏ ุดุช** | 15 ุดุช | 17 ุดุช |

### ๐ ุณุงุฎุชุงุฑ ูุงู Excel

#### ๐ ุณุงุฎุชุงุฑ Static (15 ุดุช)

**ุดุชโูุง ุฏุงุฏู ูพุงู** (9 ุดุช):
1. **Project** - ุงุทูุงุนุงุช ฺฉุงูู ูพุฑูฺู ูุนุงู
2. **Units** - ูุณุช ฺฉุงูู ูุงุญุฏูุง ุจุง ูุชุฑุงฺ ู ููุช
3. **Investors** - ููู ุณุฑูุงูโฺฏุฐุงุฑุงู
4. **Periods** - ุฏูุฑูโูุง ุฒูุงู ูพุฑูฺู
5. **InterestRates** - ูุฑุฎโูุง ุณูุฏ
6. **Transactions** - ุชูุงู ุชุฑุงฺฉูุดโูุง
7. **Expenses** - ูุฒููโูุง ูพุฑูฺู
8. **Sales** - ูุฑูุด ู ูุฑุฌูุนโูุง
9. **UserProfiles** - ูพุฑููุงู ฺฉุงุฑุจุฑุงู

**ุดุชโูุง ูุญุงุณุจุงุช** (6 ุดุช):
1. **Dashboard** - ุฎูุงุตู ฺฉู ูพุฑูฺู (ููุงุฏุฑ ุซุงุจุช)
2. **Profit_Metrics** - ูุญุงุณุจุงุช ุณูุฏ (ููุงุฏุฑ ูุญุงุณุจู ุดุฏู)
3. **Cost_Metrics** - ูุญุงุณุจุงุช ูุฒูู ู ุงุฑุฒุด (ููุงุฏุฑ ูุญุงุณุจู ุดุฏู)
4. **Investor_Analysis** - ุชุญูู ุชูุตู ุณุฑูุงูโฺฏุฐุงุฑุงู (ููุงุฏุฑ ุซุงุจุช)
5. **Period_Summary** - ุฎูุงุตู ุฏูุฑูโุง ุจุง ููุงุฏุฑ ุชุฌูุน (ููุงุฏุฑ ุซุงุจุช)
6. **Transaction_Summary** - ุฎูุงุตู ุชุฑุงฺฉูุดโูุง (ููุงุฏุฑ ุซุงุจุช)

#### โก ุณุงุฎุชุงุฑ Dynamic (17 ุดุช)

**ุดุชโูุง ุฑุงูููุง** (2 ุดุช):
1. **๐ ููุฑุณุช** - Table of Contents ุจุง ููฺฉ ุจู ุชูุงู ุดุชโูุง
2. **๐ ุฑุงูููุง ูุฑูููโูุง** - ุชูุถุญ Named Ranges ู ูุฑูููโูุง

**ุดุชโูุง ุฏุงุฏู ูพุงู** (9 ุดุช) - ูุดุงุจู Static

**ุดุชโูุง ูุญุงุณุจุงุช ุจุง ูุฑููู** (6 ุดุช):
1. **Comprehensive_Metrics** - ุฏุงุดุจูุฑุฏ ุฌุงูุน ุจุง ูุฑูููโูุง Excel
2. **Transaction_Profit_Calculations** - ูุญุงุณุจุงุช ุณูุฏ ุจุง ูุฑููู
3. **PeriodExpenseSummary** - ุฎูุงุตู ูุฒููโูุง ุจุง ูุฑููู
4. **Investor_Analysis_Dynamic** - ุชุญูู ุณุฑูุงูโฺฏุฐุงุฑุงู ุจุง ูุฑููู
5. **Period_Summary_Dynamic** - ุฎูุงุตู ุฏูุฑูโุง ุจุง ูุฑููู
6. **Transaction_Summary_Dynamic** - ุฎูุงุตู ุชุฑุงฺฉูุดโูุง ุจุง ูุฑููู

**ูฺฺฏ ููุญุตุฑ ุจู ูุฑุฏ Dynamic**:
- ๐ **Named Ranges**: ุฏุณุชุฑุณ ุณุฑุน ุจู ุฏุงุฏูโูุง (ูุซู `TotalInvestors`, `ProjectExpenses`)
- ๐งฎ **ูุฑูููโูุง ูพุดุฑูุชู**: SUMIFS, VLOOKUP, INDEX-MATCH
- ๐ **ูุญุงุณุจุงุช ุฎูุฏฺฉุงุฑ**: ุชุบุฑ ูุฑ ุณูููุ ฺฉู ูุงู ุฑุง ุขูพุฏุช ูโฺฉูุฏ
- ๐ **ูุงุจูุช ุชุญูู**: ูโุชูุงูุฏ ุณูุงุฑููุง ูุฎุชูู ุฑุง ุชุณุช ฺฉูุฏ

### ๐ก ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ

#### 1. ฺฏุฒุงุฑุด Static ูุงูุงูู (ุจุฑุง ุขุฑุดู)
```bash
python manage.py export_excel \
  --output "reports/monthly_static_$(date +%Y%m).xlsx"
```

#### 2. ฺฏุฒุงุฑุด Dynamic ุจุฑุง ุชุญูู
```bash
python manage.py export_excel \
  --dynamic \
  --output "analysis/project_dynamic_$(date +%Y%m%d).xlsx" \
  --open
```

#### 3. ฺฏุฒุงุฑุด ูพุฑูฺู ุฎุงุต (Static)
```bash
python manage.py export_excel \
  --project-id 2 \
  --output "project_2_static.xlsx"
```

#### 4. ฺฏุฒุงุฑุด ูพุฑูฺู ุฎุงุต (Dynamic)
```bash
python manage.py export_excel \
  --dynamic \
  --project-id 2 \
  --output "project_2_dynamic.xlsx"
```

#### 5. ฺฏุฒุงุฑุด ุณุฑุน Static ู ุจุงุฒ ฺฉุฑุฏู
```bash
python manage.py export_excel --open
```

#### 6. ฺฏุฒุงุฑุด ุณุฑุน Dynamic ู ุจุงุฒ ฺฉุฑุฏู
```bash
python manage.py export_excel --dynamic --open
```

#### 7. ุจุงุฒููุณ ฺฏุฒุงุฑุด ุฑูุฒุงูู
```bash
python manage.py export_excel \
  --output daily_report.xlsx \
  --force
```

#### 8. ููุงุณู Static ู Dynamic
```bash
# ุงุจุชุฏุง Static ุชููุฏ ฺฉูุฏ
python manage.py export_excel --output compare_static.xlsx

# ุณูพุณ Dynamic ุชููุฏ ฺฉูุฏ
python manage.py export_excel --dynamic --output compare_dynamic.xlsx

# ุญุงูุง ูโุชูุงูุฏ ุฏู ูุงู ุฑุง ููุงุณู ฺฉูุฏ
```

### โจ ูฺฺฏโูุง ูุดุชุฑฺฉ

- โ **ููู ุณุฑูุงูโฺฏุฐุงุฑุงู**: ุดุงูู ููู ุณุฑูุงูโฺฏุฐุงุฑุงู (ูู ููุท ุขูโูุง ฺฉู ูุงุญุฏ ุฏุงุฑูุฏ)
- โ **ูุญุงุณุจุงุช ุฏูู**: Static ุฏุฑ ุณุฑูุฑุ Dynamic ุจุง ูุฑููู Excel
- โ **ูพุดุชุจุงู ูุงุฑุณ**: ูููุช Tahoma ู ุฑุงุณุชโฺู
- โ **ูุฑูุชโุจูุฏ ุงุนุฏุงุฏ**: ุฌุฏุงฺฉููุฏู ูุฒุงุฑฺฏุงู (ฑฒณ,ดตถ,ทธน)
- โ **ุชุงุฑุฎ ุฏูฺฏุงูู**: ุดูุณ (ฑดฐณ/ฐท/ฑน) ู ููุงุฏ
- โ **ุงุณุชุงู ุญุฑููโุง**: ุฑูฺฏโุจูุฏุ Borderุ ู ูุฑูุชโูุง ููุงุณุจ
- โ **ุฏุงุฏูโูุง ฺฉุงูู**: ุชูุงู ุงุทูุงุนุงุช ูพุฑูฺู ุฏุฑ ฺฉ ูุงู

### ๐ฏ ฺู ุฒูุงู ุงุฒ ฺฉุฏุงู ุงุณุชูุงุฏู ฺฉููุ

#### ุงุณุชูุงุฏู ุงุฒ Static ๐
- โ ุขุฑุดู ฺฏุฒุงุฑุดโูุง ูุงูุงูู/ุณุงูุงูู
- โ ุงุฑุณุงู ุจู ูุดุชุฑุงู ุง ุณุฑูุงูโฺฏุฐุงุฑุงู
- โ ฺุงูพ ฺฏุฒุงุฑุดโูุง
- โ ุฒูุงู ฺฉู ุณุฑุนุช ููู ุงุณุช
- โ ุงุณุชูุงุฏู ุฏุฑ ุณุณุชูโูุง ุถุนู
- โ ุงุทููุงู ุงุฒ ุซุจุงุช ุฏุงุฏูโูุง

#### ุงุณุชูุงุฏู ุงุฒ Dynamic โก
- โ ุชุญูู ุชุนุงูู ุฏุงุฏูโูุง
- โ ุจุฑุฑุณ ุณูุงุฑููุง ูุฎุชูู (What-if Analysis)
- โ ฺฉุงุฑ ุชู ุฑู ฺฉ ูุงู
- โ ุขููุฒุด ู ุงุฏฺฏุฑ
- โ ูุดุงูุฏู ูุฑูููโูุง ูุญุงุณุจุงุช
- โ ุจุฑุฑุณ ุฏูู ูุญุงุณุจุงุช
- โ ุชูุณุนู ู ุชุณุช ูุญุงุณุจุงุช ุฌุฏุฏ

### ๐ง ูุงุฒููุฏโูุง

```python
openpyxl>=3.1.0  # ุงุฒ ูุจู ูุตุจ ุดุฏู
```

**ุจุฑุง Dynamic**:
- Microsoft Excel 2016 ุง ุฌุฏุฏุชุฑ (ุชูุตู ูโุดูุฏ)
- ุญุฏุงูู 4GB RAM ุจุฑุง ูุงูโูุง ุจุฒุฑฺฏ
- ูพุฑุฏุงุฒูุฏู ูู ุจุฑุง ูุญุงุณุจุงุช ูพฺุฏู

### ๐ ูฺฉุงุช ููู

#### ูฺฉุงุช ุนููู
1. **ูพุฑูฺู ูุนุงู**: ุงฺฏุฑ `--project-id` ูุดุฎุต ูุดูุฏุ ุงุฒ ูพุฑูฺู ูุนุงู ุงุณุชูุงุฏู ูโุดูุฏ
2. **ูุงู ูุงู ูพุดโูุฑุถ Static**: `project_<ูุงู>_static_<ุชุงุฑุฎ>.xlsx`
3. **ูุงู ูุงู ูพุดโูุฑุถ Dynamic**: `project_<ูุงู>_dynamic_<ุชุงุฑุฎ>.xlsx`
4. **ูุญู ุฐุฎุฑู**: ูพูุดู ูุนู (ุง ูุณุฑ ูุดุฎุต ุดุฏู ุฏุฑ `--output`)
5. **ุจุงุฒููุณ**: ุจุฏูู `--force` ุฑู ูุงู ููุฌูุฏ ุฎุทุง ูโุฏูุฏ

#### ูฺฉุงุช ูฺู Static
- โก ุจุงุฒ ุดุฏู ููุฑุ ุญุช ุจุฑุง ูพุฑูฺูโูุง ุจุฒุฑฺฏ
- ๐พ ุญุฌู ูุงู ฺฉูุชุฑ (ุญุฏูุฏ 50-200 KB)
- ๐ ุฏุงุฏูโูุง ุซุงุจุช ู ุบุฑูุงุจู ุชุบุฑ
- โ ููุงุณุจ ุจุฑุง ุงุณูุงุฏ ุฑุณู

#### ูฺฉุงุช ูฺู Dynamic
- ๐ ุฒูุงู ุจุงุฒ ุดุฏู ุจุดุชุฑ (10-30 ุซุงูู ุจุณุชู ุจู ุญุฌู)
- ๐พ ุญุฌู ูุงู ุจุดุชุฑ (ุญุฏูุฏ 200-500 KB)
- ๐ ุฏุงุฏูโูุง ูุงุจู ุชุบุฑ ู ุชุญูู
- ๐ ูุฑูููโูุง ูุงุจู ูุดุงูุฏู ู ูุฑุงุด
- โ๏ธ Enable Editing ฺฉูุฏ ุชุง ูุญุงุณุจุงุช ุจูโุฑูุฒ ุดููุฏ
- ๐ ููุงุณุจ ุจุฑุง ุชุญูู ู ฺฏุฒุงุฑุดโฺฏุฑ ุฏุงุฎู

### ๐ ุนุจโุงุจ

#### ุฎุทุง: "ูฺ ูพุฑูฺู ูุนุงู ุงูุช ูุดุฏ"
```bash
# ุฑุงูโุญู: ูุดุฎุต ฺฉุฑุฏู ID ูพุฑูฺู
python manage.py export_excel --project-id 1
```

#### ุฎุทุง: "ูุงู ุงุฒ ูุจู ูุฌูุฏ ุฏุงุฑุฏ"
```bash
# ุฑุงูโุญู: ุงุณุชูุงุฏู ุงุฒ --force
python manage.py export_excel --output report.xlsx --force
```

#### ุฎุทุง: "Permission denied"
```bash
# ุฑุงูโุญู: ุจุฑุฑุณ ุฏุณุชุฑุณ ูพูุดู ุง ุชุบุฑ ูุณุฑ
python manage.py export_excel --output ~/Desktop/report.xlsx
```

#### ูุดฺฉู: ูุงู Dynamic ฺฉูุฏ ุจุงุฒ ูโุดูุฏ
```
ุฑุงูโุญูโูุง:
1. ุตุจุฑ ฺฉูุฏ ุชุง Excel ุชูุงู ูุฑูููโูุง ุฑุง ูุญุงุณุจู ฺฉูุฏ (10-30 ุซุงูู)
2. ุงุฒ Excel 2016 ุง ุฌุฏุฏุชุฑ ุงุณุชูุงุฏู ฺฉูุฏ
3. RAM ุณุณุชู ุฑุง ุงูุฒุงุด ุฏูุฏ
4. ุจุฑุง ฺฏุฒุงุฑุดโูุง ุณุฑุน ุงุฒ Static ุงุณุชูุงุฏู ฺฉูุฏ
```

#### ูุดฺฉู: ูุญุงุณุจุงุช Dynamic ุจูโุฑูุฒ ููโุดูุฏ
```
ุฑุงูโุญูโูุง:
1. ุฏุฑ Excel ุฑู "Enable Editing" ฺฉูฺฉ ฺฉูุฏ
2. Ctrl+Alt+F9 ุจุฑุง Recalculate All
3. File > Options > Formulas > Calculation Options = Automatic
```

#### ูุดฺฉู: ูุฑูููโูุง ุจู ุฌุง ูุชุฌู ููุงุด ุฏุงุฏู ูโุดูุฏ
```
ุฑุงูโุญู:
1. Ctrl+` ุจุฑุง ุชุบุฑ ุญุงูุช ููุงุด
2. ุง ุงุฒ ููู Excel: Formulas > Show Formulas
```

#### ูุดฺฉู: ุฎุทุง "#REF!" ุฏุฑ ูุฑูููโูุง Dynamic
```
ุฑุงูโุญู:
1. ูุงู ุฑุง ุจุจูุฏุฏ ู ุฏูุจุงุฑู ุจุงุฒ ฺฉูุฏ
2. ูุงู ุฌุฏุฏ ุชููุฏ ฺฉูุฏ
3. ุงุฒ ูุณุฎู ุจูโุฑูุฒ Excel ุงุณุชูุงุฏู ฺฉูุฏ
```

### ๐ ููุงุณู ุณุฑุน: ฺฉุฏุงู ุฑุง ุงูุชุฎุงุจ ฺฉููุ

| ุณูุงุฑู | ุชูุตู |
|--------|-------|
| ฺฏุฒุงุฑุด ูุงูุงูู ุจุฑุง ูุฏุฑุช | Static โก |
| ุขุฑุดู ูพุงุงู ุณุงู | Static โก |
| ุงุฑุณุงู ุจู ุญุณุงุจุฏุงุฑ | Static โก |
| ฺุงูพ ฺฏุฒุงุฑุด | Static โก |
| ุชุญูู ุนูู ุฏุงุฏูโูุง | Dynamic ๐ฅ |
| ุจุฑุฑุณ ุณูุงุฑููุง ูุฎุชูู | Dynamic ๐ฅ |
| ุขููุฒุด ุจู ููฺฉุงุฑุงู | Dynamic ๐ฅ |
| ุจุฑุฑุณ ูุฑูููโูุง ูุญุงุณุจุงุช | Dynamic ๐ฅ |
| ุงุฑุณุงู ุจู ุณุฑูุงูโฺฏุฐุงุฑุงู | Static โก |
| ฺฉุงุฑ ุชู ุฑู ฺฉ ูุงู | Dynamic ๐ฅ |
| ูุงุฒ ุจู ุณุฑุนุช ุจุงูุง | Static โก |
| ูุงุฒ ุจู ุดูุงูุช ฺฉุงูู | Dynamic ๐ฅ |

### ๐ก ูฺฉุชู ุทูุง

**ุจุฑุง ุจูุชุฑู ูุชุฌู**: 
- ูุฑ ูุงู ฺฉ ูุงู **Static** ุจุฑุง ุขุฑุดู ุชููุฏ ฺฉูุฏ ๐
- ฺฉ ูุงู **Dynamic** ุจุฑุง ุชุญูู ุฑูุฒูุฑู ูฺฏู ุฏุงุฑุฏ โก
- ูุจู ุงุฒ ุงุฑุงุฆู ุจู ูุดุชุฑุ **Static** ุงุณุชูุงุฏู ฺฉูุฏ ๐ฏ

### ๐ ูพุดุชุจุงู

ุจุฑุง ฺฏุฒุงุฑุด ูุดฺฉูุงุช ุง ูพุดููุงุฏุงุชุ ุจู ูุณุชูุฏุงุช ุงุตู ูพุฑูฺู ูุฑุงุฌุนู ฺฉูุฏ:
- ๐ [STATIC_EXCEL_DOCUMENTATION.md](../../docs/STATIC_EXCEL_DOCUMENTATION.md)
- โก [DYNAMIC_EXCEL_DOCUMENTATION.md](../../docs/DYNAMIC_EXCEL_DOCUMENTATION.md)
- ๐ [DYNAMIC_EXCEL_QUICK_REFERENCE.md](../../docs/DYNAMIC_EXCEL_QUICK_REFERENCE.md)

---

**ุชุงุฑุฎ ุงุฌุงุฏ**: 2025-10-10  
**ูุณุฎู**: 1.0  
**ูุถุนุช**: ูุนุงู ู ุขูุงุฏู ุงุณุชูุงุฏู

## ๐ ุฏุณุชูุฑ `convert_rial_to_toman`

ุชุจุฏู ุชูุงู ููุฏูุง ุฑูู ูพุฑูฺู ุงุฒ ุฑุงู ุจู ุชููุงู (ุชูุณู ุจุฑ ฑฐ).

### ๐ ุงุณุชูุงุฏู ุณุฑุน

```bash
# ููุงุด ุชุบุฑุงุช ุจุฏูู ุงุนูุงู
python manage.py convert_rial_to_toman --dry-run

# ุชุจุฏู ุจุง ุจฺฉุงูพ ุฎูุฏฺฉุงุฑ
python manage.py convert_rial_to_toman --backup

# ุชุจุฏู ูุณุชูู (ุงุญุชุงุท!)
python manage.py convert_rial_to_toman
```

### ๐ ฺฏุฒููโูุง ฺฉุงูู

| ฺฏุฒูู | ุชูุถุญ | ูุซุงู |
|--------|-------|------|
| `--dry-run` | ููุงุด ุชุบุฑุงุช ุจุฏูู ุงุนูุงู | `--dry-run` |
| `--backup` | ุงุฌุงุฏ ุจฺฉุงูพ ูุจู ุงุฒ ุชุจุฏู | `--backup` |
| `--help` | ููุงุด ุฑุงูููุง | `--help` |

### ๐ ููุงุฑุฏ ุชุจุฏู ุดุฏู

1. **Units** - ููุช ูุฑ ูุชุฑ ู ููุช ฺฉู
2. **Transactions** - ูุจูุบ ุชุฑุงฺฉูุดโูุง
3. **Expenses** - ูุจูุบ ูุฒููโูุง
4. **Sales** - ูุจูุบ ูุฑูุด ู ูุฑุฌูุน
5. **InterestRates** - ุจุฑุฑุณ ูโุดูุฏ (ูุงุฒ ุจู ุชุจุฏู ูุฏุงุฑุฏ)

### โ๏ธ ูฺฉุงุช ููู

- **ููุดู ุจฺฉุงูพ ุจฺฏุฑุฏ**: ูุจู ุงุฒ ุงุฌุฑุง ุญุชูุงู `--backup` ุงุณุชูุงุฏู ฺฉูุฏ
- **ุงุจุชุฏุง ุชุณุช ฺฉูุฏ**: ุจุง `--dry-run` ุชุบุฑุงุช ุฑุง ุจุจูุฏ
- **ุจุฑฺฏุดุชโูุงูพุฐุฑ**: ุจุฏูู ุจฺฉุงูพ ุงูฺฉุงู ุจุงุฒฺฏุดุช ูุฌูุฏ ูุฏุงุฑุฏ
- **Transaction Safe**: ุฏุฑ ุตูุฑุช ุฎุทุงุ ุชูุงู ุชุบุฑุงุช rollback ูโุดูุฏ

### ๐ก ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ

```bash
# ูุฑุญูู 1: ุจุฑุฑุณ ุชุบุฑุงุช
python manage.py convert_rial_to_toman --dry-run

# ูุฑุญูู 2: ุชุจุฏู ุจุง ุจฺฉุงูพ
python manage.py convert_rial_to_toman --backup
```

---

## ๐ ุฏุณุชูุฑ `check_timezone`

ุจุฑุฑุณ ุชูุธูุงุช timezone ู ููุงุด ุฒูุงู ูุนู ุฏุฑ ูุฑูุชโูุง ูุฎุชูู.

### ๐ ุงุณุชูุงุฏู ุณุฑุน

```bash
# ุจุฑุฑุณ timezone
python manage.py check_timezone
```

### ๐ ุงุทูุงุนุงุช ููุงุด ุฏุงุฏู ุดุฏู

1. **ุชูุธูุงุช Django**: TIME_ZONE, USE_TZ, USE_I18N, USE_L10N
2. **ุฒูุงูโูุง ูุนู**: UTC, ุชูุฑุงู, Django
3. **ูุชุบุฑ ูุญุท**: TZ
4. **ุฒูุงู ูุงุฑุณ**: ูุฑูุช ุดูุณ

### โจ ูฺฺฏโูุง

- โ ููุงุด ุชูุธูุงุช timezone ูพุฑูฺู
- โ ููุงุณู ุฒูุงู UTC ู ุชูุฑุงู
- โ ุจุฑุฑุณ ูุชุบุฑูุง ูุญุท
- โ ุชุณุช ูุฑูุช ูุงุฑุณ

---

## ๐ฅ ุฏุณุชูุฑ `download_online_db`

ุฏุงูููุฏ ุฏุชุงุจุณ ุขููุงู ุงุฒ GitHub ู ุฌุงฺฏุฒู ุจุง ุฏุชุงุจุณ ูุญู.

### ๐ ุงุณุชูุงุฏู ุณุฑุน

```bash
# ุฏุงูููุฏ ุจุง ุชุฃุฏ
python manage.py download_online_db --confirm

# ุฏุงูููุฏ ุจุง ุจฺฉุงูพ ูุญู
python manage.py download_online_db --confirm --backup-local

# ุฏุงูููุฏ ุงุฒ ุดุงุฎู ุฎุงุต
python manage.py download_online_db --confirm --branch chabokan-deployment
```

### ๐ ฺฏุฒููโูุง ฺฉุงูู

| ฺฏุฒูู | ุชูุถุญ | ูุซุงู |
|--------|-------|------|
| `--confirm` | ุชุฃุฏ ุฌุงฺฏุฒู (ุงูุฒุงู) | `--confirm` |
| `--backup-local` | ุจฺฉุงูพ ุฏุชุงุจุณ ูุญู | `--backup-local` |
| `--branch` | ุดุงุฎู Git (ูพุดโูุฑุถ: master) | `--branch master` |

### โ๏ธ ูฺฉุงุช ููู

- **ุชุฃุฏ ุงูุฒุงู**: ุจุฏูู `--confirm` ุงุฌุฑุง ููโุดูุฏ
- **ุจุฑุฑุณ Git**: ุชุบุฑุงุช uncommitted ูุจุงุฏ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ
- **Stash ุฎูุฏฺฉุงุฑ**: ุชุบุฑุงุช ูุญู ูููุชุงู stash ูโุดูุฏ
- **Restore ุฎูุฏฺฉุงุฑ**: ูพุณ ุงุฒ pullุ ุชุบุฑุงุช restore ูโุดูุฏ

### ๐ก ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ

```bash
# ุฏุงูููุฏ ุงูู ุจุง ุจฺฉุงูพ
python manage.py download_online_db --confirm --backup-local

# ุฏุงูููุฏ ุงุฒ ุดุงุฎู ุฎุงุต
python manage.py download_online_db --confirm --branch chabokan-deployment
```

---

## ๐ค ุฏุณุชูุฑ `upload_local_db`

ุขูพููุฏ ุฏุชุงุจุณ ูุญู ุจู GitHub ู ุฌุงฺฏุฒู ุฏุชุงุจุณ ุขููุงู.

### ๐ ุงุณุชูุงุฏู ุณุฑุน

```bash
# ุขูพููุฏ ุจุง ุชุฃุฏ
python manage.py upload_local_db --confirm

# ุขูพููุฏ ุจุง ุจฺฉุงูพ ุขููุงู
python manage.py upload_local_db --confirm --backup-online

# ุขูพููุฏ ุจุง ูพุงู commit ุณูุงุฑุด
python manage.py upload_local_db --confirm --commit-message "Updated investor data"
```

### ๐ ฺฏุฒููโูุง ฺฉุงูู

| ฺฏุฒูู | ุชูุถุญ | ูุซุงู |
|--------|-------|------|
| `--confirm` | ุชุฃุฏ ุฌุงฺฏุฒู (ุงูุฒุงู) | `--confirm` |
| `--backup-online` | ุจฺฉุงูพ ุฏุชุงุจุณ ุขููุงู | `--backup-online` |
| `--commit-message` | ูพุงู commit | `--commit-message "message"` |

### ๐ ูุฑุขูุฏ ุขูพููุฏ

1. ุจุฑุฑุณ ูุฌูุฏ ุฏุชุงุจุณ ูุญู
2. ุงุฌุงุฏ ุจฺฉุงูพ ุงุฒ ุฏุชุงุจุณ ุขููุงู (ุงุฎุชุงุฑ)
3. ฺฉูพ ุฏุชุงุจุณ ูุญู ุจู ุขููุงู
4. ุงุถุงูู ฺฉุฑุฏู ุจู Git
5. Commit ุชุบุฑุงุช
6. Push ุจู GitHub

### โ๏ธ ูฺฉุงุช ููู

- **ุชุฃุฏ ุงูุฒุงู**: ุจุฏูู `--confirm` ุงุฌุฑุง ููโุดูุฏ
- **ุจฺฉุงูพ ุชูุตู ูโุดูุฏ**: ููุดู `--backup-online` ุงุณุชูุงุฏู ฺฉูุฏ
- **Push ุจู master**: ุชุบุฑุงุช ุจู ุดุงุฎู master push ูโุดูุฏ
- **ุจุฑฺฏุดุชโูุงูพุฐุฑ**: ุจุฏูู ุจฺฉุงูพ ุงูฺฉุงู ุจุงุฒฺฏุดุช ูุฌูุฏ ูุฏุงุฑุฏ

### ๐ก ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ

```bash
# ุขูพููุฏ ุงูู ุจุง ุจฺฉุงูพ
python manage.py upload_local_db --confirm --backup-online

# ุขูพููุฏ ุจุง ูพุงู ุชูุถุญ
python manage.py upload_local_db \
  --confirm \
  --backup-online \
  --commit-message "Added new investors and updated transactions"
```

---

## ๐ ุฏุณุชูุฑ `security_check`

ุจุฑุฑุณ ุฌุงูุน ุงููุช ูพุฑูฺู ู ุดูุงุณุง ูุดฺฉูุงุช ุงููุช.

### ๐ ุงุณุชูุงุฏู ุณุฑุน

```bash
# ุจุฑุฑุณ ฺฉุงูู ุงููุช
python manage.py security_check

# ุจุฑุฑุณ ููุน ุฎุงุต
python manage.py security_check --check-type settings

# ุจุฑุฑุณ ู ุฑูุน ูุดฺฉูุงุช
python manage.py security_check --fix-issues
```

### ๐ ฺฏุฒููโูุง ฺฉุงูู

| ฺฏุฒูู | ุชูุถุญ | ูุซุงู |
|--------|-------|------|
| `--check-type` | ููุน ุจุฑุฑุณ | `--check-type all` |
| `--fix-issues` | ุฑูุน ุฎูุฏฺฉุงุฑ ูุดฺฉูุงุช | `--fix-issues` |

### ๐ ุงููุงุน ุจุฑุฑุณ

| ููุน | ุชูุถุญ |
|-----|-------|
| `all` | ุจุฑุฑุณ ฺฉุงูู (ูพุดโูุฑุถ) |
| `settings` | ุชูุธูุงุช ุงููุช Django |
| `data` | ฺฉูพุงุฑฺฺฏ ุฏุงุฏูโูุง |
| `monitoring` | ูุธุงุฑุช ุงููุช |
| `cleanup` | ูพุงฺฉโุณุงุฒ ุฏุงุฏูโูุง ูุฏู |

### ๐ง ููุงุฑุฏ ุจุฑุฑุณ ุดุฏู

#### 1. Settings
- ูุถุนุช DEBUG
- ุชูุธูุงุช ALLOWED_HOSTS
- ุทูู SECRET_KEY
- ุณุงุฑ ุชูุธูุงุช ุงููุช

#### 2. Data Integrity
- ฺฉูพุงุฑฺฺฏ ุฏุงุฏูโูุง
- ุฑูุงุจุท ูุฏูโูุง
- ุฏุงุฏูโูุง ูุงูุต ุง ูุงูุนุชุจุฑ

#### 3. Security Monitoring
- ุฑูุฏุงุฏูุง ุงููุช 24 ุณุงุนุช ฺฏุฐุดุชู
- ุชูุงุดโูุง ูุฑูุฏ ูุงูููู
- IP ูุง ูุดฺฉูฺฉ
- ูุนุงูุชโูุง ุบุฑุนุงุฏ

#### 4. Cleanup
- Session ูุง ูุฏู
- ูุงฺฏโูุง ูููุถ ุดุฏู
- ุขุฑุดู ุฏุงุฏูโูุง ูุฏู

### ๐ก ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ

```bash
# ุจุฑุฑุณ ฺฉุงูู
python manage.py security_check

# ููุท ุจุฑุฑุณ ุชูุธูุงุช
python manage.py security_check --check-type settings

# ุจุฑุฑุณ ู ุฑูุน ูุดฺฉูุงุช ุฏุงุฏู
python manage.py security_check --check-type data --fix-issues

# ูพุงฺฉโุณุงุฒ ุฏุงุฏูโูุง ูุฏู
python manage.py security_check --check-type cleanup
```

### ๐ ุฎุฑูุฌ ููููู

```
๐ ุดุฑูุน ุจุฑุฑุณ ุงููุช ูพุฑูฺู

๐ง ุจุฑุฑุณ ุชูุธูุงุช ุงููุช:
โ DEBUG = False
โ ALLOWED_HOSTS ุชูุธู ุดุฏู
โ SECRET_KEY ุทูู ููุงุณุจ ุฏุงุฑุฏ

๐ ุจุฑุฑุณ ฺฉูพุงุฑฺฺฏ ุฏุงุฏูโูุง:
โ ูฺ ูุดฺฉู ฺฉูพุงุฑฺฺฏ ุงูุช ูุดุฏ

๐๏ธ ุจุฑุฑุณ ูุธุงุฑุช ุงููุช:
๐ ุฑูุฏุงุฏูุง 24 ุณุงุนุช ฺฏุฐุดุชู: 156
๐จ ุฑูุฏุงุฏูุง ุจุญุฑุงู: 0
๐ ุชูุงุดโูุง ูุฑูุฏ ูุงูููู: 2
โ๏ธ IP ูุง ูุดฺฉูฺฉ: 0

๐งน ูพุงฺฉ ฺฉุฑุฏู ุฏุงุฏูโูุง ูุฏู:
๐๏ธ 45 session ูุฏู ุญุฐู ุดุฏ
๐๏ธ 128 ูุงฺฏ ูุฏู ุญุฐู ุดุฏ

โ ุจุฑุฑุณ ุงููุช ุชฺฉูู ุดุฏ
```

---

## ๐ ุฎูุงุตู ุฏุณุชูุฑุงุช

| ุฏุณุชูุฑ | ุชูุถุญ ูุฎุชุตุฑ | ุงุณุชูุงุฏู ุฑุงุฌ |
|-------|-------------|--------------|
| `export_excel` | ุชููุฏ ฺฏุฒุงุฑุด Excel (Static/Dynamic) | Static: `--open`<br>Dynamic: `--dynamic --open` |
| `convert_rial_to_toman` | ุชุจุฏู ูุงุญุฏ ูพูู | `--backup --dry-run` |
| `check_timezone` | ุจุฑุฑุณ timezone | ููุท ุงุฌุฑุง ฺฉูุฏ |
| `download_online_db` | ุฏุงูููุฏ ุฏุชุงุจุณ ุงุฒ GitHub | `--confirm --backup-local` |
| `upload_local_db` | ุขูพููุฏ ุฏุชุงุจุณ ุจู GitHub | `--confirm --backup-online` |
| `security_check` | ุจุฑุฑุณ ุงููุช ุฌุงูุน | `--check-type all` |

### ๐ฏ ุฏุณุชูุฑุงุช ูพุฑฺฉุงุฑุจุฑุฏ

```bash
# ฺฏุฒุงุฑุด Static ุณุฑุน
python manage.py export_excel --open

# ฺฏุฒุงุฑุด Dynamic ุชุญูู
python manage.py export_excel --dynamic --open

# ุชุจุฏู ุฑุงู ุจู ุชููุงู (ุจุง ุงุญุชุงุท!)
python manage.py convert_rial_to_toman --dry-run
python manage.py convert_rial_to_toman --backup

# ููฺฏุงูโุณุงุฒ ุฏุชุงุจุณ
python manage.py download_online_db --confirm --backup-local  # ุฏุงูููุฏ
python manage.py upload_local_db --confirm --backup-online    # ุขูพููุฏ

# ุจุฑุฑุณ ุงููุช
python manage.py security_check
```

## ๐๏ธ ูฺฉุงุช ุนููู

### ูุญุท ูุฌุงุฒ

ููุดู ูุจู ุงุฒ ุงุฌุฑุง ุฏุณุชูุฑุงุชุ ูุญุท ูุฌุงุฒ ุฑุง ูุนุงู ฺฉูุฏ:

```bash
source env/bin/activate
```

ุง ุงุฒ ุงุณฺฉุฑูพุชโูุง ฺฉูฺฉ ุงุณุชูุงุฏู ฺฉูุฏ:

```bash
./run_django.sh [ุฏุณุชูุฑ]
python3 run_django.py [ุฏุณุชูุฑ]
```

### ูุงฺฏโฺฏุฑ

ุชูุงู ุฏุณุชูุฑุงุช ุฎุฑูุฌ ููุฏ ุชููุฏ ูโฺฉููุฏ. ุจุฑุง ุฐุฎุฑู ูุงฺฏ:

```bash
python manage.py [ุฏุณุชูุฑ] > logs/command_$(date +%Y%m%d_%H%M%S).log 2>&1
```

### ุจฺฉุงูพ

ูุจู ุงุฒ ุงุฌุฑุง ุฏุณุชูุฑุงุช ุชุบุฑุฏููุฏู (ูุซู `convert_rial_to_toman` ุง `upload_local_db`)ุ **ุญุชูุงู** ุจฺฉุงูพ ุจฺฏุฑุฏ:

```bash
python manage.py convert_rial_to_toman --backup
python manage.py upload_local_db --confirm --backup-online
```

### ุนุจโุงุจ

ุงฺฏุฑ ุฏุณุชูุฑ ุฎุทุง ุฏุงุฏ:

1. ูุญุท ูุฌุงุฒ ุฑุง ุจุฑุฑุณ ฺฉูุฏ
2. ูุงฺฏ ุฎุทุง ุฑุง ุจุฎูุงูุฏ
3. ุงุฒ `--help` ุจุฑุง ุฑุงูููุง ุฏุณุชูุฑ ุงุณุชูุงุฏู ฺฉูุฏ
4. ุฏุฑ ุตูุฑุช ูุฒูู ุงุฒ `--dry-run` ุงุณุชูุงุฏู ฺฉูุฏ

---

**ุขุฎุฑู ุจูโุฑูุฒุฑุณุงู**: 2025-10-10  
**ูุณุฎู**: 2.1 - ุงูุฒูุฏู ูุณุชูุฏุงุช ฺฉุงูู Static/Dynamic Excel  
**ูุถุนุช**: ูุนุงูุ ฺฉุงูู ู ุจูโุฑูุฒ

