# ๐ Django Management Commands

ุงู ูพูุดู ุดุงูู ุฏุณุชูุฑุงุช ุณูุงุฑุด Django ุจุฑุง ูุฏุฑุช ูพุฑูฺู ุงุณุช.

## ๐ ุฏุณุชูุฑ `export_excel`

ุชููุฏ ูุงู Excel ุฌุงูุน ุดุงูู ุชูุงู ุงุทูุงุนุงุช ู ูุญุงุณุจุงุช ูุงู ูพุฑูฺู.

### ๐ ุงุณุชูุงุฏู ุณุฑุน

```bash
# ุชููุฏ ูุงู ุจุง ูุงู ูพุดโูุฑุถ
python manage.py export_excel

# ุชููุฏ ูุงู ุจุง ูุงู ุฏูุฎูุงู
python manage.py export_excel --output my_report.xlsx

# ุชููุฏ ู ุจุงุฒ ฺฉุฑุฏู ุฎูุฏฺฉุงุฑ
python manage.py export_excel --open
```

### ๐ ฺฏุฒููโูุง ฺฉุงูู

| ฺฏุฒูู | ูุฎูู | ุชูุถุญ | ูุซุงู |
|--------|------|-------|------|
| `--output` | `-o` | ูุณุฑ ู ูุงู ูุงู ุฎุฑูุฌ | `--output report.xlsx` |
| `--project-id` | `-p` | ุดูุงุณู ูพุฑูฺู ุฎุงุต | `--project-id 2` |
| `--open` | - | ุจุงุฒ ฺฉุฑุฏู ุฎูุฏฺฉุงุฑ ูุงู | `--open` |
| `--force` | `-f` | ุจุงุฒููุณ ูุงู ููุฌูุฏ | `--force` |
| `--help` | `-h` | ููุงุด ุฑุงูููุง | `--help` |

### ๐ ุณุงุฎุชุงุฑ ูุงู Excel

ูุงู ุชููุฏ ุดุฏู ุดุงูู **15 ุดุช** ุงุณุช:

#### ๐ ุดุชโูุง ุฏุงุฏู ูพุงู (9 ุดุช)

1. **Project** - ุงุทูุงุนุงุช ฺฉุงูู ูพุฑูฺู ูุนุงู
2. **Units** - ูุณุช ฺฉุงูู ูุงุญุฏูุง ุจุง ูุชุฑุงฺ ู ููุช
3. **Investors** - ููู ุณุฑูุงูโฺฏุฐุงุฑุงู (34 ููุฑ)
4. **Periods** - ุฏูุฑูโูุง ุฒูุงู ูพุฑูฺู
5. **InterestRates** - ูุฑุฎโูุง ุณูุฏ
6. **Transactions** - ุชูุงู ุชุฑุงฺฉูุดโูุง
7. **Expenses** - ูุฒููโูุง ูพุฑูฺู
8. **Sales** - ูุฑูุด ู ูุฑุฌูุนโูุง
9. **UserProfiles** - ูพุฑููุงู ฺฉุงุฑุจุฑุงู

#### ๐ ุดุชโูุง ูุญุงุณุจุงุช (6 ุดุช)

1. **Dashboard** - ุฎูุงุตู ฺฉู ูพุฑูฺู
2. **Profit_Metrics** - ูุญุงุณุจุงุช ุณูุฏ (ฺฉูุ ุณุงูุงููุ ูุงูุงููุ ุฑูุฒุงูู)
3. **Cost_Metrics** - ูุญุงุณุจุงุช ูุฒูู ู ุงุฑุฒุด
4. **Investor_Analysis** - ุชุญูู ุชูุตู ููู ุณุฑูุงูโฺฏุฐุงุฑุงู (34 ููุฑ)
5. **Period_Summary** - ุฎูุงุตู ุฏูุฑูโุง ุจุง ููุงุฏุฑ ุชุฌูุน
6. **Transaction_Summary** - ุฎูุงุตู ุชุฑุงฺฉูุดโูุง

### ๐ก ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ

#### 1. ฺฏุฒุงุฑุด ูุงูุงูู
```bash
python manage.py export_excel \
  --output "reports/monthly_$(date +%Y%m).xlsx"
```

#### 2. ฺฏุฒุงุฑุด ูพุฑูฺู ุฎุงุต
```bash
python manage.py export_excel \
  --project-id 2 \
  --output "project_2_report.xlsx"
```

#### 3. ฺฏุฒุงุฑุด ุณุฑุน ู ุจุงุฒ ฺฉุฑุฏู
```bash
python manage.py export_excel --open
```

#### 4. ุจุงุฒููุณ ฺฏุฒุงุฑุด ุฑูุฒุงูู
```bash
python manage.py export_excel \
  --output daily_report.xlsx \
  --force
```

### โจ ูฺฺฏโูุง

- โ **ููู ุณุฑูุงูโฺฏุฐุงุฑุงู**: ุดุงูู ููู 34 ุณุฑูุงูโฺฏุฐุงุฑ (ูู ููุท ุขูโูุง ฺฉู ูุงุญุฏ ุฏุงุฑูุฏ)
- โ **ูุญุงุณุจุงุช ุฏูู**: ุชูุงู ูุญุงุณุจุงุช ุฏุฑ ุณุฑูุฑ ุงูุฌุงู ูโุดูุฏ
- โ **ูพุดุชุจุงู ูุงุฑุณ**: ูููุช Tahoma ู ุฑุงุณุชโฺู
- โ **ูุฑูุชโุจูุฏ ุงุนุฏุงุฏ**: ุฌุฏุงฺฉููุฏู ูุฒุงุฑฺฏุงู
- โ **ุชุงุฑุฎ ุฏูฺฏุงูู**: ุดูุณ ู ููุงุฏ
- โ **ุงุณุชุงู ุญุฑููโุง**: ุฑูฺฏโุจูุฏ ู ูุฑูุช ููุงุณุจ

### ๐ง ูุงุฒููุฏโูุง

```python
openpyxl>=3.1.0  # ุงุฒ ูุจู ูุตุจ ุดุฏู
```

### ๐ ูฺฉุงุช ููู

1. **ูพุฑูฺู ูุนุงู**: ุงฺฏุฑ `--project-id` ูุดุฎุต ูุดูุฏุ ุงุฒ ูพุฑูฺู ูุนุงู ุงุณุชูุงุฏู ูโุดูุฏ
2. **ูุงู ูุงู ูพุดโูุฑุถ**: `project_<ูุงู_ูพุฑูฺู>_<ุชุงุฑุฎ_ุฒูุงู>.xlsx`
3. **ูุญู ุฐุฎุฑู**: ูพูุดู ูุนู (ุง ูุณุฑ ูุดุฎุต ุดุฏู ุฏุฑ `--output`)
4. **ุจุงุฒููุณ**: ุจุฏูู `--force` ุฑู ูุงู ููุฌูุฏ ุฎุทุง ูโุฏูุฏ

### ๐ ุนุจโุงุจ

#### ุฎุทุง: "ูฺ ูพุฑูฺู ูุนุงู ุงูุช ูุดุฏ"
```bash
# ุฑุงูโุญู: ูุดุฎุต ฺฉุฑุฏู ID ูพุฑูฺู
python manage.py export_excel --project-id 1
```

#### ุฎุทุง: "ูุงู ุงุฒ ูุจู ูุฌูุฏ ุฏุงุฑุฏ"
```bash
# ุฑุงูโุญู: ุงุณุชูุงุฏู ุงุฒ --force
python manage.py export_excel --output report.xlsx --force
```

#### ุฎุทุง: "Permission denied"
```bash
# ุฑุงูโุญู: ุจุฑุฑุณ ุฏุณุชุฑุณ ูพูุดู ุง ุชุบุฑ ูุณุฑ
python manage.py export_excel --output ~/Desktop/report.xlsx
```

### ๐ ูพุดุชุจุงู

ุจุฑุง ฺฏุฒุงุฑุด ูุดฺฉูุงุช ุง ูพุดููุงุฏุงุชุ ุจู ูุณุชูุฏุงุช ุงุตู ูพุฑูฺู ูุฑุงุฌุนู ฺฉูุฏ.

---

**ุชุงุฑุฎ ุงุฌุงุฏ**: 2025-10-10  
**ูุณุฎู**: 1.0  
**ูุถุนุช**: ูุนุงู ู ุขูุงุฏู ุงุณุชูุงุฏู

