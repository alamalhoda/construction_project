{% load static %}
<!-- Project Switcher Component -->
<div class="project-switcher" id="projectSwitcher">
    <!-- نمایش پروژه فعلی (دکمه کلیک‌پذیر) -->
    <div class="current-project-display" onclick="toggleProjectDropdown()">
        {% if current_project %}
            <i class="fas {{ current_project.icon|default:'fa-building' }}" 
               style="color: {{ current_project.color|default:'#667eea' }}; font-size: 18px;"></i>
            <span class="project-name">{{ current_project.name }}</span>
        {% else %}
            <i class="fas fa-building" style="color: #667eea; font-size: 18px;"></i>
            <span class="project-name">هیچ پروژه‌ای انتخاب نشده</span>
        {% endif %}
        <i class="fas fa-chevron-down dropdown-arrow"></i>
    </div>
    
    <!-- Dropdown لیست پروژه‌ها -->
    <div class="project-dropdown" id="projectDropdown" style="display: none;">
        <div class="project-dropdown-header">
            <span>انتخاب پروژه</span>
        </div>
        
        <div class="project-list">
            {% if all_projects %}
                {% for project in all_projects %}
                <div class="project-item {% if current_project and project.id == current_project.id %}active{% endif %}"
                     onclick="switchProject({{ project.id }})"
                     data-project-id="{{ project.id }}">
                    <!-- آیکون پروژه -->
                    <i class="fas {{ project.icon|default:'fa-building' }}" 
                       style="color: {{ project.color|default:'#667eea' }};"></i>
                    
                    <!-- نام پروژه -->
                    <span class="project-item-name">{{ project.name }}</span>
                    
                    <!-- Badge پروژه فعال -->
                    {% if project.is_active %}
                    <span class="badge badge-success">فعال</span>
                    {% endif %}
                    
                    <!-- علامت انتخاب برای پروژه فعلی -->
                    {% if current_project and project.id == current_project.id %}
                    <i class="fas fa-check project-check-icon"></i>
                    {% endif %}
                </div>
                {% endfor %}
            {% else %}
                <div class="project-item-empty">
                    <span>هیچ پروژه‌ای یافت نشد</span>
                </div>
            {% endif %}
        </div>
        
        <!-- لینک مدیریت پروژه‌ها
        <div class="project-dropdown-footer">
            <a href="{% url 'construction_Project_list' %}" class="project-manage-link">
                <i class="fas fa-cog"></i>
                مدیریت پروژه‌ها
            </a>
        </div> -->
    </div>
</div>

