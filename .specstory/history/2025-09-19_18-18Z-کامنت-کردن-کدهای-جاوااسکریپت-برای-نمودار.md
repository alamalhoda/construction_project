<!-- Generated by SpecStory -->

<!-- cursor Session 728f409b-655c-4475-a623-e9e37690e377 (2025-09-19 18:18Z) -->

# کامنت کردن کدهای جاوااسکریپت برای نمودار (2025-09-19 18:18Z)

_**User (2025-09-19 14:36Z)**_

نمودار  روند تراکنش‌های آورده و برداشت و کدهای جاوااسکریپت مربوط به اون رو کامنت کن. فعلا نمیخوام نشون داده بشوند اما شاید بعدا بخواهم نمایش داده شوند.

---

_**Assistant (default)**_

باشه، می‌خوام نمودار ‏‎‫روند تراکنش‌های آورده و برداشت و کدهای ‏‎JavaScript‫ مربوط به اون رو کامنت کنم تا فعلاً نمایش داده نشوند.

ابتدا فایل ‏‎project_dashboard.html‫ رو کامل بخونم تا تمام بخش‌های مربوط به این نمودار رو پیدا کنم:

---

Tool use: **read_file**

Read file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html

---

حالا بخش‌های مربوط به نمودار "روند تراکنش‌های آورده و برداشت" رو پیدا کردم. این نمودار در چند بخش استفاده شده:

1. بخش ‏‎HTML‫ (خطوط ۹۲۰-۹۲۶)
2. بخش ‏‎JavaScript‫ (تابع ‏‎createProjectPrincipalTransactionChart‫ - خطوط ۱۵۳۴-۱۶۲۱)

الان این بخش‌ها رو کامنت می‌کنم:

---

Tool use: **todo_write**

## Todo List

- [-] کامنت کردن بخش HTML نمودار روند تراکنش‌های آورده و برداشت
- [ ] کامنت کردن تابع JavaScript مربوط به نمودار principalTransactionChart

---

Tool use: **MultiEdit**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 2, lines removed: 1

```diff
@@ -918,5 +918,6 @@
  
  
-                 <!-- Principal Transaction Chart -->
+                 <!-- Principal Transaction Chart - موقتاً کامنت شده -->
+                 <!-- 
                  <div class="chart-container">
                      <h3><i class="fas fa-chart-line"></i> روند تراکنش‌های آورده و برداشت</h3>
```

**Chunk 2**
Lines added: 1, lines removed: undefined

```diff
@@ -925,4 +926,5 @@
                      </div>
                  </div>
+                 -->
  
  
```

</details>

---

حالا بخش ‏‎JavaScript‫ مربوط به این نمودار رو هم کامنت می‌کنم:

---

Tool use: **todo_write**

## Todo List

- [x] کامنت کردن بخش HTML نمودار روند تراکنش‌های آورده و برداشت
- [-] کامنت کردن تابع JavaScript مربوط به نمودار principalTransactionChart

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 2, lines removed: undefined

```diff
@@ -1534,4 +1534,6 @@
          
  
+         // تابع نمودار روند تراکنش‌های آورده و برداشت - موقتاً کامنت شده
+         /*
          function createProjectPrincipalTransactionChart() {
              // فیلتر تراکنش‌های آورده و برداشت
```

**Chunk 2**
Lines added: 1, lines removed: undefined

```diff
@@ -1622,4 +1624,5 @@
              });
          }
+         */
  
  
```

</details>

---

حالا باید فراخوانی این تابع رو از تابع ‏‎processData‫ هم کامنت کنم:

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -1162,5 +1162,5 @@
              
              // نمودارهای جدید از investor_profile
-             createProjectPrincipalTransactionChart();
+             // createProjectPrincipalTransactionChart(); // موقتاً کامنت شده
              createProjectPrincipalTrendChart();
              createProjectMonthlyPrincipalChart();
```

</details>

---

Tool use: **todo_write**

## Todo List

- [x] کامنت کردن بخش HTML نمودار روند تراکنش‌های آورده و برداشت
- [x] کامنت کردن تابع JavaScript مربوط به نمودار principalTransactionChart

---

عالی! نمودار "روند تراکنش‌های آورده و برداشت" و کدهای ‏‎JavaScript‫ مربوط به اون رو با موفقیت کامنت کردم. 

### خلاصه تغییرات انجام شده:

✅ **بخش ‏‎HTML‫ (خطوط ۹۲۰-۹۲۶):** 
- کانتینر نمودار رو کامنت کردم
- توضیح اضافه کردم که موقتاً کامنت شده

✅ **بخش ‏‎JavaScript‫:**
- تابع ‏‎`createProjectPrincipalTransactionChart()`‫ رو کامل کامنت کردم
- فراخوانی این تابع در ‏‎`processData()`‫ رو هم کامنت کردم

حالا این نمودار در صفحه نمایش داده نمی‌شه، اما کدهاش محفوظ مونده و در آینده می‌تونی راحت کامنت‌ها رو برداری تا دوباره نمایش داده بشه. 

بقیه نمودارها (توزیع مشارکت کنندگان، روند تجمعی آورده، و ماهانه آورده و برداشت) همچنان فعال هستند.

---

_**User (2025-09-19 14:36Z)**_

بریم سراغ نمودار  ماهانه آورده و برداشت
میخوام مشخص باشه که در هر ماه چقدر سرمایه داشته ایم یعنی نمودار اورده منهای برداشت به صورت ماهانه و غیر تجمعی

---

_**Assistant (default)**_

باشه، می‌خوام نمودار "ماهانه آورده و برداشت" رو تغییر بدم تا نشون بده که در هر ماه چقدر سرمایه داشتیم (آورده منهای برداشت) به صورت ماهانه و غیر تجمعی.

ابتدا تابع ‏‎JavaScript‫ مربوط به این نمودار رو پیدا می‌کنم و تغییرش می‌دم:

---

Tool use: **codebase_search**

---

Tool use: **grep**

<details>
<summary>Grep for "createProjectMonthlyPrincipalChart" in "/Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html" • 2 matches</summary>

Output mode: content


| Content | Line |
|------|------|
| `createProjectMonthlyPrincipalChart();` | L1166 |
| `function createProjectMonthlyPrincipalChart() \{` | L1686 |


</details>

---

الان بخش تابع ‏‎createProjectMonthlyPrincipalChart‫ رو می‌خونم:

---

Tool use: **read_file**

Read file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html

---

حالا تابع رو تغییر می‌دم تا به جای نمایش آورده و برداشت جداگانه، سرمایه ماهانه (آورده منهای برداشت) رو به صورت غیر تجمعی نشون بده:

---

Tool use: **todo_write**

## Todo List

- [-] تغییر نمودار ماهانه آورده و برداشت تا سرمایه ماهانه (غیر تجمعی) رو نشان دهد

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 5, lines removed: 10

```diff
@@ -1705,14 +1705,9 @@
  
              const months = Object.keys(monthlyData).sort();
-             const principalData = months.map(month => monthlyData[month].principal / BASE_AMOUNT);
-             const withdrawalData = months.map(month => -monthlyData[month].withdrawal / BASE_AMOUNT);
-             
-             // محاسبه خط ترند تجمعی (بدون سود)
-             const cumulativeData = [];
-             let cumulative = 0;
-             months.forEach(month => {
-                 const netMonthly = monthlyData[month].principal - monthlyData[month].withdrawal;
-                 cumulative += netMonthly;
-                 cumulativeData.push(cumulative / BASE_AMOUNT);
+             
+             // محاسبه سرمایه ماهانه (آورده منهای برداشت) به صورت غیر تجمعی
+             const monthlyCapitalData = months.map(month => {
+                 const netCapital = monthlyData[month].principal - monthlyData[month].withdrawal;
+                 return netCapital / BASE_AMOUNT; // تبدیل به میلیون تومان
              });
  
```

**Chunk 2**
Lines added: 8, lines removed: 22

```diff
@@ -1725,27 +1720,13 @@
                          {
                              type: 'bar',
-                             label: 'آورده ماهانه (میلیون تومان)',
-                             data: principalData,
-                             backgroundColor: 'rgba(54, 162, 235, 0.6)',
-                             borderColor: 'rgba(54, 162, 235, 1)',
+                             label: 'سرمایه ماهانه (آورده - برداشت) میلیون تومان',
+                             data: monthlyCapitalData,
+                             backgroundColor: monthlyCapitalData.map(value => 
+                                 value >= 0 ? 'rgba(102, 126, 234, 0.6)' : 'rgba(220, 53, 69, 0.6)'
+                             ),
+                             borderColor: monthlyCapitalData.map(value => 
+                                 value >= 0 ? 'rgba(102, 126, 234, 1)' : 'rgba(220, 53, 69, 1)'
+                             ),
                              borderWidth: 1
-                         },
-                         {
-                             type: 'bar',
-                             label: 'برداشت ماهانه (میلیون تومان)',
-                             data: withdrawalData,
-                             backgroundColor: 'rgba(255, 99, 132, 0.6)',
-                             borderColor: 'rgba(255, 99, 132, 1)',
-                             borderWidth: 1
-                         },
-                         {
-                             type: 'line',
-                             label: 'تجمعی سرمایه موجود (میلیون تومان)',
-                             data: cumulativeData,
-                             borderColor: 'rgba(128, 0, 128, 1)',
-                             backgroundColor: 'rgba(128, 0, 128, 0.1)',
-                             fill: false,
-                             tension: 0.4,
-                             yAxisID: 'y1'
                          }
                      ]
```

**Chunk 3**
Lines added: 16, lines removed: 1

```diff
@@ -1757,5 +1738,20 @@
                          title: {
                              display: true,
-                             text: 'ماهانه آورده و برداشت کل پروژه (بدون سود)'
+                             text: 'سرمایه ماهانه (آورده - برداشت) - غیر تجمعی'
+                         },
+                         tooltip: {
+                             callbacks: {
+                                 label: function(context) {
+                                     const value = context.parsed.y;
+                                     const month = context.label;
+                                     const monthData = monthlyData[month];
+                                     const tooltip = [
+                                         `سرمایه خالص: ${value.toFixed(1)} میلیون تومان`,
+                                         `آورده: ${(monthData.principal / BASE_AMOUNT).toFixed(1)} میلیون تومان`,
+                                         `برداشت: ${(monthData.withdrawal / BASE_AMOUNT).toFixed(1)} میلیون تومان`
+                                     ];
+                                     return tooltip;
+                                 }
+                             }
                          }
                      },
```

**Chunk 4**
Lines added: 16, lines removed: 13

```diff
@@ -1765,22 +1761,25 @@
                              title: {
                                  display: true,
-                                 text: 'مبلغ ماهانه (میلیون تومان)'
-                             }
-                         },
-                         y1: {
-                             type: 'linear',
-                             display: true,
-                             position: 'right',
-                             title: {
-                                 display: true,
-                                 text: 'مجموع تجمعی (میلیون تومان)'
+                                 text: 'سرمایه ماهانه (میلیون تومان)'
                              },
                              grid: {
-                                 drawOnChartArea: false,
-                             },
+                                 color: function(context) {
+                                     // خط صفر را پررنگ‌تر نشان بده
+                                     if (context.tick.value === 0) {
+                                         return '#333333';
+                                     }
+                                     return 'rgba(0, 0, 0, 0.1)';
+                                 },
+                                 lineWidth: function(context) {
+                                     if (context.tick.value === 0) {
+                                         return 2;
+                                     }
+                                     return 1;
+                                 }
+                             }
                          }
                      }
                  }
-                 });
+             });
          }
  
```

</details>

---

حالا عنوان نمودار در بخش ‏‎HTML‫ رو هم تغییر می‌دم تا با محتوای جدید مطابقت داشته باشه:

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 2, lines removed: 2

```diff
@@ -937,7 +937,7 @@
                  </div>
  
-                 <!-- Monthly Principal Chart -->
+                 <!-- Monthly Capital Chart -->
                  <div class="chart-container">
-                     <h3><i class="fas fa-chart-area"></i> ماهانه آورده و برداشت</h3>
+                     <h3><i class="fas fa-chart-bar"></i> سرمایه ماهانه (آورده - برداشت)</h3>
                      <div class="chart-wrapper">
                          <canvas id="monthlyPrincipalChart"></canvas>
```

</details>

---

Tool use: **todo_write**

## Todo List

- [x] تغییر نمودار ماهانه آورده و برداشت تا سرمایه ماهانه (غیر تجمعی) رو نشان دهد

---

عالی! نمودار "ماهانه آورده و برداشت" رو با موفقیت تغییر دادم. حالا این نمودار:

### ✅ **تغییرات انجام شده:**

**🔵 عنوان نمودار:**
- از "ماهانه آورده و برداشت" به "سرمایه ماهانه (آورده - برداشت)" تغییر کرد

**📊 نحوه نمایش:**
- **قبلاً:** دو بار جداگانه (آورده و برداشت) + خط تجمعی
- **الان:** یک بار واحد که نشان‌دهنده سرمایه خالص ماهانه (آورده منهای برداشت) است

**🎨 رنگ‌بندی هوشمند:**
- **مثبت (آورده بیشتر از برداشت):** آبی بنفش `rgba(102, 126, 234)` - رنگ سرمایه از استاندارد پروژه
- **منفی (برداشت بیشتر از آورده):** قرمز `rgba(220, 53, 69)` - رنگ هزینه از استاندارد پروژه

**💡 ویژگی‌های جدید:**
- **خط صفر پررنگ:** برای تشخیص آسان ماه‌های مثبت و منفی
- **Tooltip پیشرفته:** نشان می‌دهد:
  - سرمایه خالص ماهانه
  - مقدار آورده در آن ماه  
  - مقدار برداشت در آن ماه

**📈 نحوه کارکرد:**
- هر ماه، سرمایه خالص = آورده - برداشت
- اگر مثبت باشه، یعنی در آن ماه سرمایه اضافه شده
- اگر منفی باشه، یعنی در آن ماه سرمایه کم شده
- **غیر تجمعی** یعنی هر ماه مستقل از ماه‌های قبل نمایش داده می‌شه

حالا می‌تونی ببینی که در هر ماه دقیقاً چقدر تغییر سرمایه داشتی!

---

_**User (2025-09-19 14:36Z)**_

نمودار جدید که ساختی خیلی خوب بود به عنوان یک نمودار جدید اضافه شود

---

_**Assistant (default)**_

باشه، نمودار جدیدی که ساختم رو به عنوان یک نمودار اضافی اضافه می‌کنم تا هم نمودار قدیمی باشه و هم نمودار جدید.

ابتدا یک کانتینر جدید برای نمودار سرمایه ماهانه اضافه می‌کنم:

---

Tool use: **todo_write**

## Todo List

- [-] اضافه کردن نمودار جدید سرمایه ماهانه (آورده - برداشت) به عنوان نمودار مستقل

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 8, lines removed: undefined

```diff
@@ -944,4 +944,12 @@
                      </div>
                  </div>
+ 
+                 <!-- Monthly Capital Net Chart -->
+                 <div class="chart-container">
+                     <h3><i class="fas fa-chart-bar"></i> سرمایه ماهانه (آورده - برداشت)</h3>
+                     <div class="chart-wrapper">
+                         <canvas id="monthlyCapitalNetChart"></canvas>
+                     </div>
+                 </div>
              </div>
  
```

</details>

---

حالا تابع ‏‎JavaScript‫ جدید برای نمودار سرمایه ماهانه رو اضافه می‌کنم:

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 100, lines removed: undefined

```diff
@@ -1792,4 +1792,104 @@
                  });
          }
+ 
+         function createMonthlyCapitalNetChart() {
+             // گروه‌بندی بر اساس ماه (فقط آورده و برداشت، بدون سود)
+             const monthlyData = {};
+             
+             chartData.forEach(row => {
+                 if (row.date_shamsi && (row.entry_type === 'principal_deposit' || row.entry_type === 'principal_withdrawal')) {
+                     const month = row.date_shamsi.substring(0, 7); // YYYY-MM
+                     if (!monthlyData[month]) {
+                         monthlyData[month] = { principal: 0, withdrawal: 0 };
+                     }
+                     
+                     const amount = parseFloat(row.amount || 0);
+                     if (row.entry_type === 'principal_deposit') {
+                         monthlyData[month].principal += amount;
+                     } else if (row.entry_type === 'principal_withdrawal') {
+                         monthlyData[month].withdrawal += Math.abs(amount);
+                     }
+                 }
+             });
+ 
+             const months = Object.keys(monthlyData).sort();
+             
+             // محاسبه سرمایه ماهانه (آورده منهای برداشت) به صورت غیر تجمعی
+             const monthlyCapitalData = months.map(month => {
+                 const netCapital = monthlyData[month].principal - monthlyData[month].withdrawal;
+                 return netCapital / BASE_AMOUNT; // تبدیل به میلیون تومان
+             });
+ 
+             const ctx = document.getElementById('monthlyCapitalNetChart').getContext('2d');
+             charts.monthlyCapitalNetChart = new Chart(ctx, {
+                 type: 'bar',
+                 data: {
+                     labels: months,
+                     datasets: [
+                         {
+                             type: 'bar',
+                             label: 'سرمایه ماهانه (آورده - برداشت) میلیون تومان',
+                             data: monthlyCapitalData,
+                             backgroundColor: monthlyCapitalData.map(value => 
+                                 value >= 0 ? 'rgba(102, 126, 234, 0.6)' : 'rgba(220, 53, 69, 0.6)'
+                             ),
+                             borderColor: monthlyCapitalData.map(value => 
+                                 value >= 0 ? 'rgba(102, 126, 234, 1)' : 'rgba(220, 53, 69, 1)'
+                             ),
+                             borderWidth: 1
+                         }
+                     ]
+                 },
+                 options: {
+                     responsive: true,
+                     maintainAspectRatio: false,
+                     plugins: {
+                         title: {
+                             display: true,
+                             text: 'سرمایه ماهانه (آورده - برداشت) - غیر تجمعی'
+                         },
+                         tooltip: {
+                             callbacks: {
+                                 label: function(context) {
+                                     const value = context.parsed.y;
+                                     const month = context.label;
+                                     const monthData = monthlyData[month];
+                                     const tooltip = [
+                                         `سرمایه خالص: ${value.toFixed(1)} میلیون تومان`,
+                                         `آورده: ${(monthData.principal / BASE_AMOUNT).toFixed(1)} میلیون تومان`,
+                                         `برداشت: ${(monthData.withdrawal / BASE_AMOUNT).toFixed(1)} میلیون تومان`
+                                     ];
+                                     return tooltip;
+                                 }
+                             }
+                         }
+                     },
+                     scales: {
+                         y: {
+                             beginAtZero: true,
+                             title: {
+                                 display: true,
+                                 text: 'سرمایه ماهانه (میلیون تومان)'
+                             },
+                             grid: {
+                                 color: function(context) {
+                                     // خط صفر را پررنگ‌تر نشان بده
+                                     if (context.tick.value === 0) {
+                                         return '#333333';
+                                     }
+                                     return 'rgba(0, 0, 0, 0.1)';
+                                 },
+                                 lineWidth: function(context) {
+                                     if (context.tick.value === 0) {
+                                         return 2;
+                                     }
+                                     return 1;
+                                 }
+                             }
+                         }
+                     }
+                 }
+             });
+         }
  
          // بررسی بارگذاری Chart.js
```

</details>

---

حالا فراخوانی تابع جدید رو به تابع ‏‎processData‫ اضافه می‌کنم:

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 1, lines removed: undefined

```diff
@@ -1173,4 +1173,5 @@
              createProjectPrincipalTrendChart();
              createProjectMonthlyPrincipalChart();
+             createMonthlyCapitalNetChart();
              
              await createSummaryTable();
```

</details>

---

Tool use: **todo_write**

## Todo List

- [x] اضافه کردن نمودار جدید سرمایه ماهانه (آورده - برداشت) به عنوان نمودار مستقل

---

عالی! نمودار جدید "سرمایه ماهانه (آورده - برداشت)" رو با موفقیت به عنوان یک نمودار مستقل اضافه کردم.

### ✅ **نمودارهای موجود در صفحه:**

**📊 نمودارهای فعلی:**
1. **توزیع مشارکت کنندگان** - نمودار دایره‌ای
2. **روند تجمعی سرمایه موجود** - نمودار خطی  
3. **ماهانه آورده و برداشت** - نمودار ترکیبی (بار + خط تجمعی)
4. **🆕 سرمایه ماهانه (آورده - برداشت)** - نمودار بار جدید

**🎯 ویژگی‌های نمودار جدید:**

**📈 نمایش داده:**
- هر ماه نشان می‌دهد چقدر سرمایه خالص داشته‌اید
- فرمول: آورده ماهانه - برداشت ماهانه
- **غیر تجمعی** - هر ماه مستقل از ماه‌های قبل

**🎨 رنگ‌بندی هوشمند:**
- **آبی بنفش:** ماه‌هایی که سرمایه اضافه شده (مثبت)
- **قرمز:** ماه‌هایی که سرمایه کم شده (منفی)

**💡 ویژگی‌های بصری:**
- خط صفر پررنگ برای تشخیص آسان
- ‏‎Tooltip‫ پیشرفته که نشان می‌دهد:
  - سرمایه خالص ماهانه
  - مقدار آورده در آن ماه
  - مقدار برداشت در آن ماه

**🔄 تفاوت با نمودار قبلی:**
- **نمودار قدیمی:** آورده و برداشت جداگانه + خط تجمعی
- **نمودار جدید:** سرمایه خالص ماهانه (آورده - برداشت) غیر تجمعی

حالا می‌تونید هم جزئیات آورده و برداشت رو ببینید و هم یک نمای کلی از تغییرات سرمایه ماهانه داشته باشید!

---

_**User (2025-09-19 14:36Z)**_

آیا میشود  سرمایه ماهانه (آورده - برداشت) به شکل نمودار ترند اما غیر تجمعی به نمودار  ماهانه آورده و برداشت اضافه شود

---

_**Assistant (default)**_

بله، حتماً! می‌تونم یک خط ترند برای سرمایه ماهانه (آورده - برداشت) به نمودار "ماهانه آورده و برداشت" اضافه کنم. این خط نشان‌دهنده سرمایه خالص هر ماه (غیر تجمعی) خواهد بود.

---

Tool use: **todo_write**

## Todo List

- [-] اضافه کردن خط ترند سرمایه ماهانه (غیر تجمعی) به نمودار ماهانه آورده و برداشت

---

Tool use: **codebase_search**

---

Tool use: **grep**

<details>
<summary>Grep for "createProjectMonthlyPrincipalChart" in "/Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html" • 2 matches</summary>

Output mode: content


| Content | Line |
|------|------|
| `createProjectMonthlyPrincipalChart();` | L1174 |
| `function createProjectMonthlyPrincipalChart() \{` | L1695 |


</details>

---

Tool use: **read_file**

Read file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html

---

حالا تابع ‏‎createProjectMonthlyPrincipalChart‫ رو تغییر می‌دم تا یک خط ترند سرمایه ماهانه (غیر تجمعی) اضافه کنم:

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 6, lines removed: undefined

```diff
@@ -1716,4 +1716,10 @@
              const principalData = months.map(month => monthlyData[month].principal / BASE_AMOUNT);
              const withdrawalData = months.map(month => -monthlyData[month].withdrawal / BASE_AMOUNT);
+             
+             // محاسبه سرمایه ماهانه (غیر تجمعی) - آورده منهای برداشت
+             const monthlyNetCapitalData = months.map(month => {
+                 const netMonthly = monthlyData[month].principal - monthlyData[month].withdrawal;
+                 return netMonthly / BASE_AMOUNT;
+             });
              
              // محاسبه خط ترند تجمعی (بدون سود)
```

</details>

---

حالا خط ترند سرمایه ماهانه رو به ‏‎datasets‫ اضافه می‌کنم:

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 2, lines removed: 2

```diff
@@ -1742,6 +1742,6 @@
                              label: 'آورده ماهانه (میلیون تومان)',
                              data: principalData,
-                             backgroundColor: 'rgba(54, 162, 235, 0.6)',
-                             borderColor: 'rgba(54, 162, 235, 1)',
+                             backgroundColor: 'rgba(33, 133, 208, 0.6)', // رنگ آبی آورده از استاندارد پروژه
+                             borderColor: 'rgba(33, 133, 208, 1)',
                              borderWidth: 1
                          },
```

**Chunk 2**
Lines added: 17, lines removed: 2

```diff
@@ -1750,8 +1750,23 @@
                              label: 'برداشت ماهانه (میلیون تومان)',
                              data: withdrawalData,
-                             backgroundColor: 'rgba(255, 99, 132, 0.6)',
-                             borderColor: 'rgba(255, 99, 132, 1)',
+                             backgroundColor: 'rgba(219, 40, 40, 0.6)', // رنگ قرمز برداشت از استاندارد پروژه
+                             borderColor: 'rgba(219, 40, 40, 1)',
                              borderWidth: 1
                          },
+                         {
+                             type: 'line',
+                             label: 'سرمایه ماهانه (آورده - برداشت) میلیون تومان',
+                             data: monthlyNetCapitalData,
+                             borderColor: 'rgba(102, 126, 234, 1)', // رنگ بنفش سرمایه از استاندارد پروژه
+                             backgroundColor: 'rgba(102, 126, 234, 0.2)',
+                             fill: false,
+                             tension: 0.3,
+                             borderWidth: 3,
+                             pointRadius: 5,
+                             pointBackgroundColor: 'rgba(102, 126, 234, 1)',
+                             pointBorderColor: '#ffffff',
+                             pointBorderWidth: 2,
+                             yAxisID: 'y'
+                         },
                          {
                              type: 'line',
```

**Chunk 3**
Lines added: 2, lines removed: undefined

```diff
@@ -1762,4 +1777,6 @@
                              fill: false,
                              tension: 0.4,
+                             borderWidth: 2,
+                             borderDash: [5, 5], // خط چین برای تمایز
                              yAxisID: 'y1'
                          }
```

</details>

---

حالا عنوان نمودار رو به‌روزرسانی می‌کنم تا شامل خط ترند جدید باشه:

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -1789,5 +1789,5 @@
                          title: {
                              display: true,
-                             text: 'ماهانه آورده و برداشت کل پروژه (بدون سود)'
+                             text: 'ماهانه آورده، برداشت و سرمایه خالص (بدون سود)'
                          }
                      },
```

</details>

---

حالا ‏‎scales‫ رو تنظیم می‌کنم تا خط ترند سرمایه ماهانه خط صفر داشته باشه:

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 16, lines removed: 1

```diff
@@ -1798,5 +1798,20 @@
                                  display: true,
                                  text: 'مبلغ ماهانه (میلیون تومان)'
-                             }
+                             },
+                             grid: {
+                                 color: function(context) {
+                                     // خط صفر را پررنگ‌تر نشان بده
+                                     if (context.tick.value === 0) {
+                                         return '#333333';
+                                     }
+                                     return 'rgba(0, 0, 0, 0.1)';
+                                 },
+                                 lineWidth: function(context) {
+                                     if (context.tick.value === 0) {
+                                         return 2;
+                                     }
+                                     return 1;
+                                 }
+                             }
                          },
                          y1: {
```

</details>

---

Tool use: **todo_write**

## Todo List

- [x] اضافه کردن خط ترند سرمایه ماهانه (غیر تجمعی) به نمودار ماهانه آورده و برداشت

---

عالی! خط ترند سرمایه ماهانه (آورده - برداشت) رو با موفقیت به نمودار "ماهانه آورده و برداشت" اضافه کردم.

### ✅ **تغییرات انجام شده در نمودار "ماهانه آورده و برداشت":**

**📊 عناصر جدید نمودار:**
1. **بار آبی:** آورده ماهانه (رنگ آبی استاندارد پروژه)
2. **بار قرمز:** برداشت ماهانه (رنگ قرمز استاندارد پروژه)  
3. **🆕 خط ترند بنفش:** سرمایه ماهانه (آورده - برداشت) - **غیر تجمعی**
4. **خط چین بنفش:** تجمعی سرمایه موجود

**🎨 ویژگی‌های بصری خط ترند جدید:**
- **رنگ:** بنفش `rgba(102, 126, 234)` - رنگ سرمایه از استاندارد پروژه
- **ضخامت:** ۳ پیکسل برای برجستگی
- **نقاط:** دایره‌های بزرگ با حاشیه سفید
- **محور:** همان محور چپ (y) مثل بارها

**📈 نحوه کارکرد:**
- **خط ترند جدید:** نشان می‌دهد در هر ماه چقدر سرمایه خالص داشته‌اید (غیر تجمعی)
- **بالای صفر:** ماه‌هایی که آورده بیشتر از برداشت بوده
- **پایین صفر:** ماه‌هایی که برداشت بیشتر از آورده بوده
- **خط صفر پررنگ:** برای تشخیص آسان نقطه تعادل

**🔄 تفاوت با خط تجمعی:**
- **خط ترند جدید (بنفش):** سرمایه ماهانه مستقل - هر ماه خودش
- **خط تجمعی (چین‌دار):** مجموع کل سرمایه تا آن ماه

**🎯 مزایای این ترکیب:**
- می‌بینید جزئیات آورده و برداشت هر ماه
- می‌بینید سرمایه خالص هر ماه (غیر تجمعی)  
- می‌بینید روند کلی سرمایه (تجمعی)
- همه اطلاعات در یک نمودار!

حالا می‌تونید در یک نگاه ببینید که در هر ماه چه اتفاقی برای سرمایه‌تون افتاده! 📊✨

---

_**User (2025-09-19 14:36Z)**_

در نمودار  ماهانه آورده و برداشت. نمودار ترند سرمایه ماهانه(اورده-برداشت) به رنگ بنفش باشد

---

_**Assistant (default)**_

بله، خط ترند سرمایه ماهانه (آورده - برداشت) قبلاً به رنگ بنفش تنظیم شده، اما بیایید مطمئن شویم که از رنگ بنفش استاندارد پروژه استفاده می‌کند.

بیایید کد فعلی را بررسی کنم:

---

Tool use: **grep**

<details>
<summary>Grep for "سرمایه ماهانه.*آورده.*برداشت.*میلیون تومان" in "/Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html" • 2 matches</summary>

Output mode: content


| Content | Line |
|------|------|
| `label: 'سرمایه ماهانه (آورده - برداشت) میلیون تومان',` | L1758 |
| `label: 'سرمایه ماهانه (آورده - برداشت) میلیون تومان',` | L1870 |


</details>

---

Tool use: **read_file**

Read file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html

---

عالی! خط ترند سرمایه ماهانه (آورده - برداشت) قبلاً به رنگ بنفش `rgba(102, 126, 234, 1)` تنظیم شده که همان رنگ استاندارد سرمایه موجود از پروژه است.

برای اطمینان بیشتر، بیایید بررسی کنم که آیا از رنگ‌های CSS Variables استاندارد پروژه استفاده کنیم:

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -1758,5 +1758,5 @@
                              label: 'سرمایه ماهانه (آورده - برداشت) میلیون تومان',
                              data: monthlyNetCapitalData,
-                             borderColor: 'rgba(102, 126, 234, 1)', // رنگ بنفش سرمایه از استاندارد پروژه
+                             borderColor: '#667eea', // رنگ بنفش سرمایه از استاندارد پروژه (--capital-color)
                              backgroundColor: 'rgba(102, 126, 234, 0.2)',
                              fill: false,
```

</details>

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -1764,5 +1764,5 @@
                              borderWidth: 3,
                              pointRadius: 5,
-                             pointBackgroundColor: 'rgba(102, 126, 234, 1)',
+                             pointBackgroundColor: '#667eea',
                              pointBorderColor: '#ffffff',
                              pointBorderWidth: 2,
```

</details>

---

عالی! ✅ **خط ترند سرمایه ماهانه (آورده - برداشت) حالا کاملاً به رنگ بنفش استاندارد پروژه تنظیم شده:**

### 🎨 **رنگ‌بندی خط ترند سرمایه ماهانه:**

**🟣 رنگ اصلی:** `#667eea` - بنفش استاندارد سرمایه موجود از پروژه
- **خط:** بنفش پررنگ
- **نقاط:** بنفش با حاشیه سفید
- **پس‌زمینه:** بنفش شفاف

### 📊 **رنگ‌بندی کل نمودار "ماهانه آورده و برداشت":**

1. **🔵 بار آبی:** آورده ماهانه - `rgba(33, 133, 208)` (رنگ استاندارد آورده)
2. **🔴 بار قرمز:** برداشت ماهانه - `rgba(219, 40, 40)` (رنگ استاندارد برداشت)
3. **🟣 خط ترند بنفش:** سرمایه ماهانه - `#667eea` (رنگ استاندارد سرمایه)
4. **🟣 خط چین بنفش:** تجمعی سرمایه - `rgba(128, 0, 128)` (بنفش تیره‌تر)

همه رنگ‌ها مطابق با استاندارد پروژه هستند و خط ترند سرمایه ماهانه به رنگ بنفش زیبا نمایش داده می‌شود! 🎨✨

---

_**User (2025-09-19 14:36Z)**_

نمودار  روند سرمایه موجود
و نمودار  سرمایه ماهانه (آورده - برداشت)
حذف شوند

---

_**Assistant (default)**_

باشه، نمودارهای "روند سرمایه موجود" و "سرمایه ماهانه (آورده - برداشت)" رو حذف می‌کنم.

---

Tool use: **todo_write**

## Todo List

- [-] حذف نمودار روند سرمایه موجود
- [ ] حذف نمودار سرمایه ماهانه (آورده - برداشت)

---

ابتدا بخش ‏‎HTML‫ نمودار "روند سرمایه موجود" رو حذف می‌کنم:

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: undefined, lines removed: 7

```diff
@@ -929,11 +929,4 @@
  
  
-                 <!-- Principal Trend Chart -->
-                 <div class="chart-container">
-                     <h3><i class="fas fa-chart-line"></i> روند سرمایه موجود</h3>
-                     <div class="chart-wrapper">
-                         <canvas id="principalTrendChart"></canvas>
-                     </div>
-                 </div>
  
                  <!-- Monthly Principal Chart -->
```

</details>

---

حالا بخش ‏‎HTML‫ نمودار "سرمایه ماهانه (آورده - برداشت)" رو حذف می‌کنم:

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: undefined, lines removed: 7

```diff
@@ -938,11 +938,4 @@
                  </div>
  
-                 <!-- Monthly Capital Net Chart -->
-                 <div class="chart-container">
-                     <h3><i class="fas fa-chart-bar"></i> سرمایه ماهانه (آورده - برداشت)</h3>
-                     <div class="chart-wrapper">
-                         <canvas id="monthlyCapitalNetChart"></canvas>
-                     </div>
-                 </div>
              </div>
  
```

</details>

---

حالا فراخوانی تابع ‏‎createProjectPrincipalTrendChart‫ رو از ‏‎processData‫ حذف می‌کنم:

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: 2, lines removed: 2

```diff
@@ -1157,7 +1157,7 @@
              // نمودارهای جدید از investor_profile
              // createProjectPrincipalTransactionChart(); // موقتاً کامنت شده
-             createProjectPrincipalTrendChart();
+             // createProjectPrincipalTrendChart(); // حذف شده
              createProjectMonthlyPrincipalChart();
-             createMonthlyCapitalNetChart();
+             // createMonthlyCapitalNetChart(); // حذف شده
              
              await createSummaryTable();
```

</details>

---

حالا تابع ‏‎createProjectPrincipalTrendChart‫ رو حذف می‌کنم:

---

Tool use: **grep**

<details>
<summary>Grep for "function createProjectPrincipalTrendChart" in "/Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html" • 1 match</summary>

Output mode: content


| Content | Line |
|------|------|
| `function createProjectPrincipalTrendChart() \{` | L1624 |


</details>

---

Tool use: **read_file**

Read file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: undefined, lines removed: 56

```diff
@@ -1622,60 +1622,4 @@
  
  
-         function createProjectPrincipalTrendChart() {
-             // فیلتر تراکنش‌های آورده و برداشت
-             const transactions = chartData.filter(row => 
-                 row.entry_type === 'principal_deposit' || row.entry_type === 'principal_withdrawal'
-             );
- 
-             // مرتب‌سازی بر اساس تاریخ
-             const sortedTransactions = transactions.sort((a, b) => a.date_shamsi.localeCompare(b.date_shamsi));
- 
-             const labels = [];
-             const data = [];
-             let cumulative = 0;
- 
-             sortedTransactions.forEach(transaction => {
-                 const amount = parseFloat(transaction.amount || 0);
-                 cumulative += amount;
-                 
-                 labels.push(transaction.date_shamsi);
-                 data.push(cumulative / BASE_AMOUNT);
-             });
- 
-             const ctx = document.getElementById('principalTrendChart').getContext('2d');
-             charts.principalTrendChart = new Chart(ctx, {
-                 type: 'line',
-                 data: {
-                     labels: labels,
-                     datasets: [{
-                         label: 'مجموع تجمعی سرمایه موجود (میلیون تومان)',
-                         data: data,
-                         borderColor: 'rgba(128, 0, 128, 1)',
-                         backgroundColor: 'rgba(128, 0, 128, 0.1)',
-                         fill: true,
-                         tension: 0.4
-                     }]
-                 },
-                 options: {
-                     responsive: true,
-                     maintainAspectRatio: false,
-                     plugins: {
-                         title: {
-                             display: true,
-                             text: 'روند تجمعی سرمایه موجود '
-                         }
-                     },
-                     scales: {
-                         y: {
-                             beginAtZero: true,
-                             title: {
-                                 display: true,
-                                 text: 'مبلغ تجمعی (میلیون تومان)'
-                             }
-                         }
-                     }
-                 }
-             });
-         }
  
          function createProjectMonthlyPrincipalChart() {
```

</details>

---

حالا تابع ‏‎createMonthlyCapitalNetChart‫ رو حذف می‌کنم:

---

Tool use: **grep**

<details>
<summary>Grep for "function createMonthlyCapitalNetChart" in "/Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html" • 1 match</summary>

Output mode: content


| Content | Line |
|------|------|
| `function createMonthlyCapitalNetChart() \{` | L1764 |


</details>

---

Tool use: **read_file**

Read file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html

---

Tool use: **read_file**

Read file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html

---

Tool use: **grep**

<details>
<summary>Grep for "        }" in "/Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html" • 271 matches</summary>

Output mode: content


| Content | Line |
|------|------|
| `\}` | L76 |
| `\}` | L118 |
| `\}` | L125 |
| `\}` | L134 |
| `\}` | L144 |
| `\}` | L149 |
| `\}` | L160 |
| `\}` | L171 |
| `\}` | L177 |
| `\}` | L188 |
| `\}` | L193 |
| `\}` | L200 |
| `\}` | L207 |
| `\}` | L222 |
| `\}` | L228 |
| `\}` | L232 |
| `\}` | L253 |
| `\}` | L260 |
| `\}` | L264 |
| `\}` | L271 |
| `\}` | L277 |
| `\}` | L282 |
| `\}` | L292 |
| `\}` | L301 |
| `\}` | L306 |
| `\}` | L312 |
| `\}` | L317 |
| `\}` | L325 |
| `\}` | L330 |
| `\}` | L336 |
| `\}` | L341 |
| `\}` | L349 |
| `\}` | L354 |
| `\}` | L360 |
| `\}` | L365 |
| `\}` | L373 |
| `\}` | L378 |
| `\}` | L384 |
| `\}` | L389 |
| `\}` | L394 |
| `\}` | L400 |
| `\}` | L405 |
| `\}` | L414 |
| `\}` | L419 |
| `\}` | L425 |
| `\}` | L430 |
| `\}` | L437 |
| `\}` | L444 |
| `\}` | L449 |
| `\}` | L455 |
| `\}` | L460 |
| `\}` | L470 |
| `\}` | L475 |
| `\}` | L481 |
| `\}` | L487 |
| `\}` | L492 |
| `\}` | L499 |
| `\}` | L507 |
| `\}` | L514 |
| `\}` | L519 |
| `\}` | L528 |
| `\}` | L535 |
| `\}` | L541 |
| `\}` | L548 |
| `\}` | L554 |
| `\}` | L558 |
| `\}` | L565 |
| `\}` | L571 |
| `\}` | L577 |
| `\}` | L583 |
| `\}` | L590 |
| `\}` | L596 |
| `\}` | L602 |
| `\}` | L608 |
| `\}` | L614 |
| `\}` | L619 |
| `\}` | L624 |
| `\}` | L628 |
| `\}` | L632 |
| `\}` | L636 |
| `\}` | L640 |
| `\}` | L647 |
| `\}` | L656 |
| `\}` | L662 |
| `\}` | L668 |
| `\}` | L672 |
| `\}` | L676 |
| `\}` | L682 |
| `\}` | L687 |
| `\}` | L691 |
| `\}` | L695 |
| `\}` | L700 |
| `\}` | L704 |
| `\}` | L708 |
| `\}` | L713 |
| `\}` | L717 |
| `\}` | L721 |
| `\}` | L726 |
| `\}` | L730 |
| `\}` | L734 |
| `\}` | L739 |
| `\}` | L743 |
| `\}` | L747 |
| `\}` | L753 |
| `\}` | L757 |
| `\}` | L761 |
| `\}` | L766 |
| `\}` | L770 |
| `\}` | L774 |
| `\}` | L775 |
| `\};` | L960 |
| `\};` | L964 |
| `\};` | L968 |
| `\};` | L972 |
| `\};` | L976 |
| `\}),` | L1005 |
| `\}),` | L1009 |
| `\}),` | L1013 |
| `\}),` | L1017 |
| `\}),` | L1021 |
| `\})` | L1025 |
| `\}` | L1031 |
| `\}` | L1034 |
| `\} else \{` | L1052 |
| `\}` | L1055 |
| `\} else \{` | L1061 |
| `\}` | L1064 |
| `\} else \{` | L1070 |
| `\}` | L1073 |
| `\} else \{` | L1079 |
| `\}` | L1082 |
| `\} else \{` | L1088 |
| `\}` | L1091 |
| `\} else \{` | L1097 |
| `\}` | L1100 |
| `\});` | L1106 |
| `\}` | L1112 |
| `\})).filter(row => row.project_id && row.project_id.toString().trim() !== '');` | L1126 |
| `\}` | L1133 |
| `\} catch (error) \{` | L1137 |
| `\}` | L1140 |
| `\}` | L1141 |
| `\}` | L1148 |
| `\}` | L1164 |
| `\}` | L1201 |
| `\}` | L1202 |
| `\}` | L1207 |
| `\}` | L1210 |
| `\}` | L1215 |


</details>

---

بیایید تابع کامل ‏‎createMonthlyCapitalNetChart‫ رو حذف کنم:

---

Tool use: **search_replace**


<details><summary>Edit file: /Users/alamalhoda/Projects/Arash_Project/djangobuilder/construction_project/dashboard/view/project_dashboard.html</summary>

**Chunk 1**
Lines added: undefined, lines removed: 99

```diff
@@ -1762,103 +1762,4 @@
          }
  
-         function createMonthlyCapitalNetChart() {
-             // گروه‌بندی بر اساس ماه (فقط آورده و برداشت، بدون سود)
-             const monthlyData = {};
-             
-             chartData.forEach(row => {
-                 if (row.date_shamsi && (row.entry_type === 'principal_deposit' || row.entry_type === 'principal_withdrawal')) {
-                     const month = row.date_shamsi.substring(0, 7); // YYYY-MM
-                     if (!monthlyData[month]) {
-                         monthlyData[month] = { principal: 0, withdrawal: 0 };
-                     }
-                     
-                     const amount = parseFloat(row.amount || 0);
-                     if (row.entry_type === 'principal_deposit') {
-                         monthlyData[month].principal += amount;
-                     } else if (row.entry_type === 'principal_withdrawal') {
-                         monthlyData[month].withdrawal += Math.abs(amount);
-                     }
-                 }
-             });
- 
-             const months = Object.keys(monthlyData).sort();
-             
-             // محاسبه سرمایه ماهانه (آورده منهای برداشت) به صورت غیر تجمعی
-             const monthlyCapitalData = months.map(month => {
-                 const netCapital = monthlyData[month].principal - monthlyData[month].withdrawal;
-                 return netCapital / BASE_AMOUNT; // تبدیل به میلیون تومان
-             });
- 
-             const ctx = document.getElementById('monthlyCapitalNetChart').getContext('2d');
-             charts.monthlyCapitalNetChart = new Chart(ctx, {
-                 type: 'bar',
-                 data: {
-                     labels: months,
-                     datasets: [
-                         {
-                             type: 'bar',
-                             label: 'سرمایه ماهانه (آورده - برداشت) میلیون تومان',
-                             data: monthlyCapitalData,
-                             backgroundColor: monthlyCapitalData.map(value => 
-                                 value >= 0 ? 'rgba(102, 126, 234, 0.6)' : 'rgba(220, 53, 69, 0.6)'
-                             ),
-                             borderColor: monthlyCapitalData.map(value => 
-                                 value >= 0 ? 'rgba(102, 126, 234, 1)' : 'rgba(220, 53, 69, 1)'
-                             ),
-                             borderWidth: 1
-                         }
-                     ]
-                 },
-                 options: {
-                     responsive: true,
-                     maintainAspectRatio: false,
-                     plugins: {
-                         title: {
-                             display: true,
-                             text: 'سرمایه ماهانه (آورده - برداشت) - غیر تجمعی'
-                         },
-                         tooltip: {
-                             callbacks: {
-                                 label: function(context) {
-                                     const value = context.parsed.y;
-                                     const month = context.label;
-                                     const monthData = monthlyData[month];
-                                     const tooltip = [
-                                         `سرمایه خالص: ${value.toFixed(1)} میلیون تومان`,
-                                         `آورده: ${(monthData.principal / BASE_AMOUNT).toFixed(1)} میلیون تومان`,
-                                         `برداشت: ${(monthData.withdrawal / BASE_AMOUNT).toFixed(1)} میلیون تومان`
-                                     ];
-                                     return tooltip;
-                                 }
-                             }
-                         }
-                     },
-                     scales: {
-                         y: {
-                             beginAtZero: true,
-                             title: {
-                                 display: true,
-                                 text: 'سرمایه ماهانه (میلیون تومان)'
-                             },
-                             grid: {
-                                 color: function(context) {
-                                     // خط صفر را پررنگ‌تر نشان بده
-                                     if (context.tick.value === 0) {
-                                         return '#333333';
-                                     }
-                                     return 'rgba(0, 0, 0, 0.1)';
-                                 },
-                                 lineWidth: function(context) {
-                                     if (context.tick.value === 0) {
-                                         return 2;
-                                     }
-                                     return 1;
-                                 }
-                             }
-                         }
-                     }
-                 }
-             });
-         }
  
          // بررسی بارگذاری Chart.js
```

</details>

---

Tool use: **todo_write**

## Todo List

- [x] حذف نمودار روند سرمایه موجود
- [x] حذف نمودار سرمایه ماهانه (آورده - برداشت)

---

عالی! ✅ **نمودارهای مورد نظر با موفقیت حذف شدند:**

### 🗑️ **نمودارهای حذف شده:**

**❌ نمودار "روند سرمایه موجود":**
- بخش ‏‎HTML‫ حذف شد
- تابع ‏‎`createProjectPrincipalTrendChart()`‫ حذف شد  
- فراخوانی تابع کامنت شد

**❌ نمودار "سرمایه ماهانه (آورده - برداشت)":**
- بخش ‏‎HTML‫ حذف شد
- تابع ‏‎`createMonthlyCapitalNetChart()`‫ حذف شد
- فراخوانی تابع کامنت شد

### 📊 **نمودارهای باقی‌مانده در صفحه:**

✅ **نمودارهای فعال:**
1. **توزیع مشارکت کنندگان** - نمودار دایره‌ای
2. **ماهانه آورده و برداشت** - نمودار ترکیبی شامل:
   - بارهای آبی و قرمز (آورده و برداشت)
   - خط ترند بنفش (سرمایه ماهانه غیر تجمعی)
   - خط چین بنفش (تجمعی سرمایه موجود)

### 🎯 **وضعیت فعلی:**
- صفحه سبک‌تر و سریع‌تر شده
- نمودارهای اضافی حذف شدند
- نمودار اصلی "ماهانه آورده و برداشت" همچنان تمام اطلاعات مورد نیاز رو نمایش می‌دهد

حالا صفحه فقط نمودارهای ضروری رو داره و کارایی بهتری خواهد داشت! 🚀

---

