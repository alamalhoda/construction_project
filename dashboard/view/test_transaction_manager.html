<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª ØµÙØ­Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            padding: 20px;
            direction: rtl;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .test-item {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .test-item h3 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .test-item.success {
            border-color: #4CAF50;
            background-color: #f1f8e9;
        }
        
        .test-item.error {
            border-color: #f44336;
            background-color: #ffebee;
        }
        
        .test-item.warning {
            border-color: #ff9800;
            background-color: #fff3e0;
        }
        
        .test-button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        .test-button:hover {
            background: #1976D2;
        }
        
        .test-button.success {
            background: #4CAF50;
        }
        
        .test-button.error {
            background: #f44336;
        }
        
        .result {
            margin-top: 10px;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 3px;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§ª ØªØ³Øª ØµÙØ­Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§</h1>
        <p>Ø§ÛŒÙ† ØµÙØ­Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø¹Ù…Ù„Ú©Ø±Ø¯ API Ù‡Ø§ Ùˆ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ ØµÙØ­Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
        
        <div class="test-item">
            <h3>1. ØªØ³Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡ API ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§</h3>
            <button class="test-button" onclick="testTransactionsAPI()">ØªØ³Øª API ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§</button>
            <div id="transactionsResult" class="result"></div>
        </div>
        
        <div class="test-item">
            <h3>2. ØªØ³Øª API Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±Ø§Ù†</h3>
            <button class="test-button" onclick="testInvestorsAPI()">ØªØ³Øª API Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±Ø§Ù†</button>
            <div id="investorsResult" class="result"></div>
        </div>
        
        <div class="test-item">
            <h3>3. ØªØ³Øª API Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§</h3>
            <button class="test-button" onclick="testProjectsAPI()">ØªØ³Øª API Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§</button>
            <div id="projectsResult" class="result"></div>
        </div>
        
        <div class="test-item">
            <h3>4. ØªØ³Øª API Ø¯ÙˆØ±Ù‡â€ŒÙ‡Ø§</h3>
            <button class="test-button" onclick="testPeriodsAPI()">ØªØ³Øª API Ø¯ÙˆØ±Ù‡â€ŒÙ‡Ø§</button>
            <div id="periodsResult" class="result"></div>
        </div>
        
        <div class="test-item">
            <h3>5. ØªØ³Øª Ø¢Ù…Ø§Ø± ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§</h3>
            <button class="test-button" onclick="testStatisticsAPI()">ØªØ³Øª Ø¢Ù…Ø§Ø± ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§</button>
            <div id="statisticsResult" class="result"></div>
        </div>
        
        <div class="test-item">
            <h3>6. ØªØ³Øª Ú©Ø§Ù…Ù„ ØµÙØ­Ù‡</h3>
            <button class="test-button success" onclick="testFullPage()">ØªØ³Øª Ú©Ø§Ù…Ù„ ØµÙØ­Ù‡</button>
            <div id="fullPageResult" class="result"></div>
        </div>
        
        <div class="test-item">
            <h3>7. ØªØ³Øª Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù…Ø±ÙˆØ±Ú¯Ø±</h3>
            <button class="test-button" onclick="testBrowserFeatures()">ØªØ³Øª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø±</button>
            <div id="browserResult" class="result"></div>
        </div>
        
        <div class="test-item">
            <h3>8. ØªØ³Øª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡</h3>
            <button class="test-button" onclick="testSampleData()">ØªØ³Øª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡</button>
            <div id="sampleDataResult" class="result"></div>
        </div>
    </div>

    <script>
        const API_BASE = '/api/';
        
        async function testAPI(endpoint, resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...';
            
            try {
                const response = await fetch(API_BASE + endpoint);
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.textContent = `âœ… Ù…ÙˆÙÙ‚ÛŒØª!\nØªØ¹Ø¯Ø§Ø¯ Ø±Ú©ÙˆØ±Ø¯Ù‡Ø§: ${data.length || 0}\nÙ†Ù…ÙˆÙ†Ù‡ Ø¯Ø§Ø¯Ù‡: ${JSON.stringify(data.slice(0, 2), null, 2)}`;
                    resultDiv.parentElement.className = 'test-item success';
                } else {
                    resultDiv.textContent = `âŒ Ø®Ø·Ø§: ${response.status} - ${response.statusText}`;
                    resultDiv.parentElement.className = 'test-item error';
                }
            } catch (error) {
                resultDiv.textContent = `âŒ Ø®Ø·Ø§ÛŒ Ø´Ø¨Ú©Ù‡: ${error.message}`;
                resultDiv.parentElement.className = 'test-item error';
            }
        }
        
        function testTransactionsAPI() {
            testAPI('transactions/', 'transactionsResult');
        }
        
        function testInvestorsAPI() {
            testAPI('investors/', 'investorsResult');
        }
        
        function testProjectsAPI() {
            testAPI('projects/', 'projectsResult');
        }
        
        function testPeriodsAPI() {
            testAPI('periods/', 'periodsResult');
        }
        
        async function testStatisticsAPI() {
            const resultDiv = document.getElementById('statisticsResult');
            resultDiv.textContent = 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...';
            
            try {
                const response = await fetch(API_BASE + 'transactions/statistics/');
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.textContent = `âœ… Ù…ÙˆÙÙ‚ÛŒØª!\nØ¢Ù…Ø§Ø± ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§:\n${JSON.stringify(data, null, 2)}`;
                    resultDiv.parentElement.className = 'test-item success';
                } else {
                    resultDiv.textContent = `âŒ Ø®Ø·Ø§: ${response.status} - ${response.statusText}`;
                    resultDiv.parentElement.className = 'test-item error';
                }
            } catch (error) {
                resultDiv.textContent = `âŒ Ø®Ø·Ø§ÛŒ Ø´Ø¨Ú©Ù‡: ${error.message}`;
                resultDiv.parentElement.className = 'test-item error';
            }
        }
        
        function testFullPage() {
            const resultDiv = document.getElementById('fullPageResult');
            resultDiv.textContent = 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª...';
            
            // ØªØ³Øª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²
            const tests = {
                'jQuery': typeof $ !== 'undefined',
                'Semantic UI': typeof $.fn.dropdown !== 'undefined',
                'Tabulator': typeof Tabulator !== 'undefined',
                'Fetch API': typeof fetch !== 'undefined',
                'Local Storage': typeof localStorage !== 'undefined',
                'JSON': typeof JSON !== 'undefined'
            };
            
            const results = Object.entries(tests).map(([feature, available]) => 
                `${available ? 'âœ…' : 'âŒ'} ${feature}: ${available ? 'Ù…ÙˆØ¬ÙˆØ¯' : 'Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯'}`
            ).join('\n');
            
            resultDiv.textContent = `Ù†ØªØ§ÛŒØ¬ ØªØ³Øª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:\n${results}`;
            resultDiv.parentElement.className = 'test-item success';
        }
        
        function testBrowserFeatures() {
            const resultDiv = document.getElementById('browserResult');
            
            const features = {
                'User Agent': navigator.userAgent,
                'Language': navigator.language,
                'Cookies Enabled': navigator.cookieEnabled,
                'Online': navigator.onLine,
                'Screen Resolution': `${screen.width}x${screen.height}`,
                'Viewport': `${window.innerWidth}x${window.innerHeight}`,
                'Local Storage': typeof localStorage !== 'undefined',
                'Session Storage': typeof sessionStorage !== 'undefined',
                'IndexedDB': typeof indexedDB !== 'undefined',
                'Web Workers': typeof Worker !== 'undefined',
                'Service Workers': 'serviceWorker' in navigator,
                'Push Notifications': 'PushManager' in window
            };
            
            const results = Object.entries(features).map(([feature, value]) => 
                `${feature}: ${value}`
            ).join('\n');
            
            resultDiv.textContent = `ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø±:\n${results}`;
            resultDiv.parentElement.className = 'test-item success';
        }
        
        function testSampleData() {
            const resultDiv = document.getElementById('sampleDataResult');
            
            const sampleTransaction = {
                id: 1,
                investor: {
                    id: 1,
                    first_name: 'Ø¹Ù„ÛŒ',
                    last_name: 'Ø§Ø­Ù…Ø¯ÛŒ'
                },
                project: {
                    id: 1,
                    name: 'Ù¾Ø±ÙˆÚ˜Ù‡ Ø¢Ø±Ø´Ø§'
                },
                period: {
                    id: 1,
                    label: 'Ù…Ø±Ø¯Ø§Ø¯ 1402'
                },
                transaction_type: 'principal_deposit',
                amount: '10000000',
                date_shamsi: '1402-05-16',
                date_gregorian: '2023-08-07',
                description: 'ÙˆØ§Ø±ÛŒØ² Ø§ÙˆÙ„ÛŒÙ‡',
                day_remaining: 730,
                day_from_start: 1,
                created_at: '2023-08-07T10:00:00Z'
            };
            
            resultDiv.textContent = `Ù†Ù…ÙˆÙ†Ù‡ Ø¯Ø§Ø¯Ù‡ ØªØ±Ø§Ú©Ù†Ø´:\n${JSON.stringify(sampleTransaction, null, 2)}`;
            resultDiv.parentElement.className = 'test-item success';
        }
        
        // ØªØ³Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØµÙØ­Ù‡
        window.addEventListener('load', function() {
            console.log('ØµÙØ­Ù‡ ØªØ³Øª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯');
            console.log('Ø¨Ø±Ø§ÛŒ ØªØ³Øª API Ù‡Ø§ØŒ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ·Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯');
        });
    </script>
</body>
</html>
