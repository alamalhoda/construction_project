# راهنمای استقرار و به‌روزرسانی سرور چابکان

## 🚀 اسکریپت اصلی

### `deploy_chabokan.sh`
اسکریپت کامل برای استقرار و به‌روزرسانی سرور چابکان که شامل:

- ✅ **به‌روزرسانی کد**: همگام‌سازی با برنچ `chabokan-deployment`
- ✅ **محافظت از فایل‌های محلی**: `.env`, `database/online.sqlite3`
- ✅ **به‌روزرسانی وابستگی‌ها**: نصب requirements جدید
- ✅ **اجرای migrations**: به‌روزرسانی دیتابیس
- ✅ **جمع‌آوری static files**: آماده‌سازی فایل‌های استاتیک
- ✅ **اجرای سرور**: راه‌اندازی Gunicorn و Nginx
- ✅ **تست کامل**: بررسی صحت عملکرد

## 📖 نحوه استفاده

### در سرور چابکان:
```bash
./deploy_chabokan.sh
```

### ویژگی‌های کلیدی:
- **خودکار**: تمام مراحل خودکار انجام می‌شود
- **امن**: فایل‌های محلی سرور محافظت می‌شوند
- **قابل اعتماد**: تست‌های کامل قبل و بعد از اجرا
- **رنگ‌بندی**: پیام‌های واضح و زیبا

## 🔄 فرآیند کامل

1. **توقف فرآیندهای موجود**
2. **پشتیبان‌گیری از فایل‌های محلی**
3. **همگام‌سازی با گیت‌هاب**
4. **فعال‌سازی virtual environment**
5. **نصب requirements**
6. **اجرای migrations**
7. **جمع‌آوری static files**
8. **تست Django**
9. **اجرای Gunicorn**
10. **تنظیم Nginx**
11. **تست نهایی**
12. **پاک‌سازی**

## 📋 فایل‌های محافظت شده

- `.env` - تنظیمات محیطی سرور
- `database/online.sqlite3` - دیتابیس محلی
- `logs/` - فایل‌های لاگ
- `media/` - فایل‌های رسانه

## 🔍 نظارت

بعد از اجرای اسکریپت:
```bash
# مشاهده لاگ‌ها
tail -f gunicorn.log

# تست سرور
curl http://localhost:8000/health/

# بررسی فرآیندها
ps aux | grep gunicorn
```

## 🌐 دسترسی

سایت شما در آدرس زیر در دسترس خواهد بود:
- **مستقیم**: `http://localhost:8000`
- **خارجی**: `https://django-arash.chbk.app/`

---

**نکته**: این اسکریپت برای استفاده منظم طراحی شده است و تمام جنبه‌های امنیتی و عملکردی را در نظر می‌گیرد.